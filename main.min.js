sounds={menu2:new Howl({src:["sfx/menu2.mp3"],volume:0,sprite:{menu2Start:[0,1300],menu2Loop:[1300,55500]},onend:function(){this.play("menu2Loop")}}),battlefield:new Howl({src:["sfx/battlefield.mp3"],sprite:{battlefieldStart:[0,8E3],battlefieldLoop:[8E3,75200]},volume:0,onend:function(){this.play("battlefieldLoop")}}),menuBack:new Howl({src:["sfx/menu-back.wav"]}),menuForward:new Howl({src:["sfx/menu-forward.wav"]}),menuSelect:new Howl({src:["sfx/menu-select.wav"]}),marth:new Howl({src:["sfx/marth.wav"]}),
ready:new Howl({src:["sfx/ready.wav"]}),go:new Howl({src:["sfx/go.wav"]}),game:new Howl({src:["sfx/game.wav"]}),dash:new Howl({src:["sfx/dash.wav"],volume:.3}),tech:new Howl({src:["sfx/tech.wav"]}),airdodge:new Howl({src:["sfx/airdodge.wav"],volume:.7}),dolphinSlash:new Howl({src:["sfx/dolphin-slash.wav"]}),dolphinSlash2:new Howl({src:["sfx/dolphin-slash2.wav"]}),grab:new Howl({src:["sfx/grab.wav"],volume:.5}),grabbed:new Howl({src:["sfx/grabbed.wav"]}),jump:new Howl({src:["sfx/jump.wav"],volume:.7}),
jump2:new Howl({src:["sfx/jump2.wav"],volume:.4}),kill:new Howl({src:["sfx/kill.wav"]}),land:new Howl({src:["sfx/land.wav"],volume:.7}),ledgegrab:new Howl({src:["sfx/ledgegrab.wav"],volume:.7}),powershield:new Howl({src:["sfx/powershield.wav"]}),roll:new Howl({src:["sfx/roll.wav"]}),shieldbreak:new Howl({src:["sfx/shieldbreak.wav"]}),shieldup:new Howl({src:["sfx/shieldup.wav"],volume:.7}),swordsheath:new Howl({src:["sfx/swordsheath.wav"],volume:.7}),sworddraw:new Howl({src:["sfx/sworddraw.wav"],volume:.7}),
fastfall:new Howl({src:["sfx/fastfall.wav"],volume:.4}),spotdodge:new Howl({src:["sfx/spotdodge.wav"]}),dancingBlade:new Howl({src:["sfx/dancing-blade.wav"]}),shieldoff:new Howl({src:["sfx/shieldoff.wav"],volume:.4}),runbrake:new Howl({src:["sfx/runbrake.wav"]}),shout1:new Howl({src:["sfx/shout1.wav"]}),shout2:new Howl({src:["sfx/shout2.wav"]}),shout3:new Howl({src:["sfx/shout3.wav"]}),shout4:new Howl({src:["sfx/shout4.wav"]}),shout5:new Howl({src:["sfx/shout5.wav"]}),shout6:new Howl({src:["sfx/shout6.wav"]}),
sword1:new Howl({src:["sfx/sword1.wav"],volume:.7}),sword2:new Howl({src:["sfx/sword2.wav"],volume:.7}),sword3:new Howl({src:["sfx/sword3.wav"],volume:.7}),footstep:new Howl({src:["sfx/footstep.wav"]}),smashcharge:new Howl({src:["sfx/smashcharge.wav"]}),deathShout:new Howl({src:["sfx/death.wav"]}),walljump:new Howl({src:["sfx/walljump.wav"]}),weakhurt:new Howl({src:["sfx/weakhurt.wav"]}),stronghurt:new Howl({src:["sfx/stronghurt.wav"]}),swordweakhit:new Howl({src:["sfx/swordweakhit.wav"],volume:.5}),
swordmediumhit:new Howl({src:["sfx/swordmediumhit.wav"],volume:.5}),swordstronghit:new Howl({src:["sfx/swordstronghit.wav"],volume:.5}),swordreallystronghit:new Howl({src:["sfx/swordreallystronghit.wav"],volume:.7}),stronghit:new Howl({src:["sfx/stronghit.wav"]}),strongerhit:new Howl({src:["sfx/strongerhit.wav"]}),normalweakhit:new Howl({src:["sfx/normalweakhit.wav"]}),cheer:new Howl({src:["sfx/cheer.wav"]}),lowdown:new Howl({src:["sfx/lowdown.wav"]}),bounce:new Howl({src:["sfx/bounce.wav"]}),pause:new Howl({src:["sfx/pause.wav"]}),
furacry:new Howl({src:["sfx/furacry.wav"],volume:.4}),furaloop:new Howl({src:["sfx/furaloop.wav"],loop:!0}),parry:new Howl({src:["sfx/parry.wav"]}),blunthit:new Howl({src:["sfx/blunthit.wav"],volume:.7}),clank:new Howl({src:["sfx/clank.wav"]}),deny:new Howl({src:["sfx/deny.wav"]}),targetBreak:new Howl({src:["sfx/target-break.wav"]}),complete:new Howl({src:["sfx/complete.wav"]}),newRecord:new Howl({src:["sfx/new-record.wav"]}),failure:new Howl({src:["sfx/failure.wav"]}),time:new Howl({src:["sfx/time.wav"]})};
Howler.volume(.2);function playSfx(a){sounds[a].play()}
vfx={impactLand:{name:"impactLand",colour:"rgba(255,255,255,",frames:8,path:[[[-157,-29],[-94,-5],[-154,-52],[-90,-9],[-145,-51],[-161,-85],[-99,-43],[-137,-78],[-115,-73],[-91,-59],[-155,-110],[-108,-84],[-150,-134],[-109,-108],[-136,-136],[-70,-89],[-94,-125],[-68,-95],[-91,-144],[-59,-109],[-83,-146],[-36,-92],[-38,-126],[-20,-105],[-2,-115],[10,-108],[18,-131],[29,-90],[96,-146],[64,-104],[100,-134],[77,-90],[105,-108],[59,-62],[95,-89],[90,-72],[66,-45],[106,-78],[90,-47],[128,-70],[92,-39],
[163,-81],[143,-47],[102,-18],[161,-51],[113,-12],[164,-28],[113,4],[67,49],[15,70],[-13,69],[-57,54],[-111,10],[0,0],[-111,10],[-139,-8]],[[-213,-28],[-145,1],[-205,-46],[-145,-12],[-198,-50],[-214,-84],[-151,-41],[-190,-74],[-169,-72],[-139,-59],[-211,-109],[-159,-81],[-196,-109],[-207,-137],[-152,-103],[-189,-135],[-94,-74],[-129,-123],[-100,-93],[-115,-118],[-123,-145],[-95,-113],[-115,-148],[-65,-89],[-65,-119],[-31,-95],[-1,-114],[25,-100],[51,-119],[58,-86],[132,-143],[103,-107],[145,-140],
[130,-110],[110,-89],[141,-112],[127,-92],[191,-135],[159,-106],[199,-125],[188,-103],[172,-90],[209,-110],[151,-65],[182,-78],[183,-69],[157,-48],[213,-85],[197,-49],[168,-29],[214,-54],[159,-9],[215,-27],[177,2],[115,15],[65,51],[17,65],[-15,65],[-65,52],[-119,16],[0,0],[-119,16],[-188,1]],[[-264,-30],[-199,-2],[-260,-51],[-192,-11],[-246,-49],[-261,-81],[-203,-44],[-243,-75],[-220,-72],[-182,-55],[-257,-107],[-216,-85],[-243,-105],[-254,-135],[-209,-105],[-241,-139],[-159,-80],[-167,-95],[-139,
-63],[-153,-93],[-130,-79],[-159,-121],[-134,-95],[-149,-122],[-160,-152],[-124,-112],[-155,-157],[-102,-101],[-81,-88],[-87,-105],[-82,-103],[-84,-128],[-79,-115],[-76,-125],[-66,-106],[-50,-116],[-20,-97],[3,-113],[18,-101],[51,-120],[54,-98],[76,-121],[76,-111],[96,-126],[91,-116],[102,-117],[97,-102],[171,-150],[140,-108],[186,-148],[173,-117],[150,-91],[187,-124],[141,-69],[241,-139],[208,-108],[257,-132],[240,-106],[222,-91],[260,-112],[199,-66],[239,-82],[239,-73],[204,-43],[266,-87],[247,
-52],[198,-17],[259,-52],[206,-12],[266,-29],[240,-5],[139,4],[66,47],[1,54],[-71,48],[-141,10],[0,0],[-141,10],[-241,-3]],[[-311,-30],[-245,-2],[-302,-50],[-243,-15],[-290,-47],[-310,-85],[-251,-46],[-290,-80],[-266,-72],[-225,-53],[-304,-110],[-267,-89],[-288,-105],[-298,-130],[-250,-103],[-288,-137],[-189,-71],[-199,-98],[-171,-67],[-185,-96],[-162,-80],[-201,-133],[-169,-99],[-181,-121],[-192,-152],[-159,-118],[-181,-158],[-121,-87],[-101,-98],[-98,-116],[-86,-103],[-93,-129],[-77,-104],[-26,
-116],[38,-115],[77,-97],[101,-119],[94,-101],[113,-106],[114,-95],[104,-71],[205,-152],[181,-116],[224,-148],[208,-119],[188,-95],[226,-127],[180,-75],[204,-91],[202,-81],[290,-139],[250,-106],[301,-134],[284,-106],[261,-89],[309,-114],[247,-66],[280,-81],[254,-49],[313,-84],[296,-51],[256,-26],[310,-56],[272,-27],[311,-31],[282,-2],[156,-3],[63,33],[-50,35],[-156,4],[1,-1],[-156,4],[-281,-1]],[[-359,-35],[-294,-4],[-348,-50],[-287,-14],[-330,-45],[-351,-85],[-296,-45],[-330,-80],[-280,-61],[-351,
-112],[-302,-86],[-333,-108],[-342,-131],[-302,-110],[-331,-138],[-216,-61],[-233,-102],[-199,-62],[-217,-95],[-187,-78],[-234,-137],[-199,-103],[-219,-133],[-226,-159],[-195,-126],[-217,-164],[-151,-88],[-123,-105],[-105,-104],[-108,-127],[-95,-106],[-37,-121],[30,-122],[84,-104],[113,-120],[99,-102],[121,-104],[162,-88],[248,-159],[215,-118],[261,-154],[245,-125],[228,-101],[268,-136],[218,-78],[242,-97],[237,-79],[329,-141],[294,-107],[346,-133],[327,-105],[305,-91],[351,-116],[293,-69],[329,-80],
[304,-58],[353,-84],[339,-54],[304,-27],[350,-55],[306,-21],[353,-32],[327,0],[166,-1],[67,22],[-55,21],[-159,5],[0,0],[-159,5],[-326,-1]],[[-392,-38],[-327,-5],[-382,-50],[-321,-13],[-369,-54],[-387,-90],[-322,-42],[-362,-79],[-321,-59],[-383,-109],[-334,-86],[-367,-109],[-380,-136],[-328,-105],[-365,-141],[-242,-53],[-263,-99],[-219,-58],[-241,-88],[-217,-81],[-201,-64],[-261,-139],[-227,-106],[-249,-141],[-258,-173],[-222,-129],[-244,-168],[-186,-103],[-131,-118],[-120,-126],[-108,-119],[-43,-128],
[51,-126],[130,-106],[167,-110],[163,-101],[194,-94],[281,-164],[249,-125],[295,-162],[282,-131],[260,-107],[302,-139],[255,-87],[282,-98],[258,-67],[362,-139],[326,-106],[377,-133],[343,-89],[387,-115],[308,-57],[364,-83],[325,-45],[389,-86],[368,-52],[316,-14],[387,-58],[320,-6],[388,-33],[354,2],[164,2],[86,9],[-1,9],[-109,10],[-180,3],[0,0],[-180,3],[-365,-2]],[[-417,-29],[-349,1],[-419,-56],[-350,-10],[-398,-48],[-416,-82],[-353,-38],[-397,-78],[-338,-51],[-416,-111],[-366,-83],[-399,-109],[-412,
-135],[-356,-102],[-404,-142],[-257,-40],[-279,-62],[-290,-103],[-240,-52],[-275,-99],[-253,-88],[-225,-62],[-289,-138],[-245,-94],[-273,-136],[-281,-169],[-247,-129],[-271,-167],[-204,-91],[-153,-114],[-135,-128],[-121,-118],[-51,-140],[38,-141],[113,-115],[155,-119],[159,-105],[203,-88],[298,-164],[264,-117],[312,-158],[301,-129],[276,-102],[318,-141],[268,-81],[299,-99],[284,-73],[318,-101],[313,-89],[393,-141],[346,-103],[402,-135],[391,-114],[357,-86],[407,-118],[342,-66],[388,-84],[345,-42],
[413,-89],[394,-56],[344,-18],[407,-56],[351,-11],[411,-34],[388,-2],[147,-1],[26,9],[-41,9],[-177,0],[0,10],[-177,0],[-396,2]],[[-429,-32],[-372,-2],[-426,-48],[-364,-13],[-411,-50],[-429,-87],[-366,-39],[-405,-79],[-348,-52],[-429,-115],[-383,-88],[-408,-107],[-421,-131],[-380,-108],[-411,-140],[-288,-53],[-297,-70],[-282,-55],[-302,-109],[-264,-71],[-283,-100],[-256,-87],[-295,-141],[-265,-115],[-289,-146],[-297,-167],[-255,-130],[-281,-172],[-216,-97],[-132,-127],[-131,-136],[-110,-124],[-47,
-147],[49,-147],[121,-124],[167,-133],[166,-116],[219,-97],[320,-171],[283,-122],[334,-164],[320,-134],[286,-96],[338,-143],[268,-67],[322,-105],[288,-57],[344,-112],[330,-86],[409,-143],[377,-109],[424,-138],[413,-114],[385,-86],[431,-117],[349,-55],[414,-88],[373,-48],[433,-92],[416,-58],[369,-23],[434,-62],[369,-6],[435,-36],[407,-3],[-1,-1],[-405,-1]]]},circleDust:{name:"circleDust",colour:"white",frames:30,circles:[0,0,0,0]},flyingDust:{name:"flyingDust",colour:"white",frames:30},dashDust:{name:"dashDust",
colour:"rgba(255,255,255,",frames:8,path:[[[-84,-287],[107,-135],[-161,-296],[5,-153],[-57,-173],[-15,-138],[-198,-218],[51,-86],[-33,-86],[43,-59],[-184,-80],[39,-36],[-157,-15],[0,0],[-157,-15],[257,-8],[308,-30]],[[172,-92],[189,-65],[98,-124],[174,-63],[118,-89],[166,-53],[90,-88],[138,-58],[99,-73],[154,-38],[130,-41],[55,-105],[73,-76],[25,-102],[70,-62],[-3,-96],[73,-34],[-13,-45],[81,-13],[0,0],[81,-13],[163,-13],[245,-21]],[[185,-112],[201,-66],[151,-110],[189,-60],[131,-119],[172,-65],[88,
-119],[168,-56],[124,-75],[150,-51],[102,-75],[56,-123],[71,-92],[61,-93],[68,-84],[39,-104],[68,-72],[3,-117],[53,-68],[4,-85],[43,-59],[-29,-79],[31,-49],[-39,-50],[19,-39],[-29,-35],[91,-9],[0,0],[91,-9],[138,-13],[239,-17]],[[203,-67],[153,-126],[179,-69],[116,-112],[152,-71],[55,-127],[90,-83],[16,-115],[57,-75],[-109,-182],[4,-63],[-64,-86],[-5,-56],[-75,-61],[-5,-42],[-95,-45],[-10,-28],[-50,-23],[59,-11],[0,0],[59,-11],[159,-12],[221,-16]],[[190,-56],[124,-126],[147,-75],[117,-99],[140,-71],
[59,-142],[131,-71],[24,-137],[92,-81],[10,-116],[86,-65],[-119,-178],[-35,-108],[-104,-136],[-24,-81],[-97,-83],[-22,-55],[-92,-60],[-37,-42],[-137,-53],[-64,-30],[-107,-24],[79,-8],[0,0],[79,-8],[170,-12],[198,-23]],[[160,-71],[118,-97],[121,-69],[40,-118],[69,-93],[20,-119],[98,-69],[69,-84],[92,-59],[10,-106],[87,-51],[11,-80],[-86,-180],[-46,-124],[-127,-176],[-52,-111],[-79,-126],[-60,-104],[-147,-151],[-92,-106],[-131,-123],[-95,-98],[-144,-113],[-55,-61],[-98,-76],[-61,-50],[-114,-62],[-77,
-41],[-165,-48],[-86,-28],[-163,-28],[62,1],[0,0],[62,1],[156,-10],[183,-26]],[[136,-73],[85,-114],[119,-77],[32,-131],[96,-79],[17,-119],[72,-72],[-1,-104],[43,-64],[-16,-77],[-139,-182],[-81,-115],[-119,-139],[-90,-104],[-177,-167],[-133,-121],[-186,-136],[-109,-98],[-170,-101],[-96,-60],[-206,-49],[-92,-40],[-161,-34],[-89,-27],[-205,-19],[-25,-3],[88,-6],[0,0],[88,-6],[163,-34]],[[99,-49],[17,-112],[57,-69],[-11,-93],[32,-67],[-9,-75],[-3,-61],[-137,-161],[-87,-90],[-129,-97],[-85,-67],[-133,
-77],[-88,-58],[-175,-64],[-77,-44],[-161,-44],[-86,-31],[-204,-29],[-67,-9],[43,-3],[0,0],[43,-3],[112,-15]]]},doubleJumpRings:{name:"doubleJumpRings",colour:"#63beff",frames:8,rings:[0,0,0]},blastzoneExplosion:{name:"blastzoneExplosion",frames:20,path1:[[-112,-53],[-117,-82],[-107,-78],[-106,-124],[-86,-72],[-80,-138],[-69,-86],[-63,-122],[-58,-85],[-56,-159],[-43,-89],[-36,-129],[-30,-108],[-26,-165],[-13,-111],[0,-173],[6,-118],[20,-183],[31,-104],[51,-156],[51,-92],[63,-125],[63,-84],[78,-147],
[79,-79],[89,-101],[90,-78],[102,-112],[100,-60],[106,-75],[106,-60],[118,-82],[104,-7],[97,-23],[88,0],[89,-41],[83,-28],[79,-41],[73,-10],[71,-39],[66,-10],[62,-38],[57,-15],[54,-41],[49,-31],[46,-44],[35,-30],[31,-63],[25,-47],[23,-57],[13,-25],[7,-55],[0,-28],[-9,-57],[-12,-41],[-15,-53],[-17,-23],[-32,-54],[-36,-33],[-44,-52],[-44,-26],[-50,-49],[-53,-15],[-60,-38],[-62,-25],[-67,-32],[-71,-14],[-82,-32],[-84,-22],[-89,-27],[-90,-10],[-96,-15],[-96,-4]],path2:[[-35,-678],[-34,-103],[-30,-587],
[-24,-213],[-22,-672],[-19,-523],[-17,-717],[-15,-485],[-12,-533],[-12,-313],[-9,-671],[-4,-471],[-2,-674],[2,-549],[3,-696],[6,-516],[10,-764],[13,-396],[17,-718],[22,-225],[26,-605],[31,-415],[35,-698],[35,-173],[40,-512],[39,-238],[45,-445],[45,0],[-44,0]],path3:[[-46,-497],[-43,-95],[-35,-436],[-29,-237],[-24,-538],[-18,-329],[-16,-400],[-13,-329],[-11,-521],[-4,-291],[-2,-521],[5,-355],[9,-580],[17,-288],[22,-537],[24,-352],[28,-449],[28,-201],[33,-417],[37,-307],[43,-530],[47,-99],[50,-409],
[54,-300],[55,-362],[56,0],[-55,0]],path4:[[-8,-822],[8,0],[-8,0]],svg2Active:[1,3],svg3Active:[4,19],svg2Scale:[[1,1],[1.3,.7],[.7,1.5]],svg3Scale:[[1,.1],[1,1],[1.3,.7],[.5,1.5],[1,1],[1.2,.5],[1,.8],[.7,1.3],[.5,1.5],[.7,1.3],[1.2,.8],[1.6,.4],[1,1],[.5,1.5],[.2,1.5],[.1,1.5]]},cliffcatchspark:{name:"cliffcatchspark",colour:"#63beff",frames:12},swingDair:{name:"swingDair",frames:4,svg:"201.276,-206L2.276,0L201.276,-206l64,-179c0,0,-244.236,-85.148,-396,132C-282.488,-35.852,-19.047,-477.367,201.276,-206 148,-16.14L0,1.86L148,-16.14l189,79c0,0,137.557,-211.42,-60,-433C79.443,-591.72,318,-211.14,148,-16.14 -30.499,10.062l31,-10L-30.499,10.062l-14,209c0,0,283,4,391,-170S276.501,19.062,-30.499,10.062 -147.487,-72.373l148,72L-147.487,-72.373l-142,152c0,0,146,137,230,134S162.513,251.627,-147.487,-72.373 -203,-196.911l203,197L-203,-196.911l-201,31c0,0,13,128,87,217S-89,280.089,-203,-196.911 -216,-251L0,0l-217,-252l-200,19c0,0,6,44.5,17,95S-191,-168.5,-216,-251 -214,-311L0,0L-214,-311l-189,22c0,0,-14.5,47.5,-15,55S-203,-207.5,-214,-311".split(" "),
path:[[[201,-206],[2,0],[201,-206],[265,-385],[265,-385,21,-470,-131,-253],[-282,-36,-19,-477,201,-206]],[[148,-16],[0,2],[148,-16],[337,63],[337,63,475,-148,277,-370],[79,-592,318,-211,148,-16]],[[-30,10],[1,0],[-30,10],[-44,219],[-44,219,239,223,347,49],[455,-125,277,19,-30,10]],[[-147,-72],[1,0],[-147,-72],[-289,80],[-289,80,-143,217,-59,214],[25,211,163,252,-147,-72]],[[-203,-197],[0,0],[-203,-197],[-404,-166],[-404,-166,-391,-38,-317,51],[-243,140,-89,280,-203,-197]],[[-216,-251],[0,0],[-217,
-252],[-417,-233],[-417,-233,-411,-188,-400,-138],[-389,-88,-191,-168,-216,-251]],[[-214,-311],[0,0],[-214,-311],[-403,-289],[-403,-289,-417,-241,-418,-234],[-419,-227,-203,-207,-214,-311]]]},swingFair:{name:"swingFair",frames:4,path:[[[-33,-424],[1,0],[-33,-424],[-220,-476],[-220,-476,-274,-357,-53,-243],[168,-129,-224,-291,-33,-424]],[[201,-371],[0,0],[201,-371],[267,-554],[267,-554,9,-673,-209,-500],[-427,-327,-55,-533,201,-371]],[[250,-233],[0,0],[250,-233],[447,-216],[447,-216,457,-419,272,-553],
[87,-687,273,-319,250,-233]],[[209,-124],[0,0],[209,-124],[351,13],[351,13,463,-164,448,-246],[433,-328,347,-353,209,-124]],[[87,-56],[0,0],[87,-56],[130,104],[130,104,302,55,342,13],[382,-29,472,-212,87,-56]],[[-6,-69],[0,1],[-6,-69],[-115,51],[-115,51,2,111,97,106],[192,101,174,-17,-6,-69]],[[-49,-105],[0,0],[-49,-105],[-180,-30],[-180,-30,-157,21,-117,51],[-77,82,33,6,-49,-105]],[[-83,-145],[0,0],[-83,-145],[-272,-171],[-272,-171,-267,-109,-184,-37],[-101,36,-72,-107,-83,-145]]]},swingBair:{name:"swingBair",
frames:4,svg:"132.623,-222L0.623,0L132.623,-222l-112,-78c0,0,-108,-177,-105,-221S-113.377,-505,132.623,-222 166,-167L0,0L166,-167l49,46c0,0,-59.5,-54,-86,-104S122,-190.5,166,-167 63.333,-148l-62,148L63.333,-148l125,130c0,0,102.5,-31,-21,-150S235.333,-129.5,63.333,-148 -69.757,-137.066l70,137L-69.757,-137.066l119,137c0,0,93,6,133,-17S309.438,-119.075,-69.757,-137.066 -253,-142.695l253,143L-253,-142.695l-72,170c0,0,126,27.5,213,-3S80,-79.695,-253,-142.695 -298,-296.852l298,297L-298,-296.852l-196,-9c0,0,-8,155,144,318S-299,-157.852,-298,-296.852 -229,-397L0,0L-229,-397l-99,-188c0,0,-151,98,-166,284S-234,-408,-229,-397 -105,-413L0,0l-105,-414l67,-173c0,0,-145,-57,-294,1S-315,-420,-105,-413 -91,-409L0,0L-91,-409l71,-173c0,0,-7,-3,-50,-17S-120,-430,-91,-409".split(" "),
path:[[[133,-222],[1,0],[133,-222],[21,-300],[21,-300,-87,-477,-84,-521],[-81,-565,-113,-505,133,-222]],[[166,-167],[0,0],[166,-167],[215,-121],[215,-121,156,-175,129,-225],[103,-275,122,-190,166,-167]],[[63,-148],[1,0],[63,-148],[188,-18],[188,-18,291,-49,167,-168],[44,-287,235,-129,63,-148]],[[-70,-137],[0,0],[-70,-137],[49,0],[49,0,142,6,182,-17],[222,-40,309,-119,-70,-137]],[[-253,-143],[0,0],[-253,-143],[-325,27],[-325,27,-199,55,-112,24],[-25,-6,80,-80,-253,-143]],[[-298,-297],[0,0],[-298,-297],
[-494,-306],[-494,-306,-502,-151,-350,12],[-198,175,-299,-158,-298,-297]],[[-229,-397],[0,0],[-229,-397],[-328,-585],[-328,-585,-479,-487,-494,-301],[-509,-115,-234,-408,-229,-397]],[[-105,-413],[0,0],[-105,-414],[-38,-587],[-38,-587,-183,-644,-332,-586],[-481,-528,-315,-420,-105,-413]],[[-91,-409],[0,0],[-91,-409],[-20,-582],[-20,-582,-27,-585,-70,-599],[-113,-613,-120,-430,-91,-409]]]},swingNair1:{name:"swingNair1",frames:4,svg:["-39,-260L0,0L-39,-260l-112,45c0,0,-167,75,-197,77S-191,-253,-39,-260",
"247.523,-214L0.523,0L247.523,-214l189,30c0,0,-469,-88,-469,-80S250.523,-214,247.523,-214","131,-235L0,0L131,-235l-26,-40c0,0,293,33,338,88S31,-286,131,-235","-3.748,-281l4,281L-3.748,-281l-103,-157c0,0,74,-2,203,165S2.252,-298,-3.748,-281"],path:[[[-39,-260],[0,0],[-39,-260],[-151,-215],[-151,-215,-318,-140,-348,-138],[-378,-136,-191,-253,-39,-260]],[[248,-214],[1,0],[248,-214],[437,-184],[437,-184,-32,-272,-32,-264],[-32,-256,251,-214,248,-214]],[[131,-235],[0,0],[131,-235],[105,-275],[105,-275,
398,-242,443,-187],[488,-132,31,-286,131,-235]],[[-4,-281],[0,0],[-4,-281],[-107,-438],[-107,-438,-33,-440,96,-273],[225,-106,2,-298,-4,-281]]]},swingNair2:{name:"swingNair2",frames:4,svg:["38.995,-187l-39,187l39,-186l-120,-68c0,0,-141.5,-130.5,-67,-133S-79.505,-295,38.995,-187","213.352,-150L0.352,0L213.352,-150l172,110c0,0,-38,27,-389,-163S177.352,-103,213.352,-150","-16.922,-268l17,268L-16.922,-268l100,42l307,185C390.078,-41,-4.922,-270,-16.922,-268","-216.494,-395l217,395L-216.494,-395l-155,-107c0,0,429,223,403,239S-187.494,-377,-216.494,-395"],
path:[[[39,-187],[0,0],[39,-186],[-81,-254],[-81,-254,-222,-384,-148,-387],[-74,-390,-80,-295,39,-187]],[[213,-150],[0,0],[213,-150],[385,-40],[385,-40,347,-13,-4,-203],[-355,-393,177,-103,213,-150]],[[-17,-268],[0,0],[-17,-268],[83,-226],[390,-41],[390,-41,-5,-270,-17,-268]],[[-216,-395],[1,0],[-216,-395],[-371,-502],[-371,-502,58,-279,32,-263],[6,-247,-187,-377,-216,-395]]]},swingUpair:{name:"swingUpair",frames:4,svg:"169,-366L0,0L169,-366l161,80c0,0,-42.899,166.873,-119,230S231.949,-175.593,169,-366 67,-462L0,0L67,-462l166,-85c0,0,88,117,94,205S363,-237,67,-462 -52.549,-483l53,483L-52.549,-483l45,-182c0,0,142.181,35.103,192,77S316.155,-483,-52.549,-483 -176.169,-422l176,422L-176.169,-422l-104,-164c0,0,100,-63,166,-70S135.831,-631,-176.169,-422 -235,-335L0,0L-235,-335l-144,-140c0,0,25.788,-49.426,75,-90C-254.788,-605.574,-133.082,-532.903,-235,-335 -236,-229L0,0L-236,-229l-164,-116c0,0,-8,-9,8,-76S-243,-491,-236,-229 -212,-149L0,0L-212,-149l-172,-70c0,0,-9,-3,-15,-79S-269,-312,-212,-149 -173,-107L0,0L-173,-107l-180,-12c0,0,-9,-8,-23,-62S-309,-246,-173,-107 -129,-86L0,0L-129,-86l-168,61c0,0,-21,0,-41,-57S-238,-139,-129,-86 -84,-80.007l84,80L-84,-80.007l-153,102c0,0,-41,-19,-64,-53S-202,-80.007,-84,-80.007".split(" "),
path:[[[169,-366],[0,0],[169,-366],[330,-286],[330,-286,287,-119,211,-56],[135,7,232,-176,169,-366]],[[67,-462],[0,0],[67,-462],[233,-547],[233,-547,321,-430,327,-342],[333,-254,363,-237,67,-462]],[[-53,-483],[0,0],[-53,-483],[-8,-665],[-8,-665,134,-630,184,-588],[234,-546,316,-483,-53,-483]],[[-176,-422],[0,0],[-176,-422],[-280,-586],[-280,-586,-180,-649,-114,-656],[-48,-663,136,-631,-176,-422]],[[-235,-335],[0,0],[-235,-335],[-379,-475],[-379,-475,-353,-524,-304,-565],[-255,-606,-133,-533,-235,
-335]],[[-236,-229],[0,0],[-236,-229],[-400,-345],[-400,-345,-408,-354,-392,-421],[-376,-488,-243,-491,-236,-229]],[[-212,-149],[0,0],[-212,-149],[-384,-219],[-384,-219,-393,-222,-399,-298],[-405,-374,-269,-312,-212,-149]],[[-173,-107],[0,0],[-173,-107],[-353,-119],[-353,-119,-362,-127,-376,-181],[-390,-235,-309,-246,-173,-107]],[[-129,-86],[0,0],[-129,-86],[-297,-25],[-297,-25,-318,-25,-338,-82],[-358,-139,-238,-139,-129,-86]],[[-84,-80],[0,0],[-84,-80],[-237,22],[-237,22,-278,3,-301,-31],[-324,
-65,-202,-80,-84,-80]]]},swingUpb:{name:"swingUpb",frames:4,svg:"-85,-100L0,0L-85,-100l-188,73c0,0,-86,-140,-46,-272S-130,-160,-85,-100 67.578,-115.246l-67,115L67.578,-115.246l46,195c0,0,-205,61,-344,-65S17.578,-72.246,67.578,-115.246 134,-142.348L0,0.652L134,-142.348l167,113c0,0,-75,95,-171,105S-43,-31.348,134,-142.348 213,-300.235L0,0.765L213,-300.235l193,19c0,0,-91,534,-115,572S33,663.765,213,-300.235 164.245,-457.263l-164,457L164.245,-457.263l141,-130c0,0,100.81,421.001,92,643S226.245,356.737,164.245,-457.263 127,-511L0,0L127,-511l131,-135c0,0,38.229,217.695,34,246S176.46,-107.697,127,-511 95,-523L0,0L95,-523l121,-138c0,0,21.5,41.5,30,64S123.5,-396,95,-523 60,-531L0,0L60,-531l99,-154c0,0,39.5,52.5,45,64S99.5,-413,60,-531 22,-525L0,0L22,-525l45,-195c0,0,60.5,37,76,68S81,-437.5,22,-525".split(" "),
path:[[[-85,-100],[0,0],[-85,-100],[-273,-27],[-273,-27,-359,-167,-319,-299],[-279,-431,-130,-160,-85,-100]],[[68,-115],[1,0],[68,-115],[114,80],[114,80,-91,141,-230,15],[-369,-111,18,-72,68,-115]],[[134,-142],[0,1],[134,-142],[301,-29],[301,-29,226,66,130,76],[34,86,-43,-31,134,-142]],[[213,-300],[0,1],[213,-300],[406,-281],[406,-281,315,253,291,291],[267,329,33,664,213,-300]],[[164,-457],[0,0],[164,-457],[305,-587],[305,-587,406,-166,397,56],[388,278,226,357,164,-457]],[[127,-511],[0,0],[127,-511],
[258,-646],[258,-646,296,-428,292,-400],[288,-372,176,-108,127,-511]],[[95,-523],[0,0],[95,-523],[216,-661],[216,-661,238,-619,246,-597],[255,-575,124,-396,95,-523]],[[60,-531],[0,0],[60,-531],[159,-685],[159,-685,199,-632,204,-621],[210,-610,100,-413,60,-531]],[[22,-525],[0,0],[22,-525],[67,-720],[67,-720,128,-683,143,-652],[159,-622,81,-437,22,-525]]]},swingUptilt:{name:"swingUptilt",frames:4,svg:"160.099,-173l-142,122l-18,51l18,-51c0,0,-90.5,7,-115,-15S175.099,-173.5,160.099,-173 305.175,-296L0.175,0L305.175,-296l103,145c0,0,-185,199,-400,102S181.175,-58,305.175,-296 276,-453L0,0L276,-453l151,-95c0,0,97,187,-15,385S377,-262,276,-453 175,-512L0,0L175,-512l62,-175c0,0,116,52,170,118S486,-374,175,-512 86.843,-504l-86,504L86.843,-504l-24,-182c0,0,121,-22,183,-1S368.843,-552,86.843,-504 12.059,-460l-12,460L12.059,-460l-54,-161c0,0,90,-70,113,-68S212.059,-589,12.059,-460 -32.058,-364l32,364L-32.058,-364l-109,-142c0,0,52,-75,64,-88S76.942,-643,-32.058,-364 -37,-272L0,0L-37,-272l-165,-111c0,0,5,-53,39,-103S-63,-534,-37,-272 6.036,-196l-6,196L6.036,-196l-123,49c0,0,-80,-96,-91,-192S-100.964,-325,6.036,-196 21.047,-168l-21,168L21.047,-168l-108,88c0,0,-10,-3,-32,-70S-12.953,-192,21.047,-168".split(" "),
path:[[[160,-173],[18,-51],[0,0],[18,-51],[18,-51,-72,-44,-97,-66],[-121,-88,175,-173,160,-173]],[[305,-296],[0,0],[305,-296],[408,-151],[408,-151,223,48,8,-49],[-207,-146,181,-58,305,-296]],[[276,-453],[0,0],[276,-453],[427,-548],[427,-548,524,-361,412,-163],[300,35,377,-262,276,-453]],[[175,-512],[0,0],[175,-512],[237,-687],[237,-687,353,-635,407,-569],[461,-503,486,-374,175,-512]],[[87,-504],[1,0],[87,-504],[63,-686],[63,-686,184,-708,246,-687],[308,-666,369,-552,87,-504]],[[12,-460],[0,0],[12,
-460],[-42,-621],[-42,-621,48,-691,71,-689],[94,-687,212,-589,12,-460]],[[-32,-364],[0,0],[-32,-364],[-141,-506],[-141,-506,-89,-581,-77,-594],[-65,-607,77,-643,-32,-364]],[[-37,-272],[0,0],[-37,-272],[-202,-383],[-202,-383,-197,-436,-163,-486],[-129,-536,-63,-534,-37,-272]],[[6,-196],[0,0],[6,-196],[-117,-147],[-117,-147,-197,-243,-208,-339],[-219,-435,-101,-325,6,-196]],[[21,-168],[0,0],[21,-168],[-87,-80],[-87,-80,-97,-83,-119,-150],[-141,-217,-13,-192,21,-168]]]},swingDtilt:{name:"swingDtilt",
frames:4,svg:["189,-88L0,0L189,-88l157,37L68,-105C68,-105,181.5,-96,189,-88","406,-53L0,0L406,-53L569,-2c0,0,-288.5,-70.5,-292,-72S405,-61,406,-53","408,-60L0,0L408,-60l186,50c0,0,-14.5,7.5,-27,3S409.5,-44,408,-60","405,-63L0,0L405,-63l191,52c0,0,-0.5,3.5,-7,3S407,-57,405,-63"],path:[[[189,-88],[0,0],[189,-88],[346,-51],[68,-105],[68,-105,182,-96,189,-88]],[[406,-53],[0,0],[406,-53],[569,-2],[569,-2,281,-72,277,-74],[274,-76,405,-61,406,-53]],[[408,-60],[0,0],[408,-60],[594,-10],[594,-10,580,-2,567,
-7],[555,-12,410,-44,408,-60]],[[405,-63],[0,0],[405,-63],[596,-11],[596,-11,596,-7,589,-8],[583,-9,407,-57,405,-63]]]},swingFsmash:{name:"swingFsmash",frames:7,svg:"-73.992,-309l74,309L-73.992,-309l-30,147c0,0,61,52,168,25S-35.492,-151.5,-73.992,-309z -48,-341L0,0L-48,-341l-77,86c0,0,-4,38.5,11,77S-128.5,-166,-48,-341z 87.246,-450l-87,450L87.246,-450l-147,66c0,0,-7.5,2.5,-44,79S-54.754,-362,87.246,-450z 324,-456L0,0L324,-456L197,-597c0,0,-75,4,-192,113S54,-483,324,-456z 507,-276L0,0L507,-276l162,-109c0,0,-119,-178,-376,-217S452,-415,507,-276z 401,-12L0,0L401,-12l197,-9c0,0,59,-141,85,-328S612,-519,401,-12z 401,-6L0,0L401,-6l206,-2c0,0,-2.5,-6.5,-14,-16S399,-33.5,401,-6z".split(" "),
path:[[[-74,-309],[0,0],[-74,-309],[-104,-162],[-104,-162,-43,-110,64,-137],[171,-164,-35,-151,-74,-309]],[[-48,-341],[0,0],[-48,-341],[-125,-255],[-125,-255,-129,-216,-114,-178],[-99,-140,-128,-166,-48,-341]],[[87,-450],[0,0],[87,-450],[-60,-384],[-60,-384,-67,-381,-104,-305],[-140,-229,-55,-362,87,-450]],[[324,-456],[0,0],[324,-456],[197,-597],[197,-597,122,-593,5,-484],[-112,-375,54,-483,324,-456]],[[507,-276],[0,0],[507,-276],[669,-385],[669,-385,550,-563,293,-602],[36,-641,452,-415,507,-276]],
[[401,-12],[0,0],[401,-12],[598,-21],[598,-21,657,-162,683,-349],[709,-536,612,-519,401,-12]],[[401,-6],[0,0],[401,-6],[607,-8],[607,-8,605,-14,593,-24],[582,-34,399,-33,401,-6]]]},swingFtilt:{name:"swingFtilt",frames:8,svg:"-52.67,-165l53,165L-52.67,-165l-111,-124c0,0,88,-147,227,-37S-139.67,-362,-52.67,-165z 169.996,-90l-170,90L169.996,-90l-137,87c0,0,-92,-17,-180,-169S-93.004,-153,169.996,-90z 351,-198.912L0,0.088L351,-198.912l76,173c0,0,-89,79,-287,60S52,25.088,351,-198.912z 395,-290L0,0L395,-290l195,-10c0,0,14,91,-74,197S367,-54,395,-290z 328,-399L0,0L328,-399l139,-146c0,0,77,84,117,217S445,-250,328,-399z 243,-442L0,0L243,-442l61,-191c0,0,19,-5,107,57S505,-340,243,-442z 151,-431L0,0L151,-431l-45,-195c0,0,87,-22,184,-10S400,-462,151,-431z 140,-428L0,0L140,-428L89,-619c0,0,14,-16,81,-18S186,-429,140,-428z".split(" "),
path:[[[-53,-165],[0,0],[-53,-165],[-164,-289],[-164,-289,-76,-436,63,-326],[202,-216,-140,-362,-53,-165]],[[170,-90],[0,0],[170,-90],[33,-3],[33,-3,-59,-20,-147,-172],[-235,-324,-93,-153,170,-90]],[[351,-199],[0,0],[351,-199],[427,-26],[427,-26,338,53,140,34],[-58,15,52,25,351,-199]],[[395,-290],[0,0],[395,-290],[590,-300],[590,-300,604,-209,516,-103],[428,3,367,-54,395,-290]],[[328,-399],[0,0],[328,-399],[467,-545],[467,-545,544,-461,584,-328],[624,-195,445,-250,328,-399]],[[243,-442],[0,0],[243,
-442],[304,-633],[304,-633,323,-638,411,-576],[499,-514,505,-340,243,-442]],[[151,-431],[0,0],[151,-431],[106,-626],[106,-626,193,-648,290,-636],[387,-624,400,-462,151,-431]],[[140,-428],[0,0],[140,-428],[89,-619],[89,-619,103,-635,170,-637],[237,-639,186,-429,140,-428]]]},swingDashAttack:{name:"swingDashAttack",frames:8,svg:"337,-126.915L0,0.085L337,-126.915l117,106c0,0,-114,96,-314,42S151,30.085,337,-126.915z 351,-172L0,0L351,-172l201,28c0,0,-22,80,-78,111S365,-1,351,-172z 332,-283L0,0L332,-283l204,-45c0,0,21,89,16,163S379,-25,332,-283z 233,-360L0,0L233,-360l167,-139c0,0,79,57,132,153S429,-228,233,-360z 134,-349L0,0L134,-349l100,-146c0,0,51,-14,125,-8S273,-350,134,-349z 83,-324L0,0L83,-324l56,-97c0,0,71.5,-64.5,99,-77S134,-327,83,-324z 46,-292L0,0L46,-292l27,-66c0,0,58,-58.5,67,-65S108,-320.5,46,-292z 6.121,-257l-6,257L6.121,-257l-19,-39c0,0,34,-37,80,-59S53.121,-288,6.121,-257z".split(" "),
path:[[[337,-127],[0,0],[337,-127],[454,-21],[454,-21,340,75,140,21],[-60,-33,151,30,337,-127]],[[351,-172],[0,0],[351,-172],[552,-144],[552,-144,530,-64,474,-33],[418,-2,365,-1,351,-172]],[[332,-283],[0,0],[332,-283],[536,-328],[536,-328,557,-239,552,-165],[547,-91,379,-25,332,-283]],[[233,-360],[0,0],[233,-360],[400,-499],[400,-499,479,-442,532,-346],[585,-250,429,-228,233,-360]],[[134,-349],[0,0],[134,-349],[234,-495],[234,-495,285,-509,359,-503],[433,-497,273,-350,134,-349]],[[83,-324],[0,0],
[83,-324],[139,-421],[139,-421,211,-485,238,-498],[266,-510,134,-327,83,-324]],[[46,-292],[0,0],[46,-292],[73,-358],[73,-358,131,-416,140,-423],[149,-430,108,-320,46,-292]],[[6,-257],[0,0],[6,-257],[-13,-296],[-13,-296,21,-333,67,-355],[113,-377,53,-288,6,-257]]]},swingUpsmash:{name:"swingUpsmash",frames:4,svg:["208,-268L0,0L208,-268l-25,-190c0,0,-10,17,-13,34S123.5,-224.5,208,-268z","74,-413L0,0L74,-413L58,-592l126,136l24,179L74,-413z","2,-702l57,109l13,173L7,-511L0,0l7,-511L2,-702z","4,-700l28,56l7,159L2,-511L0,0l2,-511L4,-700z"],
path:[[[208,-268],[0,0],[208,-268],[183,-458],[183,-458,173,-441,170,-424],[167,-407,124,-224,208,-268]],[[74,-413],[0,0],[74,-413],[58,-592],[184,-456],[208,-277],[74,-413]],[[2,-702],[59,-593],[72,-420],[7,-511],[0,0],[7,-511],[2,-702]],[[4,-700],[32,-644],[39,-485],[2,-511],[0,0],[2,-511],[4,-700]]]},swingDsmash1:{name:"swingDsmash1",frames:6,svg:"62.995,-217l-63,217L62.995,-217l-115,-88c0,0,18,-77,139,-108S49.995,-345,62.995,-217z 276.213,-85l-276,85L276.213,-85l-75,45c0,0,-184,-117,-247,-208S167.213,-151.5,276.213,-85z 428,-121L0,0L428,-121l168,82c0,0,-133,58,-353,11S373,-67,428,-121z 374,-148L0,0L374,-148L609,-36L378,-142L374,-148z 249,-157L0,0L249,-157l83,91c0,0,211.5,21,234,9S380.5,-146.5,249,-157z 249,-155L0,0L249,-155l81,91l-3,-24L249,-155z".split(" "),
path:[[[63,-217],[0,0],[63,-217],[-52,-305],[-52,-305,-34,-382,87,-413],[208,-444,50,-345,63,-217]],[[276,-85],[0,0],[276,-85],[201,-40],[201,-40,17,-157,-46,-248],[-109,-339,167,-151,276,-85]],[[428,-121],[0,0],[428,-121],[596,-39],[596,-39,463,19,243,-28],[23,-75,373,-67,428,-121]],[[374,-148],[0,0],[374,-148],[609,-36],[378,-142],[374,-148]],[[249,-157],[0,0],[249,-157],[332,-66],[332,-66,544,-45,566,-57],[589,-69,381,-146,249,-157]],[[249,-155],[0,0],[249,-155],[330,-64],[327,-88],[249,-155]]]},
swingDsmash2:{name:"swingDsmash2",frames:9,svg:"278,-117L0,0L278,-117l175,-8c0,0,20.5,45.5,20,76S424,-80,278,-117z 213,-130L0,0L213,-130l180,-4l61,9l-201,2L213,-130z 87,-101L0,0L87,-101l142,-33h72L87,-101z -195.064,-70l195,70L-195.064,-70l-4,42c0,0,389,-66,451,-103S41.936,-66,-195.064,-70z -275,-64L0,0L-275,-64l-211,34c0,0,97.211,15.146,147,11S-162.396,-72.042,-275,-64z -246,-82L0,0L-246,-82l-245,51l31,-15L-246,-82z -187,-103L0,0L-187,-103l-75,-35c0,0,-146.5,51.5,-190,90S-213.5,-91.5,-187,-103z -45.546,-145l46,145L-45.546,-145l188,-99c0,0,-65,-40,-388,98S-53.546,-144,-45.546,-145z 6.054,-160l-6,160L6.054,-160l171,-91c0,0,-23.5,1.5,-34,7S-46.946,-152.5,6.054,-160z".split(" "),
path:[[[278,-117],[0,0],[278,-117],[453,-125],[453,-125,474,-79,473,-49],[473,-19,424,-80,278,-117]],[[213,-130],[0,0],[213,-130],[393,-134],[454,-125],[253,-123],[213,-130]],[[87,-101],[0,0],[87,-101],[229,-134],[301,-134],[87,-101]],[[-195,-70],[0,0],[-195,-70],[-199,-28],[-199,-28,190,-94,252,-131],[314,-168,42,-66,-195,-70]],[[-275,-64],[0,0],[-275,-64],[-486,-30],[-486,-30,-389,-15,-339,-19],[-289,-23,-162,-72,-275,-64]],[[-246,-82],[0,0],[-246,-82],[-491,-31],[-460,-46],[-246,-82]],[[-187,-103],
[0,0],[-187,-103],[-262,-138],[-262,-138,-408,-86,-452,-48],[-496,-10,-213,-91,-187,-103]],[[-46,-145],[0,0],[-46,-145],[142,-244],[142,-244,77,-284,-246,-146],[-569,-8,-54,-144,-46,-145]],[[6,-160],[0,0],[6,-160],[177,-251],[177,-251,154,-249,143,-244],[133,-239,-47,-152,6,-160]]]},swingSideB:{name:"swingSideB",frames:7,svg:"31.008,-389l-31,389L31.008,-389l-121,4c0,0,-37,62.5,-17,139S-137.492,-313.5,31.008,-389z 259.988,-406l-260,406L259.988,-406l-79,-166c0,0,-182,-11,-253,139S30.988,-441,259.988,-406z 392,-268L0,0L392,-268l167,-92c0,0,-134,-204,-309,-204S338,-376,392,-268z 353,-124L0,0L353,-124L524,-13c0,0,96,-169,32,-349S427,-235,353,-124z 213,-185L0,0L213,-185l95,120c0,0,151,71,210,55S279,-144,213,-185z 79,-276L0,0L79,-276l-70,-2c0,0,233,182,298,214S321,-103,79,-276z 60.08,-293L0.08,0L60.08,-293l-95,-41c0,0,14,30,43,55S68.08,-219,60.08,-293z".split(" "),
path:[[[31,-389],[0,0],[31,-389],[-90,-385],[-90,-385,-127,-322,-107,-246],[-87,-170,-137,-313,31,-389]],[[260,-406],[0,0],[260,-406],[181,-572],[181,-572,-1,-583,-72,-433],[-143,-283,31,-441,260,-406]],[[392,-268],[0,0],[392,-268],[559,-360],[559,-360,425,-564,250,-564],[75,-564,338,-376,392,-268]],[[353,-124],[0,0],[353,-124],[524,-13],[524,-13,620,-182,556,-362],[492,-542,427,-235,353,-124]],[[213,-185],[0,0],[213,-185],[308,-65],[308,-65,459,6,518,-10],[577,-26,279,-144,213,-185]],[[79,-276],
[0,0],[79,-276],[9,-278],[9,-278,242,-96,307,-64],[372,-32,321,-103,79,-276]],[[60,-293],[0,0],[60,-293],[-35,-334],[-35,-334,-21,-304,8,-279],[37,-254,68,-219,60,-293]]]},swingJab1:{name:"swingJab1",frames:10,svg:"299.051,-139.069l-299,139L299.051,-139.069l79,167c0,0,-279,117,-493,-122S4.051,-57.069,299.051,-139.069z 374,-230.933L0,0.067L374,-230.933l179,63c0,0,-50,112,-138,168C327,56.067,208,18.067,374,-230.933z 372,-341L0,0L372,-341l203,-49c0,0,17,129,-11,190S418,-110,372,-341z 313,-438L0,0L313,-438l207,-73c0,0,28,52,56,118S433,-242,313,-438z 163,-457L0,0L163,-457l153,-158c0,0,80,28,118,54S513,-423,163,-457z 48,-399L0,0L48,-399l62,-190c0,0,79,-23,139,-26S231,-479,48,-399z 6,-343L0,0L6,-343l15,-170c0,0,-13,1,47,-46S94,-448,6,-343z -2.717,-309l3,309L-2.717,-309l-53,-131c0,0,2,-17,28,-38S11.283,-359,-2.717,-309z -3,-268L0,0L-3,-268l-117,-98c0,0,-8,-5,23,-37S-4,-341,-3,-268z 3,-240L0,0L3,-240l-138,-44c0,0,-3,-9,11,-61S-11,-299,3,-240z".split(" "),
path:[[[299,-139],[0,0],[299,-139],[378,28],[378,28,99,145,-115,-94],[-329,-333,4,-57,299,-139]],[[374,-231],[0,0],[374,-231],[553,-168],[553,-168,503,-56,415,0],[327,56,208,18,374,-231]],[[372,-341],[0,0],[372,-341],[575,-390],[575,-390,592,-261,564,-200],[536,-139,418,-110,372,-341]],[[313,-438],[0,0],[313,-438],[520,-511],[520,-511,548,-459,576,-393],[604,-327,433,-242,313,-438]],[[163,-457],[0,0],[163,-457],[316,-615],[316,-615,396,-587,434,-561],[472,-535,513,-423,163,-457]],[[48,-399],[0,0],
[48,-399],[110,-589],[110,-589,189,-612,249,-615],[309,-618,231,-479,48,-399]],[[6,-343],[0,0],[6,-343],[21,-513],[21,-513,8,-512,68,-559],[128,-606,94,-448,6,-343]],[[-3,-309],[0,0],[-3,-309],[-56,-440],[-56,-440,-54,-457,-28,-478],[-2,-499,11,-359,-3,-309]],[[-3,-268],[0,0],[-3,-268],[-120,-366],[-120,-366,-128,-371,-97,-403],[-66,-435,-4,-341,-3,-268]],[[3,-240],[0,0],[3,-240],[-135,-284],[-135,-284,-138,-293,-124,-345],[-110,-397,-11,-299,3,-240]]]},swingJab2:{name:"swingJab2",frames:9,svg:"384,-164.082L0,-0.082L384,-164.082l122,151c0,0,-99,89,-283,38S364,-81.082,384,-164.082z 374,-279L0,0L374,-279l164,29c0,0,34,42,21,147S436,15,374,-279z 285,-368L0,0L285,-368l88,-32c0,0,154,120,166,149S504,-178,285,-368z 167,-385L0,0L167,-385l35,-39c0,0,138,11,171,24S341,-362,167,-385z 79,-350L0,0L79,-350l127,-73l7,4C213,-419,88.5,-342.5,79,-350z 18,-302L0,0L18,-302l-15,-1l54,-30L18,-302z 7.272,-259l-7,259L7.272,-259l-57,17c0,0,40.5,-52.5,53,-61S13.272,-291.5,7.272,-259z -1,-229L0,0L-1,-229l-82,21c0,0,45,-54,60,-66S-1,-244.5,-1,-229z 10.129,-196l-10,196L10.129,-196l-115,30c0,0,9.5,-26,19,-43S1.129,-222,10.129,-196z".split(" "),
path:[[[384,-164],[0,0],[384,-164],[506,-13],[506,-13,407,76,223,25],[39,-26,364,-81,384,-164]],[[374,-279],[0,0],[374,-279],[538,-250],[538,-250,572,-208,559,-103],[546,2,436,15,374,-279]],[[285,-368],[0,0],[285,-368],[373,-400],[373,-400,527,-280,539,-251],[551,-222,504,-178,285,-368]],[[167,-385],[0,0],[167,-385],[202,-424],[202,-424,340,-413,373,-400],[406,-387,341,-362,167,-385]],[[79,-350],[0,0],[79,-350],[206,-423],[213,-419],[213,-419,89,-342,79,-350]],[[18,-302],[0,0],[18,-302],[3,-303],
[57,-333],[18,-302]],[[7,-259],[0,0],[7,-259],[-50,-242],[-50,-242,-9,-294,3,-303],[16,-312,13,-291,7,-259]],[[-1,-229],[0,0],[-1,-229],[-83,-208],[-83,-208,-38,-262,-23,-274],[-8,-286,-1,-244,-1,-229]],[[10,-196],[0,0],[10,-196],[-105,-166],[-105,-166,-95,-192,-86,-209],[-76,-226,1,-222,10,-196]]]},hitFlair:{name:"hitFlair",frames:8},hitSparks:{name:"hitSparks",frames:3,svg1:["-35.038,-58.969l-61,-167l27,26l-26,-117l53,126l-40,-235l57,219l15,-68l21,111l63,-243l-11,228l33,-67l-6,59l45,-123l-67,221l36,-64l-38,99l78,-66l-37,46l46,-13l-75,78l115,-39l-47,28l45,7l-69,21l88,23l-95,14l41,10l-40,7l21,24l-40,-2l26,45l-59,-42C63.962,87.031,19.962,-174.969,-35.038,-58.969"],
svg2:["212.375,-99.155l103,-69l-37,38l65,-20l-47,32l67,-21l-61,46l18,11l-14,7l84,-2l-151,29l39,-25l-27,-2l23,-10l-66,20l51,-30l-31,2l33,-20L212.375,-99.155"],path1:[[-35,-59],[-96,-226],[-69,-200],[-95,-317],[-42,-191],[-82,-426],[-25,-207],[-10,-275],[11,-164],[74,-407],[63,-179],[96,-246],[90,-187],[135,-310],[68,-89],[104,-153],[66,-54],[144,-120],[107,-74],[153,-87],[78,-9],[193,-48],[146,-20],[191,-13],[122,8],[210,31],[115,45],[156,55],[116,62],[137,86],[97,84],[123,129],[64,87]],path2:[[212,
-99],[315,-168],[278,-130],[343,-150],[296,-118],[363,-139],[302,-93],[320,-82],[306,-75],[390,-77],[239,-48],[278,-73],[251,-75],[274,-85],[208,-65],[259,-95],[228,-93],[261,-113],[212,-99]]},hitCurve:{name:"hitCurve",frames:10,svg:"M-31.706,133.877c0,0,41.958-39.632,45.247-135.092c3.288-95.459-43.856-144.771-43.856-144.771S19.189-1.544-31.706,133.877"},groundBounce:{name:"groundBounce",frames:8,colour:"rgba(102,255,56,",path:[[[0,0],[-94,0],[-207,-259],[-110,-81],[-120,-116],[-77,-51],[-155,-184],
[-95,-109],[-99,-171],[-63,-76],[-72,-128],[-53,-81],[-89,-287],[-41,-108],[-35,-177],[-20,-125],[-22,-419],[-5,-170],[8,-227],[10,-130],[17,-208],[23,-123],[58,-303],[49,-161],[105,-433],[64,-144],[81,-223],[61,-100],[74,-123],[70,-96],[91,-165],[83,-117],[115,-182],[95,-112],[157,-185],[94,-83],[113,-100],[104,-52],[143,-120],[127,-80],[187,-183],[165,-129],[189,-162],[96,-1]],[[0,0],[-168,-4],[-326,-135],[-165,-38],[-300,-162],[-176,-92],[-228,-175],[-88,-72],[-140,-200],[-92,-137],[-137,-377],
[-59,-129],[-79,-316],[-23,-150],[-8,-211],[12,-149],[25,-187],[23,-88],[43,-184],[41,-137],[61,-253],[63,-146],[89,-207],[86,-118],[201,-380],[97,-74],[146,-97],[113,-59],[172,-94],[167,-79],[219,-133],[186,-59],[198,-59],[177,-27],[315,-125],[169,0]],[[0,0],[-227,-1],[-515,-148],[-220,-23],[-461,-171],[-283,-105],[-367,-167],[-253,-120],[-290,-161],[-140,-86],[-284,-376],[-128,-109],[-144,-201],[-117,-163],[-127,-241],[-107,-179],[-115,-261],[-38,-97],[-32,-185],[-19,-106],[-1,-143],[6,-104],[45,
-312],[49,-119],[100,-202],[70,-121],[105,-142],[98,-110],[211,-336],[122,-57],[154,-84],[140,-57],[377,-171],[175,-34],[317,-101],[286,-68],[538,-189],[232,0]],[[0,0],[-281,0],[-448,-84],[-253,-45],[-610,-172],[-265,-73],[-382,-146],[-226,-75],[-303,-133],[-181,-81],[-264,-160],[-204,-133],[-352,-362],[-179,-153],[-90,-99],[-92,-208],[-50,-118],[-27,-233],[-5,-140],[14,-162],[34,-115],[119,-292],[94,-82],[215,-272],[151,-96],[226,-194],[173,-76],[439,-182],[243,-59],[448,-125],[210,-14],[558,-107],
[275,2]],[[0,0],[-327,-2],[-622,-59],[-205,-20],[-540,-139],[-241,-53],[-575,-218],[-193,-75],[-353,-249],[-159,-62],[-196,-161],[-169,-123],[-291,-392],[-73,-63],[-77,-147],[-21,-54],[-34,-204],[0,-59],[5,-139],[17,-84],[59,-142],[52,-85],[135,-223],[144,-128],[192,-176],[197,-111],[313,-228],[202,-52],[396,-111],[342,-75],[552,-139],[315,-36],[361,-38],[328,-13],[616,-62],[329,0]],[[0,0],[-325,0],[-655,-44],[-315,-10],[-399,-51],[-266,-36],[-618,-137],[-253,-46],[-337,-108],[-196,-59],[-286,-164],
[-182,-69],[-305,-257],[-177,-125],[-235,-265],[-82,-75],[-67,-114],[-64,-72],[-34,-360],[9,-105],[49,-176],[53,-69],[84,-141],[88,-80],[204,-161],[192,-132],[295,-200],[200,-47],[546,-153],[235,-20],[435,-46],[370,-10],[704,-52],[359,2]],[[0,0],[-394,1],[-694,-51],[-202,-16],[-625,-132],[-224,-38],[-339,-111],[-194,-51],[-285,-151],[-187,-69],[-323,-263],[-183,-124],[-246,-274],[-70,-55],[-90,-156],[-56,-97],[-34,-264],[19,-82],[59,-170],[51,-81],[96,-118],[91,-50],[213,-164],[208,-130],[309,-196],
[185,-47],[539,-139],[257,-31],[355,-38],[314,-15],[661,-40],[378,2]],[[0,0],[-398,3],[-760,-25],[-323,-6],[-333,-15],[-80,-23],[-121,-41],[-16,-24],[-35,-41],[-1,-27],[25,-45],[21,-27],[162,-41],[148,-24],[306,-27],[246,-11],[546,-41],[421,-12],[838,-53],[403,4]]]},furaFura:{name:"furaFura",frames:30},breakShield:{name:"breakShield",frames:20},shieldup:{name:"shieldup",frames:6},wallBounce:{name:"wallBounce"},tech:{name:"tech",frames:9},start:{name:"start",frames:120},entrance:{name:"entrance",frames:60},
clank:{name:"clank",frames:10},powershield:{name:"powershield",frames:8},targetDestroy:{name:"targetDestroy",frames:8}};vfx.wallBounce.path=vfx.groundBounce.path;vfx.wallBounce.colour=vfx.groundBounce.colour;vfx.wallBounce.frames=vfx.groundBounce.frames;
dVfx={general:function(a,b){var d=vfxQueue[a][0].colour+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.8+")";c.save();c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);c.rotate(b);drawArrayPath(d,vfxQueue[a][3],0,0,vfxQueue[a][0].path[vfxQueue[a][1]-1],stage.scale/4.5*.2,stage.scale/4.5*.2);c.restore()},swing:function(a){var b=vfxQueue[a][0].path[vfxQueue[a][4]],d=vfxQueue[a][3];c.fillStyle="rgba(97, 226, 255,"+(vfxQueue[a][0].frames-
vfxQueue[a][1])/vfxQueue[a][0].frames*.9*.65+")";c.beginPath();for(var e=0;e<b.length;e++){var f=stage.scale/4.5*b[e][0]*.2*d+vfxQueue[a][2].x*stage.scale+stage.offset[0],h=stage.scale/4.5*b[e][1]*.2+vfxQueue[a][2].y*-stage.scale+stage.offset[1];0==e?c.moveTo(f,h):2<b[e].length?c.bezierCurveTo(f,h,stage.scale/4.5*b[e][2]*.2*d+vfxQueue[a][2].x*stage.scale+stage.offset[0],stage.scale/4.5*b[e][3]*.2+vfxQueue[a][2].y*-stage.scale+stage.offset[1],stage.scale/4.5*b[e][4]*.2*d+vfxQueue[a][2].x*stage.scale+
stage.offset[0],stage.scale/4.5*b[e][5]*.2+vfxQueue[a][2].y*-stage.scale+stage.offset[1]):c.lineTo(f,h)}c.closePath();c.fill()},impactLand:function(a){dVfx.general(a,0)},circleDust:function(a){for(var b=0;b<vfxQueue[a][0].circles.length;b++){var d=(vfxQueue[a][2].x+vfxQueue[a][0].circles[b]*(1+vfxQueue[a][1]/vfxQueue[a][0].frames))*stage.scale+stage.offset[0],e=(vfxQueue[a][2].y+4*(0+vfxQueue[a][1]/vfxQueue[a][0].frames))*-stage.scale+stage.offset[1];c.fillStyle="rgba(255,255,255,"+(vfxQueue[a][0].frames-
vfxQueue[a][1])/vfxQueue[a][0].frames*.7+")";c.beginPath();c.arc(d,e,stage.scale/4.5*12,twoPi,0);c.fill()}},flyingDust:function(a){c.fillStyle="rgba(255,255,255,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.7+")";c.beginPath();c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1],stage.scale/4.5*12,twoPi,0);c.fill()},dashDust:function(a){dVfx.general(a,0)},doubleJumpRings:function(a){c.strokeStyle="rgba(99,190,255,"+(vfxQueue[a][0].frames-
vfxQueue[a][1])/vfxQueue[a][0].frames*.7+")";for(var b=0;b<vfxQueue[a][0].rings.length;b++)c.save(),c.scale(1,.25),c.beginPath(),c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],4*(vfxQueue[a][2].y*-stage.scale+stage.offset[1]),5*vfxQueue[a][1]+b*stage.scale,twoPi,0),c.lineWidth=3,c.stroke(),c.closePath(),c.restore()},blastzoneExplosion:function(a){c.save();c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);c.rotate(vfxQueue[a][3]*Math.PI/180);
var b="rgba(149,255,163,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.8+")";drawArrayPath(b,1,0,-200-(20+vfxQueue[a][1]/20*100),vfxQueue[a][0].path1,1.3,1.3);vfxQueue[a][1]>=vfxQueue[a][0].svg2Active[0]&&vfxQueue[a][1]<=vfxQueue[a][0].svg2Active[1]&&drawArrayPath("rgb(166,223,255)",1,0,-90,vfxQueue[a][0].path2,1.5*vfxQueue[a][0].svg2Scale[vfxQueue[a][1]-1][0],1.5*vfxQueue[a][0].svg2Scale[vfxQueue[a][1]-1][1]);vfxQueue[a][1]>=vfxQueue[a][0].svg3Active[0]&&vfxQueue[a][1]<=vfxQueue[a][0].svg3Active[1]&&
drawArrayPath("rgb(255,161,161)",1,0,-90,vfxQueue[a][0].path2,1.5*vfxQueue[a][0].svg3Scale[vfxQueue[a][1]-vfxQueue[a][0].svg3Active[0]][0],1.5*vfxQueue[a][0].svg3Scale[vfxQueue[a][1]-vfxQueue[a][0].svg3Active[0]][1]);b="rgba(242,255,93,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.8+")";drawArrayPath(b,1,0,0,vfxQueue[a][0].path4,1.5,1.5);10>vfxQueue[a][1]&&(c.fillStyle="rgba(255,255,255,"+(10-vfxQueue[a][1])/10*.8+")",c.scale(.5,1),c.beginPath(),c.arc(0,0,vfxQueue[a][1]/10*450+170,
twoPi,0),c.fill(),c.closePath());c.restore()},cliffcatchspark:function(a){c.save();c.strokeStyle="rgb(47, 194, 214)";c.lineWidth=10-vfxQueue[a][1]/3;c.beginPath();c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1],stage.scale/4.5*(vfxQueue[a][1]/vfxQueue[a][0].frames*12+3),twoPi,0);c.stroke();c.restore()},hitFlair:function(a){var b=vfxQueue[a][2].x*stage.scale+stage.offset[0],d=vfxQueue[a][2].y*-stage.scale+stage.offset[1];c.strokeStyle="rgba(146,217,164,"+
(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.7+")";c.lineWidth=5;c.beginPath();c.arc(b,d,15,twoPi,0);c.closePath();c.stroke();c.lineWidth=1;c.fillStyle="rgba(146,217,164,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.8+")";c.beginPath();c.moveTo(b+3,d-3);c.lineTo(b+30,d);c.lineTo(b+3,d+3);c.lineTo(b,d+30);c.lineTo(b-3,d+3);c.lineTo(b-30,d);c.lineTo(b-3,d-3);c.lineTo(b,d-30);c.closePath();c.fill()},hitSparks:function(a){drawArrayPath("rgba(143,128,233,0.7)",vfxQueue[a][3],
vfxQueue[a][2].x*stage.scale+stage.offset[0]+10,vfxQueue[a][2].y*-stage.scale+stage.offset[1],vfxQueue[a][0].path1,stage.scale/4.5*.2,stage.scale/4.5*.2);drawArrayPath("rgba(143,128,233,0.7)",vfxQueue[a][3],vfxQueue[a][2].x*stage.scale+stage.offset[0]+10,vfxQueue[a][2].y*-stage.scale+stage.offset[1],vfxQueue[a][0].path2,stage.scale/4.5*.2,stage.scale/4.5*.2);c.save();c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);c.rotate(Math.PI);drawArrayPath("rgba(143,128,233,0.7)",
vfxQueue[a][3],0,0,vfxQueue[a][0].path1,stage.scale/4.5*.2,stage.scale/4.5*.2);drawArrayPath("rgba(143,128,233,0.7)",vfxQueue[a][3],0,0,vfxQueue[a][0].path2,stage.scale/4.5*.2,stage.scale/4.5*.2);c.restore()},hitCurve:function(a){},groundBounce:function(a){dVfx.general(a,0)},wallBounce:function(a){vfxQueue[a][4]?dVfx.general(a,Math.PI/2):dVfx.general(a,1.5*Math.PI)},furaFura:function(a){c.fillStyle="rgba(255,254,108,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.9+")";c.beginPath();
c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1],stage.scale/4.5*5,twoPi,0);c.fill()},breakShield:function(a){c.fillStyle="rgba(73,255,244,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.9+")";c.beginPath();c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+430,stage.scale/4.5*(10+3*vfxQueue[a][1]),twoPi,0);c.fill();c.fillStyle="#cd8eff";for(var b=0;3>b;b++)c.beginPath(),c.arc(vfxQueue[a][2].x*stage.scale+
550+100*Math.random(),vfxQueue[a][2].y*-stage.scale+380+100*Math.random(),stage.scale/4.5*8,twoPi,0),c.fill()},powershield:function(a){if(vfxQueue[a][1]%2){c.save();c.fillStyle="rgba(255,255,255,0.3)";c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);a=stage.scale/4.5*(Math.random()+1.5);c.scale(a,a);for(a=0;6>a;a++)c.rotate(Math.PI/3),c.beginPath(),c.moveTo(0,-15),c.lineTo(6,-23),c.lineTo(0,-40),c.lineTo(-6,-23),c.closePath(),c.fill();c.restore()}},
targetDestroy:function(a){c.save();c.fillStyle="rgba(255,255,255,0.8)";c.strokeStyle="rgba(255,255,255,0.8)";c.lineWidth=3;c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);c.beginPath();c.arc(0,0,2*vfxQueue[a][1],0,twoPi);c.closePath;c.stroke();c.scale(stage.scale/4.5,stage.scale/4.5);for(var b=0;6>b;b++)c.rotate(Math.PI/3),c.beginPath(),c.moveTo(0,-14-2*vfxQueue[a][1]),c.lineTo(6,-22-2*vfxQueue[a][1]),c.lineTo(0,-40-2*vfxQueue[a][1]),c.lineTo(-6,
-22-2*vfxQueue[a][1]),c.closePath(),c.fill();c.restore()},shieldup:function(a){c.strokeStyle="rgba(255,255,255,"+(vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.8+")";c.lineWidth=10;c.beginPath();c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1],vfxQueue[a][4]*stage.scale+10+5*(vfxQueue[a][1]-1),twoPi,0);c.stroke();c.lineWidth=5;c.beginPath();c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1],
vfxQueue[a][4]*stage.scale+5*(vfxQueue[a][1]-1),twoPi,0);c.stroke();c.lineWidth=1},tech:function(a){c.save();c.strokeStyle="rgba(251,246, 119,"+((vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.3+.7)+")";c.fillStyle="rgba(255,116,92,"+((vfxQueue[a][0].frames-vfxQueue[a][1])/vfxQueue[a][0].frames*.3+.7)+")";c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);c.lineWidth=3;c.scale(Math.min(.2*vfxQueue[a][1],1),Math.min(.2*vfxQueue[a][1],
1));c.rotate(vfxQueue[a][1]*Math.PI/8);for(a=0;4>a;a++)c.scale(.7+.6*Math.random(),.7+.6*Math.random()),c.rotate(a*Math.PI/2),c.beginPath(),c.arc(0,0,stage.scale/4.5*10,1.35*Math.PI,1.65*Math.PI),c.closePath(),c.stroke(),c.beginPath(),c.arc(0,0,stage.scale/4.5*15,1.35*Math.PI,1.65*Math.PI),c.closePath(),c.stroke(),c.beginPath(),c.arc(0,0,stage.scale/4.5*20,1.35*Math.PI,1.65*Math.PI),c.closePath(),c.stroke(),c.beginPath(),c.arc(0,0,stage.scale/4.5*23,1.35*Math.PI,1.65*Math.PI),c.closePath(),c.fill();
c.restore()},start:function(a){1==vfxQueue[a][1]&&playSfx("ready");90==vfxQueue[a][1]&&playSfx("go");if(90>vfxQueue[a][1]){var b=c.createLinearGradient(0,200,0,500);b.addColorStop(0,"rgb(255, 51, 51)");b.addColorStop(.6,"rgb(255, 51, 51)");b.addColorStop(1,"rgb(121, 0, 0)");c.save();c.fillStyle=b;c.textAlign="start";c.lineWidth=20;c.strokeStyle="black";c.font="italic 900 200px Arial";c.strokeText("Ready",240,420);c.lineWidth=10;c.strokeStyle="white";c.strokeText("Ready",240,420);c.fillText("Ready",
240,420);c.fillStyle="rgb("+Math.round(2.6*vfxQueue[a][1])+","+Math.round(140-1.5*vfxQueue[a][1])+","+Math.round(255-2.6*vfxQueue[a][1])+")";c.font="italic 700 70px Arial";b=(2*startTimer%1).toFixed(2);c.strokeStyle="black";c.strokeText(Math.floor(2*startTimer)+" "+b[2]+b[3],900,500);c.fillText(Math.floor(2*startTimer)+" "+b[2]+b[3],900,500);c.fillStyle="rgba(255,0,0,0.2)";c.fillRect(240,450,520,15);b=c.createLinearGradient(240+vfxQueue[a][1]/90*500,450,760+vfxQueue[a][1]/90*500,465);b.addColorStop(0,
"#ff0000");b.addColorStop(.16,"#ff00ff");b.addColorStop(.33,"#0000ff");b.addColorStop(.49,"#00ffff");b.addColorStop(.66,"#00ff00");b.addColorStop(.83,"#ffff00");b.addColorStop(1,"#ff0000");c.fillStyle=b;c.fillRect(240+vfxQueue[a][1]/90*500,450,520-vfxQueue[a][1]/90*500,15)}else b=c.createLinearGradient(0,200,0,480),b.addColorStop(0,"black"),b.addColorStop(.6,"black"),b.addColorStop(1,"rgb(221, 145, 57)"),c.save(),c.fillStyle=b,c.textAlign="start",c.lineWidth=40,c.strokeStyle="black",c.font="900 400px Arial",
c.strokeText("Go!",240,470),c.lineWidth=20,c.strokeStyle="white",c.strokeText("Go!",240,470),c.fillText("Go!",240,470);c.restore()},entrance:function(a){c.save();c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);for(var b=0,d=vfxQueue[a][1]*Math.PI/32,e=0;8>e;e++){var f=Math.random()-.5,b=new Vec2D(35*Math.cos(d),14*Math.sin(d)),h=c.createLinearGradient(0,0,0,2*-vfxQueue[a][1]-60*f);h.addColorStop(0,"rgba(255, 255, 255, 0.3)");h.addColorStop(.5,
"rgba(255, 255, 255, 0.3)");h.addColorStop(1,"rgba(255, 255, 255, 0.0)");c.fillStyle=h;c.fillRect(b.x,b.y-(2*vfxQueue[a][1]+60*f),stage.scale/4.5*10,stage.scale/4.5*(2*vfxQueue[a][1]+60*f));d+=Math.PI/4}c.fillStyle="rgba(163, 255, 203, 0.3)";c.fillRect(-35,5*-(vfxQueue[a][1]%15),stage.scale/4.5*80,stage.scale/4.5*15);c.restore();c.save();c.translate(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1]);c.strokeStyle="rgba(255, 149, 149, 0.8)";c.lineWidth=8;c.scale(.8+
.3*Math.random(),.2+.2*Math.random());c.beginPath();c.arc(5,3*-vfxQueue[a][1],stage.scale/4.5*(35+vfxQueue[a][1]%2*10),0,twoPi);c.closePath();c.stroke();c.restore()},clank:function(a){c.save();c.strokeStyle="rgb(47, 214, 114)";c.lineWidth=10-vfxQueue[a][1]/3;c.beginPath();c.arc(vfxQueue[a][2].x*stage.scale+stage.offset[0],vfxQueue[a][2].y*-stage.scale+stage.offset[1],stage.scale/4.5*(vfxQueue[a][1]/vfxQueue[a][0].frames*12+3),twoPi,0);c.stroke();c.restore()}};hitQueue=[];angleConversion=Math.PI/180;
function hitDetection(a){for(var b=!1,d=0;4>d;d++)if(-1<playerType[d]&&d!=a){for(var e=!1,f=0;f<player[a].hitboxes.hitList.length;f++)if(d==player[a].hitboxes.hitList[f]){e=!0;break}if(!e)for(e=0;4>e;e++)if(player[a].hitboxes.active[e]&&(!player[a].phys.thrownHitbox||player[a].phys.thrownHitboxOwner!=d)){if(1==player[a].hitboxes["id"+e].clank||2==player[a].hitboxes["id"+e].clank&&player[a].phys.grounded)for(f=0;4>f;f++)if(player[d].hitboxes.active[f]&&(1==player[d].hitboxes["id"+f].clank||2==player[d].hitboxes["id"+
f].clank&&player[d].phys.grounded)){var h=hitHitCollision(d,a,e,f);if(h[0]){var q=player[a].hitboxes["id"+e].dmg-player[d].hitboxes["id"+f].dmg;9<=q?(player[d].hit.hitlag=Math.floor(1/3*player[a].hitboxes["id"+e].dmg+3),turnOffHitboxes(d),aS[78].init(d)):(-9>=q?(player[a].hit.hitlag=Math.floor(1/3*player[d].hitboxes["id"+f].dmg+3),b=!0):(player[d].hit.hitlag=Math.floor(1/3*player[a].hitboxes["id"+e].dmg+3),player[a].hit.hitlag=Math.floor(1/3*player[d].hitboxes["id"+f].dmg+3),b=!0,turnOffHitboxes(d),
aS[78].init(d)),turnOffHitboxes(a),aS[78].init(a));playSfx("clank");drawVfx("clank",h[1]);player[a].hitboxes.hitList.push(d);break}}if(!b)if(player[d].phys.shielding&&hitShieldCollision(d,a,e)){hitQueue.push([d,a,e,!0,!1,!1]);player[a].hitboxes.hitList.push(d);break}else if(1!=player[d].phys.hurtBoxState&&hitHurtCollision(d,a,e)){hitQueue.push([d,a,e,!1,!1,!1]);player[a].hitboxes.hitList.push(d);break}}}}
function hitHitCollision(a,b,d,e){var f=new Vec2D(player[b].phys.pos.x+player[b].hitboxes["id"+d].offset[player[b].hitboxes.frame].x*player[b].phys.face,player[b].phys.pos.y+player[b].hitboxes["id"+d].offset[player[b].hitboxes.frame].y),h=new Vec2D(player[a].phys.pos.x+player[a].hitboxes["id"+e].offset[player[a].hitboxes.frame].x*player[a].phys.face,player[a].phys.pos.y+player[a].hitboxes["id"+e].offset[player[a].hitboxes.frame].y),q=new Vec2D((f.x+h.x)/2,(f.y+h.y)/2);return[Math.pow(h.x-f.x,2)+Math.pow(f.y-
h.y,2)<=Math.pow(player[b].hitboxes["id"+d].size+player[a].hitboxes["id"+e].size,2),q]}function hitShieldCollision(a,b,d){var e=new Vec2D(player[b].phys.pos.x+player[b].hitboxes["id"+d].offset[player[b].hitboxes.frame].x*player[b].phys.face,player[b].phys.pos.y+player[b].hitboxes["id"+d].offset[player[b].hitboxes.frame].y),f=player[a].phys.shieldPositionReal;return Math.pow(f.x-e.x,2)+Math.pow(e.y-f.y,2)<=Math.pow(player[b].hitboxes["id"+d].size+player[a].phys.shieldSize,2)}
function hitHurtCollision(a,b,d){var e=player[b].hitboxes["id"+d].offset[player[b].hitboxes.frame];39==player[b].actionState&&(e=player[b].hitboxes["id"+d].offset[0]);e=new Vec2D(player[b].phys.pos.x+e.x*player[b].phys.face,player[b].phys.pos.y+e.y);a=new Vec2D((player[a].phys.hurtbox.min.x+player[a].phys.hurtbox.max.x)/2,(player[a].phys.hurtbox.min.y+player[a].phys.hurtbox.max.y)/2);a=new Vec2D(Math.abs(e.x-a.x),Math.abs(e.y-a.y));return a.x>4+player[b].hitboxes["id"+d].size||a.y>9+player[b].hitboxes["id"+
d].size?!1:4>=a.x||9>=a.y?!0:Math.pow(a.x-4,2)+Math.pow(a.y-9,2)<=Math.pow(player[b].hitboxes["id"+d].size,2)}
function executeHits(){for(var a=[],b=[!1,!1,!1,!1],d=0;d<hitQueue.length;d++){var e=hitQueue[d][0],f=hitQueue[d][1],h=hitQueue[d][2],q=hitQueue[d][3],n=hitQueue[d][4],m=hitQueue[d][5];if(2==gameMode)q?(playSfx("blunthit"),player[e].hit.hitlag=Math.floor(1/3*g+3),player[e].phys.powerShieldActive&&(player[e].phys.powerShielded=!0,player[e].hit.powershield=!0,drawVfx("impactLand",player[e].phys.pos,player[e].phys.face),drawVfx("powershield",player[e].phys.shieldPositionReal,player[e].phys.face),playSfx("powershield")),
player[e].hit.shieldstun=Math.floor(g)*(.65*(1-(player[e].phys.shieldAnalog-.3)/.7)+.3)*1.5+2):(player[f].rpsPoints++,player[e].hit.hitlag=Math.floor(1/3*g+3),player[e].hit.knockback=getKnockback(player[f].hitboxes["id"+h],g,g,0,player[e].charAttributes.weight),player[e].hit.hitPoint=new Vec2D(player[f].phys.pos.x+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].x*player[f].phys.face,player[f].phys.pos.y+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].y),player[f].phys.pos.x<
player[e].phys.pos.x?(player[e].hit.reverse=!1,player[e].phys.face=-1):(player[e].hit.reverse=!0,player[e].phys.face=1),aS[41].init(e),screenShake(player[e].hit.knockback),playSfx("swordreallystronghit"));else if(72==player[e].actionState&&sounds.furaloop.stop(player[e].furaLoopID),2==player[f].hitboxes["id"+h].type)aS[player[e].actionState].canBeGrabbed&&a.push([f,e,!1]);else{b[e]=!0;var g=player[f].hitboxes["id"+h].dmg;player[e].phys.grabTech=!1;player[f].phys.charging&&(g*=1+.3671/60*player[f].phys.chargeFrames);
player[f].hit.hitlag=Math.floor(1/3*g+3);if(q){if(!player[e].phys.powerShieldActive&&(player[e].phys.shieldHP-=g,0>player[e].phys.shieldHP)){player[e].phys.shielding=!1;player[e].phys.cVel.y=2.5;player[e].phys.grounded=!1;player[e].phys.shieldHP=0;drawVfx("breakShield",player[e].phys.pos,player[e].phys.face);aS[69].init(e);break}player[e].hit.hitlag=Math.floor(1/3*g+3);q=.6;player[e].phys.powerShieldActive?(q=1,player[e].phys.powerShielded=!0,player[e].hit.powershield=!0,drawVfx("impactLand",player[e].phys.pos,
player[e].phys.face),drawVfx("powershield",player[e].phys.shieldPositionReal,player[e].phys.face),playSfx("powershield")):drawVfx("clank",new Vec2D(player[f].phys.pos.x+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].x*player[f].phys.face,player[f].phys.pos.y+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].y));player[e].hit.shieldstun=Math.floor(g)*(.65*(1-(player[e].phys.shieldAnalog-.3)/.7)+.3)*1.5+2;h=(Math.floor(g)*(.195*(1-(player[e].phys.shieldAnalog-.3)/.7)+.09)+.4)*
q;2<h&&(h=2);q=.1*Math.floor(g)*(player[e].phys.shieldAnalog-.3)+.02;player[f].phys.pos.x<player[e].phys.pos.x?(player[e].phys.cVel.x+=h,player[f].phys.cVel.x-=q):(player[e].phys.cVel.x-=h,player[f].phys.cVel.x+=q);aS[22].init(e)}else 0==player[e].phys.hurtBoxState?(player[e].hit.knockback=getKnockback(player[f].hitboxes["id"+h],g,g,player[e].percent,player[e].charAttributes.weight),player[e].hit.angle=player[f].hitboxes["id"+h].angle,361==player[e].hit.angle&&(32.1>player[e].hit.knockback?player[e].hit.angle=
0:32.1<=player[e].hit.knockback&&(player[e].hit.angle=44)),player[e].hit.hitlag=Math.floor(1/3*g+3),n?(player[e].phys.thrownHitbox=!0,player[e].phys.thrownHitboxOwner=f,player[e].phys.pos=new Vec2D(player[f].phys.pos.x+player[f].hitboxes["id"+h].offset.x*player[f].phys.face,player[f].phys.pos.y+player[f].hitboxes["id"+h].offset.y),player[e].phys.grabbedBy=-1,player[e].hit.hitlag=1,player[f].hit.hitlag=1,player[e].hit.reverse=1==player[f].phys.face?!1:!0,m&&(playSfx("bounce"),drawVfx("groundBounce",
player[e].phys.pos,player[e].phys.face))):(player[e].hit.hitPoint=new Vec2D(player[f].phys.pos.x+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].x*player[f].phys.face,player[f].phys.pos.y+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].y),player[f].phys.pos.x<player[e].phys.pos.x?(player[e].hit.reverse=!1,player[e].phys.face=-1):(player[e].hit.reverse=!0,player[e].phys.face=1)),player[e].percent+=g,-1==player[e].phys.grabbedBy||44<player[e].hit.knockback?(player[e].hit.hitstun=
getHitstun(player[e].hit.knockback),80<=player[e].hit.knockback||n?aS[39].init(e,!n):aS[41].init(e)):aS[80].init(e),player[e].phys.grounded&&180<player[e].hit.angle&&80<=player[e].hit.knockback&&(playSfx("bounce"),drawVfx("groundBounce",player[e].phys.pos,player[e].phys.face),player[e].hit.angle=360-player[e].hit.angle,player[e].hit.knockback*=.8),screenShake(player[e].hit.knockback),percentShake(player[e].hit.knockback,e),n?playSfx("stronghit"):0==player[f].hitboxes["id"+h].type?playSfx("normalweakhit"):
50>player[e].hit.knockback?playSfx("swordweakhit"):100>player[e].hit.knockback?playSfx("swordmediumhit"):140>player[e].hit.knockback?playSfx("swordstronghit"):(playSfx("swordreallystronghit"),playSfx("cheer"),280>player[e].hit.knockback?(playSfx("stronghit"),playSfx("weakhurt")):(playSfx("strongerhit"),playSfx("stronghurt")))):(playSfx("blunthit"),drawVfx("clank",new Vec2D(player[f].phys.pos.x+player[f].hitboxes["id"+h].offset[player[f].hitboxes.frame].x*player[f].phys.face,player[f].phys.pos.y+player[f].hitboxes["id"+
h].offset[player[f].hitboxes.frame].y)))}}for(d=0;d<a.length;d++)if(!b[a[d][0]]){if(!a[d][2])for(g=0;g<a.length;g++)if(g!=d&&a[d][0]==a[g][1]){f=a[d][0];e=a[g][0];player[f].phys.pos.x<player[e].phys.pos.x?(player[f].phys.face=1,player[e].phys.face=-1):(player[f].phys.face=-1,player[e].phys.face=1);player[f].phys.grabTech=!0;player[e].phys.grabTech=!0;turnOffHitboxes(f);turnOffHitboxes(e);aS[77].init(f);aS[77].init(e);playSfx("parry");drawVfx("shieldup",new Vec2D((player[f].phys.pos.x+player[e].phys.pos.x)/
2,player[f].phys.pos.y+12),player[e].phys.face,3);a[d][2]=!0;a[g][2]=!0;break}a[d][2]||(f=a[d][0],e=a[d][1],-1!=player[e].phys.grabbedBy||-1!=player[f].phys.grabbing||0!=player[e].phys.hurtBoxState||player[e].phys.grabTech||(player[e].phys.cVel=new Vec2D(0,0),player[e].phys.kVel=new Vec2D(0,0),player[f].phys.cVel=new Vec2D(0,0),player[f].phys.kVel=new Vec2D(0,0),player[e].phys.grabbedBy=f,player[e].phys.shielding=!1,player[f].phys.grabbing=e,aS[74].init(e)))}}
function getKnockback(a,b,d,e,f){a=0==a.sk?.01*a.kg*(1.4*(.05*d*(b+Math.floor(e))+.1*(b+Math.floor(e)))*(2-.02*f/(1+.01*f))+18)+a.bk:a.kg/100*(200/(f+100)*(10*a.sk/20+1)*1.4+18)+a.bk;2500<a&&(a=2500);return a}
function getLaunchAngle(a,b,d,e,f,h){var q=!1,n;80>b&&player[h].phys.grounded&&(0==a||180==a)&&(q=!0);.2875>e&&-.2875<e&&(e=0);.2875>f&&-.2875<f&&(f=0);0==e&&0>f?n=270:0==e&&0<f?n=90:0==e&&0==f?q=!0:(n=180/Math.PI*Math.atan(f/e)*1,0>e?n+=180:0>f&&(n+=360));361==a?32.1>b?a=d?180:0:32.1<=b?a=d?136:44:(prompt("Why would this ever get called?"),a=440*(b-32),d&&(a=180-a,0>a&&(a=360+a))):d&&(a=180-a,0>a&&(a=360+a));q?e=0:(b=a-n,180<b&&(b-=360),e=Math.sin(b*angleConversion)*Math.sqrt(e*e+f*f),e=e*e*18,18<
e&&(e=18),0>b&&-180<b&&(e*=-1));a-=e;.01>a&&(a=0);return a}function getHorizontalVelocity(a,b){var d=.03*a*Math.cos(b*angleConversion);return d=Math.round(1E5*d)/1E5}function getVerticalVelocity(a,b,d,e){b=.03*a*Math.sin(b*angleConversion);b=Math.round(1E5*b)/1E5;80>a&&d&&(0==e||180==e)&&(b=0);return b}function getHorizontalDecay(a){a=.051*Math.cos(a*angleConversion);return a=Math.round(1E5*a)/1E5}function getVerticalDecay(a){a=.051*Math.sin(a*angleConversion);return a=Math.round(1E5*a)/1E5}
function getHitstun(a){return Math.floor(.4*a)}function Vec2D(a,b){this.x=a;this.y=b}function Box2D(a,b){this.min=new Vec2D(a[0],a[1]);this.max=new Vec2D(b[0],b[1])}
offsets={fair:{id0:[new Vec2D(9.26,16.34),new Vec2D(11.15,9.93),new Vec2D(9.19,5.23),new Vec2D(3.87,2.43)],id1:[new Vec2D(5.46,13.21),new Vec2D(6.26,10.84),new Vec2D(5.82,8.63),new Vec2D(3.93,6.98)],id2:[new Vec2D(.88,13.2),new Vec2D(1.14,12.76),new Vec2D(1.2,12.41),new Vec2D(1.21,12.14)],id3:[new Vec2D(11.1,21.41),new Vec2D(16.53,9.67),new Vec2D(13.15,1.64),new Vec2D(5.34,-2.18)]},bair:{id0:[new Vec2D(-11.71,6.43),new Vec2D(-13.16,13.32),new Vec2D(-9.65,17.03),new Vec2D(-4.29,17.32),new Vec2D(-3.64,
17.13)],id1:[new Vec2D(-7.88,9.56),new Vec2D(-8.73,11.06),new Vec2D(-7.8,12.38),new Vec2D(-5.82,12.95),new Vec2D(-5.42,12.91)],id2:[new Vec2D(-2.84,13.05),new Vec2D(-2.76,13.05),new Vec2D(-2.71,13.05),new Vec2D(-2.69,13.06),new Vec2D(-2.68,13.06)],id3:[new Vec2D(-13.71,1.75),new Vec2D(-18.52,13.41),new Vec2D(-12.25,21.73),new Vec2D(-2.71,22.27),new Vec2D(-2.02,22.08)]},dair:{id0:[new Vec2D(10.13,-.93),new Vec2D(-1.89,-4.63),new Vec2D(-9.24,.37),new Vec2D(-12.98,8.16)],id1:[new Vec2D(6.38,.55),new Vec2D(-1.68,
-.6),new Vec2D(-6.75,3.33),new Vec2D(-9.01,8.9)],id2:[new Vec2D(2.96,4.21),new Vec2D(.04,4.02),new Vec2D(-2.94,6.59),new Vec2D(-4.13,8.61)],id3:[new Vec2D(2.66,10.54),new Vec2D(2.71,10.14),new Vec2D(2.46,9.84),new Vec2D(1.93,9.66)]},upair:{id0:[new Vec2D(12.14,14.6),new Vec2D(7.42,23.27),new Vec2D(-1.33,26.74),new Vec2D(-10.99,23.29)],id1:[new Vec2D(7.46,16.76),new Vec2D(2.7,20.8),new Vec2D(-2.77,21.56),new Vec2D(-8.3,18.63)],id2:[new Vec2D(2.63,15.58),new Vec2D(-.33,16.52),new Vec2D(-2.6,16.32),
new Vec2D(-4.92,14.73)],id3:[new Vec2D(.43,11.46),new Vec2D(.25,12.43),new Vec2D(.07,12.93),new Vec2D(-.42,13.26)]},nair1:{id0:[new Vec2D(14.63,8.71),new Vec2D(6.37,12.57)],id1:[new Vec2D(8.65,10.24),new Vec2D(6.42,11.23)],id2:[new Vec2D(.07,13.43),new Vec2D(.67,13.4)],id3:[new Vec2D(-.47,7.74),new Vec2D(-.47,7.74)]},nair2:{id0:[new Vec2D(12.35,4.38),new Vec2D(.52,9.91),new Vec2D(-12.86,19.45),new Vec2D(-7.52,17.11),new Vec2D(5.76,10.14),new Vec2D(12.26,5.79),new Vec2D(11.8,5.33)],id1:[new Vec2D(7.18,
7.89),new Vec2D(-1.38,11.67),new Vec2D(-7.63,16.29),new Vec2D(-3.81,14.73),new Vec2D(3.67,11.08),new Vec2D(6.86,8.92),new Vec2D(6.69,8.52)],id2:[new Vec2D(.7,13.51),new Vec2D(.26,13.43),new Vec2D(1.01,12.94),new Vec2D(.8,13.13),new Vec2D(-.01,13.41),new Vec2D(-.68,13.66),new Vec2D(-.46,13.68)],id3:[new Vec2D(-.47,7.74),new Vec2D(-.47,7.74),new Vec2D(-.47,7.74),new Vec2D(-.47,7.74),new Vec2D(-.48,7.74),new Vec2D(-.48,7.74),new Vec2D(-.48,7.74)]},upb1:{id0:[new Vec2D(9.74,4.31)],id1:[new Vec2D(6.39,
6.58)],id2:[new Vec2D(-.53,5.88)]},upb2:{id0:[new Vec2D(13.85,13.53),new Vec2D(10.6,24.21),new Vec2D(8.68,26.72),new Vec2D(6.97,27.35),new Vec2D(4.78,27.94)],id1:[new Vec2D(9.83,13.99),new Vec2D(7.55,21.56),new Vec2D(5.85,23.84),new Vec2D(4.32,24.33),new Vec2D(2.61,24.55)],id2:[new Vec2D(.01,8.8),new Vec2D(.07,10.68),new Vec2D(.07,11.68),new Vec2D(.07,11.68),new Vec2D(.09,11.67)]},dtilt:{id0:[new Vec2D(18.9,2.38),new Vec2D(18.96,2.87),new Vec2D(18.81,2.94)],id1:[new Vec2D(13.12,4.02),new Vec2D(13.17,
4.45),new Vec2D(13.07,4.69)],id2:[new Vec2D(8.81,7.67),new Vec2D(8.72,7.77),new Vec2D(8.64,7.85)],id3:[new Vec2D(23.6,.88),new Vec2D(23.72,1.55),new Vec2D(23.57,1.62)]},uptilt1:{id0:[new Vec2D(14.64,13.62),new Vec2D(12.78,21.24),new Vec2D(7.78,23.94)],id1:[new Vec2D(9.86,15.22),new Vec2D(8.52,17.26),new Vec2D(6.52,18.25)],id2:[new Vec2D(3.56,13.4),new Vec2D(4.28,13.19),new Vec2D(5.37,12.98)],id3:[new Vec2D(16.87,10.48),new Vec2D(16.18,23.26),new Vec2D(9.25,27.69)]},uptilt2:{id0:[new Vec2D(3.5,23.34),
new Vec2D(.18,20.96),new Vec2D(-2,16.58),new Vec2D(-2.09,12.08)],id1:[new Vec2D(4.81,17.71),new Vec2D(3.27,16.16),new Vec2D(2.75,13.91),new Vec2D(2.98,11.92)],id2:[new Vec2D(7.18,13.37),new Vec2D(8.38,12.76),new Vec2D(8.69,12.45),new Vec2D(8.67,12.4)],id3:[new Vec2D(3.11,27.3),new Vec2D(-.87,24.71),new Vec2D(-4.29,19.86),new Vec2D(-5.3,14.32)]},ftilt:{id0:[new Vec2D(8.54,4.11),new Vec2D(16.17,9.33),new Vec2D(18.1,13.45),new Vec2D(14.84,18.26)],id1:[new Vec2D(9.39,8.39),new Vec2D(11.99,12.21),new Vec2D(13.09,
11.9),new Vec2D(12.1,13.63)],id2:[new Vec2D(4.58,12.75),new Vec2D(5.7,11.87),new Vec2D(7.1,10.66),new Vec2D(8.58,9.6)],id3:[new Vec2D(4.12,1.46),new Vec2D(18.41,4.48),new Vec2D(23.49,13.65),new Vec2D(18.61,22.11)]},dashattack:{id0:[new Vec2D(11.03,3.26),new Vec2D(15.21,6.22),new Vec2D(15.05,7.87),new Vec2D(13.97,12.26)],id1:[new Vec2D(9.54,5.43),new Vec2D(10.63,7.23),new Vec2D(10.13,8.36),new Vec2D(9.47,10.73)],id2:[new Vec2D(5.49,9.14),new Vec2D(6.38,7.95),new Vec2D(7.27,7.04),new Vec2D(7.26,6.89)],
id3:[new Vec2D(6.48,1.06),new Vec2D(19.59,2.77),new Vec2D(21.26,6.96),new Vec2D(20.08,13.48)]},jab1:{id0:[new Vec2D(13.68,7.34),new Vec2D(16.64,10.96),new Vec2D(15.79,15.1),new Vec2D(12.7,18.69)],id1:[new Vec2D(10.22,9.87),new Vec2D(12.21,11.53),new Vec2D(11.63,13.74),new Vec2D(10.03,15.89)],id2:[new Vec2D(5.18,12.23),new Vec2D(5.58,12.1),new Vec2D(5.96,12.11),new Vec2D(6.75,12.65)],id3:[new Vec2D(16.45,1.88),new Vec2D(22.52,8.98),new Vec2D(21.85,16.4),new Vec2D(18.57,20.4)]},jab2:{id0:[new Vec2D(16.61,
8.05),new Vec2D(16.65,13.43),new Vec2D(13.12,17.59),new Vec2D(7.91,18.53),new Vec2D(3.47,16.83)],id1:[new Vec2D(12.87,10.31),new Vec2D(12.38,13.23),new Vec2D(10.27,15.37),new Vec2D(7.7,15.82),new Vec2D(5.58,15.06)],id2:[new Vec2D(7.04,13.09),new Vec2D(6.3,13.75),new Vec2D(5.2,13.28),new Vec2D(5.26,12.96),new Vec2D(5.59,13.11)],id3:[new Vec2D(19.38,3.39),new Vec2D(22.57,12.52),new Vec2D(17.07,19.43),new Vec2D(9.85,21.01),new Vec2D(4.67,18.33)]},sidespecial:{id0:[new Vec2D(11.97,19.81),new Vec2D(18.79,
12.44),new Vec2D(16.47,5)],id1:[new Vec2D(9.62,25.13),new Vec2D(23.82,15.4),new Vec2D(21.42,1.9)],id2:[new Vec2D(11.6,14.07),new Vec2D(13.01,11.51),new Vec2D(12.41,9.36)],id3:[new Vec2D(5.43,14.48),new Vec2D(7.02,14.17),new Vec2D(9.5,11.87)]},fsmash:{id0:[new Vec2D(14.73,20.43),new Vec2D(23.35,12.45),new Vec2D(18.63,.49),new Vec2D(18.83,.19)],id1:[new Vec2D(14.85,15.44),new Vec2D(18.3,10.69),new Vec2D(15.87,4.03),new Vec2D(15.37,3.52)],id2:[new Vec2D(9.32,8.08),new Vec2D(10.74,6.82),new Vec2D(12.01,
5.69),new Vec2D(12.01,5.08)],id3:[new Vec2D(10.98,24.89),new Vec2D(28.11,15.83),new Vec2D(24.45,.79),new Vec2D(24.65,.33)]},upsmash:{id0:[new Vec2D(6.29,7.64),new Vec2D(6.29,7.64),new Vec2D(6.29,7.64),new Vec2D(6.29,7.64)],id1:[new Vec2D(-6.29,7.64),new Vec2D(-6.29,7.64),new Vec2D(-6.29,7.64),new Vec2D(-6.29,7.64)],id2:[new Vec2D(.91,21.71),new Vec2D(.82,21.13),new Vec2D(.78,20.56),new Vec2D(.78,20.87)],id3:[new Vec2D(.19,26.06),new Vec2D(.03,25.46),new Vec2D(-.04,24.89),new Vec2D(-.03,25.2)]},dsmash1:{id0:[new Vec2D(13.69,
4.12),new Vec2D(19.33,5.53),new Vec2D(15.33,6.2)],id1:[new Vec2D(12.67,7.34),new Vec2D(14.83,8.08),new Vec2D(12.92,8.48)],id2:[new Vec2D(6.48,6.94),new Vec2D(7.05,6.49),new Vec2D(6.79,6.43)],id3:[new Vec2D(11.96,2.87),new Vec2D(24.08,3.3),new Vec2D(19.09,3.9)]},dsmash2:{id0:[new Vec2D(-9.69,3.24),new Vec2D(-12.61,2.91),new Vec2D(-10.56,3.43)],id1:[new Vec2D(-6.68,4.54),new Vec2D(-8.18,4.3),new Vec2D(-7.89,4.3)],id2:[new Vec2D(-.35,5.31),new Vec2D(-.65,5.17),new Vec2D(-.63,5.09)],id3:[new Vec2D(-10.28,
2.16),new Vec2D(-17.91,2.01),new Vec2D(-14.94,2.54)]},grab:{id0:[new Vec2D(14.82,9.43),new Vec2D(14.82,9.43)],id1:[new Vec2D(11.23,8.98),new Vec2D(11.23,8.98)],id2:[new Vec2D(8.09,8.53),new Vec2D(8.09,8.53)]},downattack1:{id0:[new Vec2D(-11.59,7.12),new Vec2D(-11.57,7.18),new Vec2D(-11.59,7.2),new Vec2D(-11.61,7.26)],id1:[new Vec2D(-7.46,8.54),new Vec2D(-7.43,8.59),new Vec2D(-7.43,8.56),new Vec2D(-7.43,8.57)],id2:[new Vec2D(-3.85,11.23),new Vec2D(-3.84,11.27),new Vec2D(-3.84,11.21),new Vec2D(-3.83,
11.17)],id3:[new Vec2D(-17.85,7.02),new Vec2D(-17.84,7.07),new Vec2D(-17.86,7.15),new Vec2D(-17.89,7.3)]},downattack2:{id0:[new Vec2D(17.65,9.84),new Vec2D(18.77,10.73)],id1:[new Vec2D(13.16,10.31),new Vec2D(14.52,10.42)],id2:[new Vec2D(6.59,11.2),new Vec2D(8.36,10.74)],id3:[new Vec2D(23.38,8.95),new Vec2D(25.05,10.63)]},pummel:{id0:[new Vec2D(8.87,10.75)]},thrown:{id0:[new Vec2D(0,12)]}};for(var l=0;20>l;l++)offsets.thrown.id0.push(new Vec2D(0,12));
function charAttributes(a,b,d,e,f,h,q,n,m,g){this.dFrameMin=a;this.dFrameMax=b;this.dInitV=d;this.dMaxV=e;this.dAccA=f;this.dAccB=h;this.dTInitV=q;this.traction=n;this.maxWalk=m;this.jumpSquat=g;this.sHopInitV=1.5;this.fHopInitV=2.4;this.gravity=.085;this.groundToAir=.8;this.jumpHmaxV=1.2;this.jumpHinitV=1;this.terminalV=2.2;this.airMobA=.03;this.airMobB=.02;this.aerialHmaxV=.9;this.airFriction=.005;this.fastFallV=2.5;this.walkInitV=.15;this.walkAcc=0;this.walkMaxV=1.6;this.djMultiplier=.88;this.shieldScale=
11.75;this.modelScale=1.15;this.weight=87}
function charObject(a){this.attributes=a;this.animations=0;this.hitboxes={fair:new hitboxObject(new hitbox(offsets.fair.id0,3.906,10,361,70,30,0,1,0),new hitbox(offsets.fair.id1,3.906,9,361,70,20,0,1,0),new hitbox(offsets.fair.id2,3.906,9,361,70,20,0,1,0),new hitbox(offsets.fair.id3,3.906,13,67,70,42,0,1,0)),bair:new hitboxObject(new hitbox(offsets.bair.id0,3.906,10,361,70,30,0,1,0),new hitbox(offsets.bair.id1,3.906,9,361,70,25,0,1,0),new hitbox(offsets.bair.id2,3.906,9,361,70,10,0,1,0),new hitbox(offsets.bair.id3,
3.906,13,361,70,30,0,1,0)),nair1:new hitboxObject(new hitbox(offsets.nair1.id0,3.906,4,100,40,30,0,1,0),new hitbox(offsets.nair1.id1,3.906,4,100,40,30,0,1,0),new hitbox(offsets.nair1.id2,3.906,4,100,40,30,0,1,0),new hitbox(offsets.nair1.id3,3.906,4,90,40,30,0,0,0)),nair2:new hitboxObject(new hitbox(offsets.nair2.id0,3.906,10,361,80,50,0,1,0),new hitbox(offsets.nair2.id1,3.906,10,361,80,50,0,1,0),new hitbox(offsets.nair2.id2,3.906,10,361,80,50,0,1,0),new hitbox(offsets.nair2.id3,3.906,10,361,80,50,
0,0,0)),dair:new hitboxObject(new hitbox(offsets.dair.id0,3.515,13,290,70,40,0,1,0),new hitbox(offsets.dair.id1,3.515,10,80,70,40,0,1,0),new hitbox(offsets.dair.id2,3.515,9,361,70,30,0,1,0),new hitbox(offsets.dair.id3,3.515,9,361,70,20,0,1,0)),upair:new hitboxObject(new hitbox(offsets.upair.id0,3.906,13,90,70,40,0,1,0),new hitbox(offsets.upair.id1,3.906,10,80,70,30,0,1,0),new hitbox(offsets.upair.id2,3.906,9,80,70,20,0,1,0),new hitbox(offsets.upair.id3,3.906,9,80,70,18,0,1,0)),upb1:new hitboxObject(new hitbox(offsets.upb1.id0,
3.906,13,361,70,80,0,1,2),new hitbox(offsets.upb1.id1,3.906,10,74,70,60,0,1,2),new hitbox(offsets.upb1.id2,3.906,10,74,70,60,0,1,2)),upb2:new hitboxObject(new hitbox(offsets.upb2.id0,3.906,7,361,90,20,0,1,0),new hitbox(offsets.upb2.id1,3.906,7,74,90,20,0,1,0),new hitbox(offsets.upb2.id2,3.125,6,74,90,20,0,0,0)),dtilt:new hitboxObject(new hitbox(offsets.dtilt.id0,3.906,9,30,40,30,0,1,1),new hitbox(offsets.dtilt.id1,2.734,8,30,40,25,0,1,1),new hitbox(offsets.dtilt.id2,3.047,8,30,40,20,0,1,1),new hitbox(offsets.dtilt.id3,
3.906,10,30,40,50,0,1,1)),uptilt1:new hitboxObject(new hitbox(offsets.uptilt1.id0,3.906,9,110,120,40,0,1,1),new hitbox(offsets.uptilt1.id1,3.125,9,361,118,40,0,1,1),new hitbox(offsets.uptilt1.id2,3.047,8,361,116,40,0,1,1),new hitbox(offsets.uptilt1.id3,3.906,12,110,100,50,0,1)),uptilt2:new hitboxObject(new hitbox(offsets.uptilt2.id0,3.906,10,85,120,40,0,1,1),new hitbox(offsets.uptilt2.id1,2.734,9,361,118,30,0,1,1),new hitbox(offsets.uptilt2.id2,2.265,9,361,116,30,0,1,1),new hitbox(offsets.uptilt2.id3,
3.906,13,85,100,50,0,1,1)),ftilt:new hitboxObject(new hitbox(offsets.ftilt.id0,3.906,9,361,70,30,0,1,1),new hitbox(offsets.ftilt.id1,2.734,9,361,70,30,0,1,1),new hitbox(offsets.ftilt.id2,3.047,9,361,70,30,0,1,1),new hitbox(offsets.ftilt.id3,3.906,13,361,70,60,0,1,1)),dashattack:new hitboxObject(new hitbox(offsets.dashattack.id0,3.906,11,110,55,70,0,1,1),new hitbox(offsets.dashattack.id1,3.125,9,361,60,35,0,0,1),new hitbox(offsets.dashattack.id2,2.344,9,361,60,35,0,0,1),new hitbox(offsets.dashattack.id3,
3.906,12,110,55,70,0,1,1)),jab1:new hitboxObject(new hitbox(offsets.jab1.id0,3.906,4,361,50,20,0,1,1),new hitbox(offsets.jab1.id1,3.125,4,361,50,20,0,1,1),new hitbox(offsets.jab1.id2,2.344,4,361,50,20,0,1,1),new hitbox(offsets.jab1.id3,3.906,6,361,60,30,0,1,1)),jab2:new hitboxObject(new hitbox(offsets.jab2.id0,3.906,4,361,50,20,0,1,1),new hitbox(offsets.jab2.id1,3.125,4,361,50,20,0,1,1),new hitbox(offsets.jab2.id2,2.344,4,361,50,20,0,1,1),new hitbox(offsets.jab2.id3,3.906,6,361,60,30,0,1,1)),sidespecial:new hitboxObject(new hitbox(offsets.sidespecial.id0,
3.906,4,85,25,55,0,1,0),new hitbox(offsets.sidespecial.id1,3.125,4,96,25,55,0,1,0),new hitbox(offsets.sidespecial.id2,3.125,4,80,25,55,0,1,0),new hitbox(offsets.sidespecial.id3,2.344,4,76,25,55,0,1,0)),fsmash:new hitboxObject(new hitbox(offsets.fsmash.id0,3.906,14,361,70,60,0,1,1),new hitbox(offsets.fsmash.id1,3.125,14,361,70,60,0,1,1),new hitbox(offsets.fsmash.id2,3.515,14,361,70,60,0,1,1),new hitbox(offsets.fsmash.id3,3.906,20,361,70,80,0,1,1)),upsmash:new hitboxObject(new hitbox(offsets.upsmash.id0,
4.297,8,70,100,100,0,0,1),new hitbox(offsets.upsmash.id1,4.297,8,70,100,100,0,0,1),new hitbox(offsets.upsmash.id2,4.687,15,90,80,30,0,1,1),new hitbox(offsets.upsmash.id3,4.297,18,90,80,60,0,1,1)),dsmash1:new hitboxObject(new hitbox(offsets.dsmash1.id0,4.297,11,75,72,70,0,1,1),new hitbox(offsets.dsmash1.id1,3.125,11,361,100,20,0,1,1),new hitbox(offsets.dsmash1.id2,3.515,11,361,100,16,0,1,1),new hitbox(offsets.dsmash1.id3,3.906,16,70,100,70,0,1,1)),dsmash2:new hitboxObject(new hitbox(offsets.dsmash2.id0,
3.906,11,75,72,70,0,1,1),new hitbox(offsets.dsmash2.id1,3.125,11,361,100,30,0,1,1),new hitbox(offsets.dsmash2.id2,3.515,11,361,100,15,0,1,1),new hitbox(offsets.dsmash2.id3,3.906,16,75,100,70,0,1,1)),grab:new hitboxObject(new hitbox(offsets.grab.id0,3.906,0,361,100,0,0,2,3),new hitbox(offsets.grab.id1,3.906,0,361,100,0,0,2,3),new hitbox(offsets.grab.id2,3.906,0,361,100,0,0,2,3)),downattack1:new hitboxObject(new hitbox(offsets.downattack1.id0,5.468,6,361,50,80,0,1,1),new hitbox(offsets.downattack1.id1,
3.906,6,361,50,80,0,1,1),new hitbox(offsets.downattack1.id2,3.906,6,361,50,80,0,1,1),new hitbox(offsets.downattack1.id3,4.687,6,361,50,80,0,1,1)),downattack2:new hitboxObject(new hitbox(offsets.downattack2.id0,5.468,6,361,50,80,0,1,1),new hitbox(offsets.downattack2.id1,3.906,6,361,50,80,0,1,1),new hitbox(offsets.downattack2.id2,3.906,6,361,50,80,0,1,1),new hitbox(offsets.downattack2.id3,4.687,6,361,50,80,0,1,1)),pummel:new hitboxObject(new hitbox(offsets.pummel.id0,4.687,3,80,100,0,30,0,0)),throwup:new hitboxObject(new hitbox(new Vec2D(5.02334,
15.9095),0,4,93,130,60,0,0,0)),throwdown:new hitboxObject(new hitbox(new Vec2D(3.57509,0),0,5,135,50,65,0,0,0)),throwback:new hitboxObject(new hitbox(new Vec2D(-1.29306,0),0,4,117,60,70,0,0,0)),throwforward:new hitboxObject(new hitbox(new Vec2D(7.69851,0),0,4,50,45,70,0,0,0)),thrown:new hitboxObject(new hitbox(offsets.thrown.id0,3.906,4,361,50,20,0,1,0))}}function hitboxObject(a,b,d,e){this.id0=a;this.id1=b;this.id2=d;this.id3=e}
function hitbox(a,b,d,e,f,h,q,n,m){this.offset=a;this.size=b;this.dmg=d;this.angle=e;this.kg=f;this.bk=h;this.sk=q;this.type=n;this.clank=m}function actionState(a,b,d){this.totalFrames=a;this.timer=0;this.name=b;this.hb=d}chars={marth:new charObject(new charAttributes(15,27,1.56,1.8,.06,0,1.5,.06,1.6,4))};function ActiveHitbox(a,b,d,e,f,h,q,n){this.size=a;this.offset=b;this.dmg=d;this.angle=e;this.kg=f;this.bk=h;this.sk=q;this.type=n}
function hitboxes(){this.active=[!1,!1,!1,!1];this.frame=0;this.id0=new ActiveHitbox(0,new Vec2D(0,0),0,0,0,0,0,0);this.id1=new ActiveHitbox(0,new Vec2D(0,0),0,0,0,0,0,0);this.id2=new ActiveHitbox(0,new Vec2D(0,0),0,0,0,0,0,0);this.id3=new ActiveHitbox(0,new Vec2D(0,0),0,0,0,0,0,0);this.hitList=[]}
function physicsObject(a,b){this.cVel=new Vec2D(0,0);this.kVel=new Vec2D(0,0);this.kDec=new Vec2D(0,0);this.pos=new Vec2D(a[0],a[1]);this.posPrev=new Vec2D(0,0);this.posDelta=new Vec2D(0,0);this.grounded=!1;this.airborneTimer=0;this.fastfalled=!1;this.face=b;this.ECBp=[new Vec2D(0,0),new Vec2D(3,7),new Vec2D(0,14),new Vec2D(-3,7)];this.ECB1=[new Vec2D(0,0),new Vec2D(3,7),new Vec2D(0,14),new Vec2D(-3,7)];this.ECB2=[new Vec2D(0,0),new Vec2D(3,7),new Vec2D(0,14),new Vec2D(-3,7)];this.abovePlatforms=
[!1,!1,!1];this.onSurface=[0,0];this.doubleJumped=!1;this.shieldHP=60;this.shieldAnalog=this.shieldSize=0;this.shielding=!1;this.shieldPosition=new Vec2D(0,0);this.shieldPosition=new Vec2D(0,0);this.shieldPositionReal=new Vec2D(0,0);this.shieldPositionReal=new Vec2D(0,0);this.shieldStun=0;this.powerShielded=this.powerShieldActive=!1;this.onLedge=-1;this.ledgeSnapBoxF=new Box2D([0,5],[8,10]);this.ledgeSnapBoxB=new Box2D([0,5],[-8,10]);this.ledgeRegrabTimeout=0;this.ledgeRegrabCount=!1;this.hurtbox=
new Box2D([-4,18],[4,0]);this.invincibleTimer=this.intangibleTimer=this.hurtBoxState=0;this.lCancel=!1;this.lCancelTimer=0;this.autoCancel=!1;this.landingLagScaling=1;this.jabCombo=this.passFastfall=!1;this.sideBJumpFlag=!0;this.charging=!1;this.techTimer=this.stuckTimer=this.chargeFrames=0;this.grabbing=this.grabbedBy=-1;this.dashbuffer=!1;this.jumpType=0;this.wallJumpTimer=254;this.canWallJump=!1;this.upbAngleMultiplier=0;this.thrownHitbox=!1;this.thrownHitboxOwner=-1;this.landingMultiplier=3;this.wallJumpCount=
0}
function inputObject(){this.lStickAxis=[new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0)];this.cStickAxis=[new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0),new Vec2D(0,0)];this.lAnalog=[0,0,0,0,0,0,0,0];this.rAnalog=[0,0,0,0,0,0,0,0];this.s=[!1,!1,!1,!1,!1,!1,!1,!1];this.z=[!1,!1,!1,!1,!1,!1,!1,!1];this.a=[!1,!1,!1,!1,!1,!1,!1,!1];this.b=[!1,!1,!1,!1,!1,!1,!1,!1];this.x=[!1,
!1,!1,!1,!1,!1,!1,!1];this.y=[!1,!1,!1,!1,!1,!1,!1,!1];this.r=[!1,!1,!1,!1,!1,!1,!1,!1];this.l=[!1,!1,!1,!1,!1,!1,!1,!1];this.dpadleft=[!1,!1,!1,!1,!1,!1,!1];this.dpaddown=[!1,!1,!1,!1,!1,!1,!1];this.dpadright=[!1,!1,!1,!1,!1,!1,!1];this.dpadup=[!1,!1,!1,!1,!1,!1,!1]}
function playerObject(a,b,d){this.phys=new physicsObject(b,d);this.actionState=94;this.timer=0;this.inputs=new inputObject;this.charAttributes=chars[a].attributes;this.charHitboxes=chars[a].hitboxes;this.showHitbox=this.showECB=this.showLedgeGrabBox=!1;this.spawnWaitTime=0;this.hitboxes=new hitboxes;this.hit={knockback:0,hitlag:0,hitstun:0,angle:0,hitPoint:new Vec2D(0,0),powershield:!1,shieldstun:0};this.percent=0;this.stocks=4;this.miniView=!1;this.miniViewPoint=new Vec2D(0,0);this.inCSS=!0;this.furaLoopID=
0;this.percentShake=new Vec2D(0,0)}function convertATname(a){switch(a){case 0:return"Wait";case 1:return"Dash";case 2:return"Run";case 3:return"SmashTurn";case 4:return"TiltTurn";case 5:return"RunBrake";case 6:return"RunTurnaround";case 7:return"JumpSquat";case 8:return"Jump";case 9:return"DoubleJump";case 10:return"Fall";case 11:return"Landing";case 12:return"Jab";case 13:return"Usmash";case 14:return"Dsmash";case 15:return"Fsmash"}}
function randomShout(){playSfx("shout"+Math.round(.5+5.99*Math.random()))}function isFinalDeath(){if(5==gameMode)return!0;if(versusMode)return!1;for(var a=0,b=0,d=0;4>d;d++)-1<playerType[d]&&(b++,0==player[d].stocks&&a++);return a>=b-1}function getAngle(a,b){var d=0;if(0!=a||0!=b)d=Math.atan2(b,a);return d}function turnOffHitboxes(a){player[a].hitboxes.active=[!1,!1,!1,!1];player[a].hitboxes.hitList=[]}
function shieldTilt(a,b){if(!b&&!player[a].inCSS){var d=player[a].inputs.lStickAxis[0].x,e=player[a].inputs.lStickAxis[0].y,f=3*Math.sqrt(d*d+e*e),d=getAngle(d,e);targetPosition=new Vec2D(Math.cos(d)*f,Math.sin(d)*f);player[a].phys.shieldPosition=new Vec2D(player[a].phys.shieldPosition.x+((targetPosition.x-player[a].phys.shieldPosition.x)/5+.01),player[a].phys.shieldPosition.y+((targetPosition.y-player[a].phys.shieldPosition.y)/5+.01))}player[a].phys.shieldPositionReal=new Vec2D(player[a].phys.pos.x+
player[a].phys.shieldPosition.x+5*player[a].phys.face/4.5,player[a].phys.pos.y+player[a].phys.shieldPosition.y+40/4.5)}
function reduceByTraction(a,b){0<player[a].phys.cVel.x?(player[a].phys.cVel.x=b&&player[a].phys.cVel.x>player[a].charAttributes.maxWalk?player[a].phys.cVel.x-2*player[a].charAttributes.traction:player[a].phys.cVel.x-player[a].charAttributes.traction,0>player[a].phys.cVel.x&&(player[a].phys.cVel.x=0)):(player[a].phys.cVel.x=b&&player[a].phys.cVel.x<-player[a].charAttributes.maxWalk?player[a].phys.cVel.x+2*player[a].charAttributes.traction:player[a].phys.cVel.x+player[a].charAttributes.traction,0<player[a].phys.cVel.x&&
(player[a].phys.cVel.x=0))}
function airDrift(a){var b=.3>Math.abs(player[a].inputs.lStickAxis[0].x)?0:player[a].charAttributes.aerialHmaxV*player[a].inputs.lStickAxis[0].x;0>b&&player[a].phys.cVel.x<b||0<b&&player[a].phys.cVel.x>b?0<player[a].phys.cVel.x?(player[a].phys.cVel.x-=player[a].charAttributes.airFriction,0>player[a].phys.cVel.x&&(player[a].phys.cVel.x=0)):(player[a].phys.cVel.x+=player[a].charAttributes.airFriction,0<player[a].phys.cVel.x&&(player[a].phys.cVel.x=0)):.3<Math.abs(player[a].inputs.lStickAxis[0].x)&&(0>
b&&player[a].phys.cVel.x>b||0<b&&player[a].phys.cVel.x<b)&&(player[a].phys.cVel.x+=player[a].charAttributes.airMobA*player[a].inputs.lStickAxis[0].x+Math.sign(player[a].inputs.lStickAxis[0].x)*player[a].charAttributes.airMobB);.3>Math.abs(player[a].inputs.lStickAxis[0].x)&&(0<player[a].phys.cVel.x?(player[a].phys.cVel.x-=player[a].charAttributes.airFriction,0>player[a].phys.cVel.x&&(player[a].phys.cVel.x=0)):(player[a].phys.cVel.x+=player[a].charAttributes.airFriction,0<player[a].phys.cVel.x&&(player[a].phys.cVel.x=
0)))}function fastfall(a){player[a].phys.fastfalled||(player[a].phys.cVel.y-=player[a].charAttributes.gravity,player[a].phys.cVel.y<-player[a].charAttributes.terminalV&&(player[a].phys.cVel.y=-player[a].charAttributes.terminalV),-.65>player[a].inputs.lStickAxis[0].y&&-.1<player[a].inputs.lStickAxis[3].y&&0>player[a].phys.cVel.y&&(playSfx("fastfall"),player[a].phys.fastfalled=!0,player[a].phys.cVel.y=-player[a].charAttributes.fastFallV))}
function shieldDepletion(a){var b=Math.max(player[a].inputs.lAnalog[0],player[a].inputs.rAnalog[0]);player[a].phys.shieldHP-=.28*b-(1-b)/10;0>=player[a].phys.shieldHP&&(player[a].phys.shielding=!1,player[a].phys.cVel.y=2.5,player[a].phys.grounded=!1,player[a].phys.shieldHP=0,drawVfx("breakShield",player[a].phys.pos,player[a].phys.face),playSfx("shieldbreak"),aS[69].init(a))}
function shieldSize(a,b){player[a].phys.shieldAnalog=Math.max(player[a].inputs.lAnalog[0],player[a].inputs.rAnalog[0]);b&&0==player[a].phys.shieldAnalog&&(player[a].phys.shieldAnalog=1);player[a].phys.shieldSize=player[a].phys.shieldHP/60*player[a].charAttributes.shieldScale*player[a].charAttributes.modelScale*.575+.6*(1-player[a].phys.shieldAnalog)*player[a].charAttributes.shieldScale+(60-player[a].phys.shieldHP)/60*2}
function mashOut(a){return player[a].inputs.a[0]&&!player[a].inputs.a[1]?!0:player[a].inputs.b[0]&&!player[a].inputs.b[1]?!0:player[a].inputs.x[0]&&!player[a].inputs.x[1]?!0:player[a].inputs.y[0]&&!player[a].inputs.y[1]?!0:.8<player[a].inputs.lStickAxis[0].x&&.7>!player[a].inputs.lStickAxis[1].x?!0:-.8>player[a].inputs.lStickAxis[0].x&&-.7>!player[a].inputs.lStickAxis[1].x?!0:.8<player[a].inputs.lStickAxis[0].y&&.7>!player[a].inputs.lStickAxis[1].y?!0:-.8>player[a].inputs.lStickAxis[0].y&&-.7< !player[a].inputs.lStickAxis[1].y?
!0:.8<player[a].inputs.cStickAxis[0].x&&.7>!player[a].inputs.cStickAxis[1].x?!0:-.8>player[a].inputs.cStickAxis[0].x&&-.7>!player[a].inputs.cStickAxis[1].x?!0:.8<player[a].inputs.cStickAxis[0].y&&.7>!player[a].inputs.cStickAxis[1].y?!0:-.8>player[a].inputs.cStickAxis[0].y&&-.7< !player[a].inputs.cStickAxis[1].y?!0:!1}
function checkForSmashes(a){return player[a].inputs.a[0]&&!player[a].inputs.a[1]?.79<=Math.abs(player[a].inputs.lStickAxis[0].x)&&.3>player[a].inputs.lStickAxis[2].x*Math.sign(player[a].inputs.lStickAxis[0].x)?(player[a].phys.face=Math.sign(player[a].inputs.lStickAxis[0].x),[!0,57]):.66<=player[a].inputs.lStickAxis[0].y&&.3>player[a].inputs.lStickAxis[2].y?[!0,58]:-.66>=player[a].inputs.lStickAxis[0].y&&-.3<player[a].inputs.lStickAxis[2].y?[!0,59]:[!1,!1]:.79<=Math.abs(player[a].inputs.cStickAxis[0].x)&&
.79>Math.abs(player[a].inputs.cStickAxis[1].x)?(player[a].phys.face=Math.sign(player[a].inputs.cStickAxis[0].x),[!0,57]):.66<=player[a].inputs.cStickAxis[0].y&&.66>player[a].inputs.cStickAxis[1].y?[!0,58]:-.66>=player[a].inputs.cStickAxis[0].y&&-.66<player[a].inputs.cStickAxis[1].y?[!0,59]:[!1,!1]}
function checkForTilts(a,b){return player[a].inputs.a[0]&&!player[a].inputs.a[1]?.3<player[a].inputs.lStickAxis[0].x*player[a].phys.face*(b||1)&&-.05<Math.abs(player[a].inputs.lStickAxis[0].x)-Math.abs(player[a].inputs.lStickAxis[0].y)?[!0,49]:-.3>player[a].inputs.lStickAxis[0].y?[!0,47]:.3<player[a].inputs.lStickAxis[0].y?[!0,48]:[!0,50]:[!1,!1]}
function checkForSpecials(a){if(player[a].inputs.b[0]&&!player[a].inputs.b[1]){if(player[a].phys.grounded)return.58<Math.abs(player[a].inputs.lStickAxis[0].x)||.58<player[a].inputs.lStickAxis[0].y&&Math.abs(player[a].inputs.lStickAxis[0].x)>player[a].inputs.lStickAxis[0].y-.2?(player[a].phys.face=Math.sign(player[a].inputs.lStickAxis[0].x),[!0,56]):.58<player[a].inputs.lStickAxis[0].y?[!0,38]:[!1,!1];if(.58<player[a].inputs.lStickAxis[0].y||.58<Math.abs(player[a].inputs.lStickAxis[0].x)&&player[a].inputs.lStickAxis[0].y>
Math.abs(player[a].inputs.lStickAxis[0].x)-.2)return[!0,38];if(.58<Math.abs(player[a].inputs.lStickAxis[0].x))return player[a].phys.face=Math.sign(player[a].inputs.lStickAxis[0].x),[!0,56]}return[!1,!1]}
function checkForAerials(a){return.3<=player[a].inputs.cStickAxis[0].x*player[a].phys.face&&.3>player[a].inputs.cStickAxis[1].x*player[a].phys.face&&Math.abs(player[a].inputs.cStickAxis[0].x)>Math.abs(player[a].inputs.cStickAxis[0].y)-.1?[!0,33]:-.3>=player[a].inputs.cStickAxis[0].x*player[a].phys.face&&-.3<player[a].inputs.cStickAxis[1].x*player[a].phys.face&&Math.abs(player[a].inputs.cStickAxis[0].x)>Math.abs(player[a].inputs.cStickAxis[0].y)-.1?[!0,34]:.3<=player[a].inputs.cStickAxis[0].y&&.3>
player[a].inputs.cStickAxis[1].y?[!0,35]:-.3>player[a].inputs.cStickAxis[0].y&&-.3<player[a].inputs.cStickAxis[1].y?[!0,36]:player[a].inputs.a[0]&&!player[a].inputs.a[1]||player[a].inputs.z[0]&&!player[a].inputs.z[1]?.3<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&Math.abs(player[a].inputs.lStickAxis[0].x)>Math.abs(player[a].inputs.lStickAxis[0].y)-.1?[!0,33]:-.3>player[a].inputs.lStickAxis[0].x*player[a].phys.face&&Math.abs(player[a].inputs.lStickAxis[0].x)>Math.abs(player[a].inputs.lStickAxis[0].y)-
.1?[!0,34]:.3<player[a].inputs.lStickAxis[0].y?[!0,35]:-.3>player[a].inputs.lStickAxis[0].y?[!0,36]:[!0,37]:[!1,0]}function checkForDash(a){return.79<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&.3>player[a].inputs.lStickAxis[2].x*player[a].phys.face?!0:!1}function checkForSmashTurn(a){return-.79>player[a].inputs.lStickAxis[0].x*player[a].phys.face&&-.3<player[a].inputs.lStickAxis[2].x*player[a].phys.face?!0:!1}
function tiltTurnDashBuffer(a){return-.3<player[a].inputs.lStickAxis[1].x*player[a].phys.face?!0:!1}function checkForTiltTurn(a){return-.3>player[a].inputs.lStickAxis[0].x*player[a].phys.face?!0:!1}function checkForJump(a){return player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]?!0:.66<player[a].inputs.lStickAxis[0].y&&.2>player[a].inputs.lStickAxis[3].y?!0:!1}function checkForSquat(a){return-.69>player[a].inputs.lStickAxis[0].y?!0:!1}
aS=[{name:"WAIT",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=0;player[a].timer=1;aS[0].main(a)},main:function(a){player[a].timer+=.5;aS[0].interrupt(a)||(reduceByTraction(a,!1),45<=player[a].timer&&aS[0].init(a))},interrupt:function(a){if(player[a].inCSS)var b=[!1,!1],d=[!1,!1];else b=checkForSpecials(a),d=checkForTilts(a);var e=checkForSmashes(a);if(checkForJump(a)&&!player[a].inCSS)return aS[8].init(a),!0;if(player[a].inputs.l[0]||player[a].inputs.r[0])return aS[21].init(a),
!0;if(0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0])aS[21].init(a);else return b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),!0):d[0]?(aS[d[1]].init(a),!0):checkForSquat(a)&&!player[a].inCSS?(aS[16].init(a),!0):checkForDash(a)&&!player[a].inCSS?(aS[1].init(a),!0):checkForSmashTurn(a)&&!player[a].inCSS?(aS[3].init(a),!0):checkForTiltTurn(a)&&!player[a].inCSS?(player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0):.3<Math.abs(player[a].inputs.lStickAxis[0].x)&&!player[a].inCSS?
(aS[7].init(a,!0),!0):!1}},{name:"DASH",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=1;player[a].timer=0;playSfx("dash");aS[1].main(a)},main:function(a){player[a].timer++;if(!aS[1].interrupt(a)&&(2==player[a].timer&&(player[a].phys.cVel.x+=player[a].charAttributes.dInitV*player[a].phys.face,Math.abs(player[a].phys.cVel.x)>player[a].charAttributes.dMaxV&&(player[a].phys.cVel.x=player[a].charAttributes.dMaxV*player[a].phys.face)),4==player[a].timer&&drawVfx("dashDust",player[a].phys.pos,
player[a].phys.face),1<player[a].timer))if(.3>Math.abs(player[a].inputs.lStickAxis[0].x))reduceByTraction(a,!1);else{var b=player[a].inputs.lStickAxis[0].x*player[a].charAttributes.dMaxV,d=player[a].inputs.lStickAxis[0].x*player[a].charAttributes.dAccA;player[a].phys.cVel.x+=d;if(0<b&&player[a].phys.cVel.x>b||0>b&&player[a].phys.cVel.x<b){if(reduceByTraction(a,!1),0<b&&player[a].phys.cVel.x<b||0>b&&player[a].phys.cVel.x>b)player[a].phys.cVel.x=b}else if(player[a].phys.cVel.x+=d,0<b&&player[a].phys.cVel.x>
b||0>b&&player[a].phys.cVel.x<b)player[a].phys.cVel.x=b}},interrupt:function(a){return player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(player[a].phys.cVel.x*=.25,aS[21].init(a),!0):player[a].inputs.a[0]&&!player[a].inputs.a[1]?(4>player[a].timer&&.8<=player[a].inputs.lStickAxis[0].x*player[a].phys.face?(player[a].phys.cVel.x*=.25,aS[57].init(a)):0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?aS[73].init(a):aS[55].init(a),!0):
checkForJump(a)?(aS[8].init(a),!0):player[a].inputs.b[0]&&!player[a].inputs.b[1]&&.6<Math.abs(player[a].inputs.lStickAxis[0].x)?(player[a].phys.face=Math.sign(player[a].inputs.lStickAxis[0].x),aS[56].init(a),!0):4<player[a].timer&&checkForSmashTurn(a)?(player[a].phys.cVel.x*=.25,aS[3].init(a),!0):20<player[a].timer&&.79<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&.3>player[a].inputs.lStickAxis[2].x*player[a].phys.face?(aS[1].init(a),!0):player[a].timer>player[a].charAttributes.dFrameMin&&
.62<player[a].inputs.lStickAxis[0].x*player[a].phys.face?(aS[2].init(a),!0):player[a].timer>player[a].charAttributes.dFrameMax?(aS[0].init(a),!0):!1}},{name:"RUN",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=2;player[a].timer=1;aS[2].main(a)},main:function(a){16<player[a].timer&&(player[a].timer=1);if(!aS[2].interrupt(a)){var b=[!1,!1];2>player[a].timer&&(b[0]=!0);10>player[a].timer&&(b[1]=!0);var d=player[a].inputs.lStickAxis[0].x*player[a].charAttributes.dMaxV;player[a].phys.cVel.x+=
1/(2.5*player[a].charAttributes.dMaxV)*(player[a].charAttributes.dMaxV*player[a].inputs.lStickAxis[0].x-player[a].phys.cVel.x)*(player[a].charAttributes.dAccA+player[a].charAttributes.dAccB/Math.sign(player[a].inputs.lStickAxis[0].x));player[a].phys.cVel.x*player[a].phys.face>d*player[a].phys.face&&(player[a].phys.cVel.x=d);d=player[a].phys.cVel.x*player[a].phys.face/player[a].charAttributes.dMaxV;0<d&&(player[a].timer+=d);(b[0]&&2<=player[a].timer||b[1]&&10<=player[a].timer)&&playSfx("footstep")}},
interrupt:function(a){if(player[a].inputs.a[0]&&!player[a].inputs.a[1])return 0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?aS[73].init(a):aS[55].init(a),!0;if(checkForJump(a))return aS[8].init(a),!0;if(player[a].inputs.b[0]&&!player[a].inputs.b[1]&&.6<Math.abs(player[a].inputs.lStickAxis[0].x))return player[a].phys.face=Math.sign(player[a].inputs.lStickAxis[0].x),aS[56].init(a),!0;if(player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0])return aS[21].init(a),
!0;if(.62>Math.abs(player[a].inputs.lStickAxis[0].x))return aS[5].init(a),!0;if(-.3>player[a].inputs.lStickAxis[0].x*player[a].phys.face)return aS[6].init(a),!0}},{name:"SMASHTURN",canEdgeCancel:!0,reverseModel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=3;player[a].timer=0;player[a].phys.face*=-1;aS[3].main(a)},main:function(a){player[a].timer++;aS[3].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){var b=checkForTilts(a),d=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),
!0;if(player[a].inputs.b[0]&&!player[a].inputs.b[1]&&.6<Math.abs(player[a].inputs.lStickAxis[0].x))return player[a].phys.face=Math.sign(player[a].inputs.lStickAxis[0].x),aS[56].init(a),!0;if(player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0])return aS[21].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(b[0])aS[b[1]].init(a);else return 2==player[a].timer&&.79<player[a].inputs.lStickAxis[0].x*player[a].phys.face?(aS[1].init(a),!0):11<player[a].timer?
(aS[0].init(a),!0):!1}},{name:"TILTTURN",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=4;player[a].timer=0;aS[4].main(a)},main:function(a){player[a].timer++;6==player[a].timer&&(player[a].phys.face*=-1);aS[4].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){var b=6>player[a].timer?checkForTilts(a,-1):checkForTilts(a),d=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(player[a].inputs.b[0]&&!player[a].inputs.b[1]&&.6<Math.abs(player[a].inputs.lStickAxis[0].x))return player[a].phys.face=
Math.sign(player[a].inputs.lStickAxis[0].x),aS[56].init(a),!0;if(player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0])return aS[21].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(b[0])6>player[a].timer&&(player[a].phys.face*=-1),aS[b[1]].init(a);else return 11<player[a].timer?(aS[0].init(a),!0):6==player[a].timer&&.79<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&player[a].phys.dashbuffer?(aS[1].init(a),!0):!1}},{name:"RUNBRAKE",canEdgeCancel:!0,
canBeGrabbed:!0,init:function(a){player[a].actionState=5;player[a].timer=0;playSfx("runbrake");aS[5].main(a)},main:function(a){player[a].timer++;aS[5].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return checkForJump(a)?(aS[8].init(a),!0):1<player[a].timer&&checkForSquat(a)?(aS[16].init(a),!0):-.3>player[a].inputs.lStickAxis[0].x*player[a].phys.face?(aS[6].init(a),!0):25<player[a].timer?(aS[0].init(a),!0):!1}},{name:"RUNTURN",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
6;player[a].timer=0;aS[6].main(a)},main:function(a){player[a].timer++;if(!aS[6].interrupt(a)){19==player[a].timer&&(player[a].phys.face*=-1);if(19>player[a].timer&&-.3>player[a].inputs.lStickAxis[0].x*player[a].phys.face){var b=(player[a].charAttributes.dAccA-(1-Math.abs(player[a].inputs.lStickAxis[0].x))*player[a].charAttributes.dAccA)*player[a].phys.face;player[a].phys.cVel.x-=b}else 18<player[a].timer&&.3<player[a].inputs.lStickAxis[0].x*player[a].phys.face?(b=(player[a].charAttributes.dAccA-(1-
Math.abs(player[a].inputs.lStickAxis[0].x))*player[a].charAttributes.dAccA)*player[a].phys.face,player[a].phys.cVel.x+=b):reduceByTraction(a,!0);18==player[a].timer&&0<player[a].phys.cVel.x*player[a].phys.face&&player[a].timer--}},interrupt:function(a){return checkForJump(a)?(aS[8].init(a),!0):30<player[a].timer?(.6<player[a].inputs.lStickAxis[0].x*player[a].phys.face?aS[2].init(a):aS[0].init(a),!0):!1}},{name:"WALK",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a,b){player[a].actionState=7;player[a].timer=
1;if(b){var d=player[a].charAttributes.walkInitV*player[a].phys.face;if(0<d&&player[a].phys.cVel.x<d||0>d&&player[a].phys.cVel.x>d)player[a].phys.cVel.x+=player[a].charAttributes.walkInitV*player[a].phys.face}aS[7].main(a)},main:function(a){if(!aS[7].interrupt(a)){var b=[!1,!1];5>player[a].timer&&(b[0]=!0);15>player[a].timer&&(b[1]=!0);var d=player[a].charAttributes.walkMaxV*player[a].inputs.lStickAxis[0].x;Math.abs(player[a].phys.cVel.x)>Math.abs(d)?reduceByTraction(a,!0):(player[a].phys.cVel.x+=
1/(2*player[a].charAttributes.walkMaxV)*(d-player[a].phys.cVel.x)*(player[a].charAttributes.walkInitV+player[a].charAttributes.walkAcc),player[a].phys.cVel.x*player[a].phys.face>d*player[a].phys.face&&(player[a].phys.cVel.x=d));d=player[a].phys.cVel.x*player[a].phys.face/player[a].charAttributes.walkMaxV;0<d&&(player[a].timer+=d);(b[0]&&5<=player[a].timer||b[1]&&15<=player[a].timer)&&playSfx("footstep")}},interrupt:function(a){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);return 18<
player[a].timer?(aS[7].init(a,!1),!0):0==player[a].inputs.lStickAxis[0].x?(aS[0].init(a),!0):checkForJump(a)?(aS[8].init(a),!0):player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(aS[21].init(a),!0):b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),!0):d[0]?(aS[d[1]].init(a),!0):checkForSquat(a)?(aS[16].init(a),!0):checkForDash(a)?(aS[1].init(a),!0):checkForSmashTurn(a)?(aS[3].init(a),!0):checkForTiltTurn(a)?(player[a].phys.dashbuffer=tiltTurnDashBuffer(a),
aS[4].init(a),!0):!1}},{name:"KNEEBEND",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=8;player[a].timer=0;player[a].phys.jumpType=1;aS[8].main(a)},main:function(a){player[a].timer++;aS[8].interrupt(a)||(reduceByTraction(a,!0),!player[a].inputs.x[0]&&!player[a].inputs.y[0]&&.67>player[a].inputs.lStickAxis[0].y&&(player[a].phys.jumpType=0))},interrupt:function(a){var b=checkForSpecials(a);player[a].timer==player[a].charAttributes.jumpSquat&&(player[a].phys.pos.y+=.001);return player[a].timer>
player[a].charAttributes.jumpSquat?(-.3<=player[a].inputs.lStickAxis[2].x*player[a].phys.face?aS[9].init(a,player[a].phys.jumpType):aS[15].init(a,player[a].phys.jumpType),!0):player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0])?(aS[73].init(a),!0):player[a].inputs.a[0]&&!player[a].inputs.a[1]&&.8<=player[a].inputs.lStickAxis[0].y&&.3>player[a].inputs.lStickAxis[3].y||.8<=player[a].inputs.cStickAxis[0].y&&.3>player[a].inputs.cStickAxis[3].y?
(aS[58].init(a),!0):b[0]?(aS[b[1]].init(a),!0):!1}},{name:"JUMPF",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!0,canBeGrabbed:!0,init:function(a,b){player[a].actionState=9;player[a].timer=0;player[a].phys.cVel.y=b?player[a].phys.cVel.y+player[a].charAttributes.fHopInitV:player[a].phys.cVel.y+player[a].charAttributes.sHopInitV;player[a].phys.cVel.x=player[a].phys.cVel.x*player[a].charAttributes.groundToAir+player[a].inputs.lStickAxis[0].x*player[a].charAttributes.jumpHmaxV;Math.abs(player[a].phys.cVel.x)>
player[a].charAttributes.jumpHmaxV&&(player[a].phys.cVel.x=player[a].charAttributes.jumpHmaxV*Math.sign(player[a].phys.cVel.x));player[a].phys.grounded=!1;playSfx("jump");playSfx("jump2");aS[9].main(a)},main:function(a){player[a].timer++;!aS[9].interrupt(a)&&1<player[a].timer&&(fastfall(a),airDrift(a))},interrupt:function(a){var b=checkForAerials(a),d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?
(aS[11].init(a),!0):(player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped?(aS[19].init(a),!0):d[0]?(aS[d[1]].init(a),!0):45<player[a].timer?(aS[13].init(a),!0):!1}},{name:"LANDING",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=10;player[a].timer=0;drawVfx("impactLand",player[a].phys.pos,player[a].phys.face);drawVfx("circleDust",
player[a].phys.pos,player[a].phys.face);playSfx("land");aS[10].main(a)},main:function(a){player[a].timer++;aS[10].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){if(4<player[a].timer&&30>=player[a].timer){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);return checkForJump(a)?(aS[8].init(a),!0):player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(aS[21].init(a),!0):b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),
!0):d[0]?(aS[d[1]].init(a),!0):checkForDash(a)?(aS[1].init(a),!0):checkForSmashTurn(a)?(aS[3].init(a),!0):checkForTiltTurn(a)?(player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0):.3<Math.abs(player[a].inputs.lStickAxis[0].x)?(aS[7].init(a,!0),!0):5==player[a].timer&&-.5>player[a].inputs.lStickAxis[0].y?(aS[17].init(a),!0):!1}return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"ESCAPEAIR",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
11;player[a].timer=0;if(0<Math.abs(player[a].inputs.lStickAxis[0].x)||0<Math.abs(player[a].inputs.lStickAxis[0].y)){var b=getAngle(player[a].inputs.lStickAxis[0].x,player[a].inputs.lStickAxis[0].y);player[a].phys.cVel.x=3.1*Math.cos(b);player[a].phys.cVel.y=3.1*Math.sin(b)}else player[a].phys.cVel.x=0,player[a].phys.cVel.y=0;player[a].phys.fastfalled=!1;player[a].phys.landingMultiplier=3;aS[11].main(a)},main:function(a){player[a].timer++;aS[11].interrupt(a)||(30>player[a].timer?(player[a].phys.cVel.x*=
.9,player[a].phys.cVel.y*=.9):(airDrift(a),fastfall(a)),4==player[a].timer&&(player[a].phys.intangibleTimer=25,playSfx("airdodge")))},interrupt:function(a){return 49<player[a].timer?(aS[14].init(a),!0):!1}},{name:"LANDINGFALLSPECIAL",canEdgeCancel:!0,canGrabLedge:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=12;player[a].timer=0;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);playSfx("land");aS[12].main(a)},main:function(a){player[a].timer+=player[a].phys.landingMultiplier;
aS[12].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"FALL",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=13;player[a].timer=0;turnOffHitboxes(a);aS[13].main(a)},main:function(a){player[a].timer++;aS[13].interrupt(a)||(fastfall(a),airDrift(a))},interrupt:function(a){var b=checkForAerials(a),d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&
!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?(aS[11].init(a),!0):(player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped?(aS[19].init(a),!0):d[0]?(aS[d[1]].init(a),!0):10<player[a].timer?(aS[13].init(a),!0):!1}},{name:"FALLSPECIAL",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
14;player[a].timer=0;aS[14].main(a)},main:function(a){player[a].timer++;aS[14].interrupt(a)||(fastfall(a),airDrift(a))},interrupt:function(a){return 10<player[a].timer?(aS[14].init(a),!0):!1}},{name:"JUMPB",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!0,canBeGrabbed:!0,init:function(a,b){player[a].actionState=15;player[a].timer=0;player[a].phys.cVel.y=b?player[a].phys.cVel.y+player[a].charAttributes.fHopInitV:player[a].phys.cVel.y+player[a].charAttributes.sHopInitV;player[a].phys.cVel.x=
player[a].phys.cVel.x*player[a].charAttributes.groundToAir+player[a].inputs.lStickAxis[0].x*player[a].charAttributes.jumpHmaxV;Math.abs(player[a].phys.cVel.x)>player[a].charAttributes.jumpHmaxV&&(player[a].phys.cVel.x=player[a].charAttributes.jumpHmaxV*Math.sign(player[a].phys.cVel.x));player[a].phys.grounded=!1;playSfx("jump");playSfx("jump2");aS[15].main(a)},main:function(a){player[a].timer++;!aS[15].interrupt(a)&&1<player[a].timer&&(fastfall(a),airDrift(a))},interrupt:function(a){var b=checkForAerials(a),
d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?(aS[11].init(a),!0):(player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped?(aS[19].init(a),!0):d[0]?(aS[d[1]].init(a),!0):55<player[a].timer?(aS[13].init(a),!0):!1}},{name:"SQUAT",canEdgeCancel:!0,canBeGrabbed:!0,
init:function(a){player[a].actionState=16;player[a].timer=0;aS[16].main(a)},main:function(a){player[a].timer++;aS[16].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);return 4==player[a].timer&&(-.65>player[a].inputs.lStickAxis[0].y||-.65>player[a].inputs.lStickAxis[1].y||-.65>player[a].inputs.lStickAxis[2].y)&&-.3<player[a].inputs.lStickAxis[6].y&&1==player[a].phys.onSurface[0]?(aS[20].init(a),!0):player[a].inputs.l[0]||
player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(aS[21].init(a),!0):b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),!0):d[0]?(aS[d[1]].init(a),!0):7<player[a].timer?(aS[17].init(a),!0):checkForJump(a)?(aS[8].init(a),!0):!1}},{name:"SQUATWAIT",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=17;player[a].timer=0;aS[17].main(a)},main:function(a){player[a].timer++;aS[17].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){var b=checkForSpecials(a),
d=checkForTilts(a),e=checkForSmashes(a);return-.61<player[a].inputs.lStickAxis[0].y?(aS[18].init(a),!0):checkForJump(a)?(aS[8].init(a),!0):player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(aS[21].init(a),!0):b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),!0):d[0]?(aS[d[1]].init(a),!0):checkForDash(a)?(aS[1].init(a),!0):checkForSmashTurn(a)?(aS[3].init(a),!0):!1}},{name:"SQUATRV",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=
18;player[a].timer=0;aS[18].main(a)},main:function(a){player[a].timer++;aS[18].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);return 8<player[a].timer?(aS[0].init(a),!0):checkForJump(a)?(aS[8].init(a),!0):player[a].inputs.l[0]||player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(aS[21].init(a),!0):b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),!0):d[0]?(aS[d[1]].init(a),!0):checkForSmashTurn(a)?
(aS[3].init(a),!0):.3<Math.abs(player[a].inputs.lStickAxis[0].x)?(aS[7].init(a,!0),!0):!1}},{name:"JUMPAERIALF",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=19;player[a].timer=0;player[a].phys.fastfalled=!1;player[a].phys.doubleJumped=!0;player[a].phys.cVel.y=player[a].charAttributes.fHopInitV*player[a].charAttributes.djMultiplier;player[a].phys.cVel.x=1*player[a].inputs.lStickAxis[0].x;drawVfx("doubleJumpRings",player[a].phys.pos,
player[a].phys.face);playSfx("jump2");aS[19].main(a)},main:function(a){player[a].timer++;aS[19].interrupt(a)||(fastfall(a),airDrift(a))},interrupt:function(a){var b=checkForAerials(a),d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?(aS[11].init(a),!0):d[0]?(aS[d[1]].init(a),!0):50<player[a].timer?(aS[32].init(a),!0):!1}},{name:"PASS",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!0,
canBeGrabbed:!0,init:function(a){player[a].actionState=20;player[a].timer=0;player[a].phys.grounded=!1;player[a].phys.passFastfall=!1;player[a].phys.abovePlatforms[player[a].phys.onSurface[1]]=!1;player[a].phys.cVel.y=-.5;aS[20].main(a)},main:function(a){player[a].timer++;1<player[a].timer&&!aS[20].interrupt(a)&&(player[a].phys.passFastfall?fastfall(a):(player[a].phys.cVel.y-=player[a].charAttributes.gravity,player[a].phys.cVel.y<-player[a].charAttributes.terminalV&&(player[a].phys.cVel.y=-player[a].charAttributes.terminalV),
-.3<player[a].inputs.lStickAxis[0].y&&(player[a].phys.passFastfall=!0)),airDrift(a))},interrupt:function(a){var b=checkForAerials(a),d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?(aS[11].init(a),!0):(player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped?
(aS[19].init(a),!0):d[0]?(aS[d[1]].init(a),!0):30<player[a].timer?(aS[13].init(a),!0):!1}},{name:"GUARDON",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=21;player[a].timer=0;player[a].phys.shielding=!0;player[a].phys.shieldPosition=new Vec2D(0,0);player[a].phys.powerShielded=!1;shieldSize(a,!0);player[a].phys.powerShieldActive=1==Math.max(player[a].inputs.lAnalog[0],player[a].inputs.rAnalog[0])?!0:!1;aS[21].main(a)},main:function(a){0<player[a].hit.shieldstun?(reduceByTraction(a,
!1),shieldTilt(a,!0)):(player[a].timer++,2==player[a].timer&&1==Math.max(player[a].inputs.lAnalog[0],player[a].inputs.rAnalog[0])&&(player[a].phys.powerShieldActive=!0),aS[21].interrupt(a)||(1==player[a].timer&&(playSfx("shieldup"),playSfx("swordsheath")),player[a].inCSS||(reduceByTraction(a,!1),shieldDepletion(a)),shieldTilt(a,!1),shieldSize(a)))},interrupt:function(a){return player[a].inCSS?8<player[a].timer?(aS[22].init(a),!0):!1:checkForJump(a)||.65<player[a].inputs.cStickAxis[0].y?(player[a].phys.shielding=
!1,aS[8].init(a),!0):player[a].inputs.a[0]&&!player[a].inputs.a[1]?(player[a].phys.shielding=!1,aS[73].init(a),!0):-.7>player[a].inputs.lStickAxis[0].y&&-.3<player[a].inputs.lStickAxis[4].y||-.7>player[a].inputs.cStickAxis[0].y?(player[a].phys.shielding=!1,aS[54].init(a),!0):.7<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&.3>player[a].inputs.lStickAxis[4].x*player[a].phys.face||.7<player[a].inputs.cStickAxis[0].x*player[a].phys.face?(player[a].phys.shielding=!1,aS[53].init(a),!0):-.7>player[a].inputs.lStickAxis[0].x*
player[a].phys.face&&-.3<player[a].inputs.lStickAxis[4].x*player[a].phys.face||-.7>player[a].inputs.cStickAxis[0].x*player[a].phys.face?(player[a].phys.shielding=!1,aS[52].init(a),!0):1<player[a].timer&&-.65>player[a].inputs.lStickAxis[0].y&&-.3<player[a].inputs.lStickAxis[6].y&&1==player[a].phys.onSurface[0]?(player[a].phys.shielding=!1,aS[20].init(a),!0):8<player[a].timer?(aS[22].init(a),!0):!1}},{name:"GUARD",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=22;player[a].timer=
0;player[a].phys.powerShieldActive=!1;aS[22].main(a)},main:function(a){0<player[a].hit.shieldstun?(reduceByTraction(a,!1),shieldTilt(a,!0)):(player[a].timer++,aS[22].interrupt(a)||(player[a].inCSS||(reduceByTraction(a,!1),shieldDepletion(a)),shieldTilt(a,!1),shieldSize(a)))},interrupt:function(a){return player[a].inCSS?.3>player[a].inputs.lAnalog[0]&&.3>player[a].inputs.rAnalog[0]?(player[a].phys.shielding=!1,aS[23].init(a),!0):1<player[a].timer?(aS[22].init(a),!0):!1:checkForJump(a)||.66<player[a].inputs.cStickAxis[0].y?
(player[a].phys.shielding=!1,aS[8].init(a),!0):player[a].inputs.a[0]&&!player[a].inputs.a[1]?(player[a].phys.shielding=!1,aS[73].init(a),!0):-.7>player[a].inputs.lStickAxis[0].y&&-.3<player[a].inputs.lStickAxis[4].y||-.7>player[a].inputs.cStickAxis[0].y?(player[a].phys.shielding=!1,aS[54].init(a),!0):.7<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&.3>player[a].inputs.lStickAxis[4].x*player[a].phys.face||.7<player[a].inputs.cStickAxis[0].x*player[a].phys.face?(player[a].phys.shielding=!1,
aS[53].init(a),!0):-.7>player[a].inputs.lStickAxis[0].x*player[a].phys.face&&-.3<player[a].inputs.lStickAxis[4].x*player[a].phys.face||-.7>player[a].inputs.cStickAxis[0].x*player[a].phys.face?(player[a].phys.shielding=!1,aS[52].init(a),!0):-.65>player[a].inputs.lStickAxis[0].y&&-.3<player[a].inputs.lStickAxis[6].y&&1==player[a].phys.onSurface[0]?(player[a].phys.shielding=!1,aS[20].init(a),!0):.3>player[a].inputs.lAnalog[0]&&.3>player[a].inputs.rAnalog[0]?(player[a].phys.shielding=!1,aS[23].init(a),
!0):1<player[a].timer?(aS[22].init(a),!0):!1}},{name:"GUARDOFF",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=23;player[a].timer=0;playSfx("shieldoff");aS[23].main(a)},main:function(a){player[a].timer++;aS[23].interrupt(a)||(6==player[a].timer&&playSfx("sworddraw"),reduceByTraction(a,!1))},interrupt:function(a){if(checkForJump(a)&&!player[a].inCSS)return aS[8].init(a),!0;if(16<player[a].timer)return aS[0].init(a),!0;if(player[a].phys.powerShielded){if(player[a].inCSS)return d=
checkForSmashes(a),d[0]?(aS[d[1]].init(a),!0):!1;var b=checkForTilts(a),d=checkForSmashes(a);if(d[0])return aS[d[1]].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(checkForSquat(a))return aS[16].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"CLIFFCATCH",canGrabLedge:!1,
canBeGrabbed:!1,init:function(a){player[a].actionState=24;player[a].timer=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.kVel.x=0;player[a].phys.kVel.y=0;player[a].phys.fastfalled=!1;player[a].phys.doubleJumped=!1;player[a].phys.intangibleTimer=38;player[a].phys.ledgeHangTimer=0;drawVfx("cliffcatchspark",new Vec2D(stage.ledge[player[a].phys.onLedge][1]?stage.box[stage.ledge[player[a].phys.onLedge][0]].max.x:stage.box[stage.ledge[player[a].phys.onLedge][0]].min.x,stage.box[stage.ledge[player[a].phys.onLedge][0]].max.y),
player[a].phys.face);playSfx("ledgegrab");aS[24].main(a)},main:function(a){player[a].timer++;aS[24].interrupt(a)||(player[a].phys.pos=new Vec2D((stage.ledge[player[a].phys.onLedge][1]?stage.box[stage.ledge[player[a].phys.onLedge][0]].max.x:stage.box[stage.ledge[player[a].phys.onLedge][0]].min.x)+cliffcatchOffset[player[a].timer-1][0]*player[a].phys.face,stage.box[stage.ledge[player[a].phys.onLedge][0]].max.y+cliffcatchOffset[player[a].timer-1][1]))},interrupt:function(a){return 7<player[a].timer?
(aS[25].init(a),!0):!1}},{name:"CLIFFWAIT",canGrabLedge:!1,canBeGrabbed:!1,init:function(a){player[a].actionState=25;player[a].timer=0;aS[25].main(a)},main:function(a){player[a].timer++;aS[25].interrupt(a)||player[a].phys.ledgeHangTimer++},interrupt:function(a){return-.5>player[a].inputs.lStickAxis[0].x*player[a].phys.face||-.5>player[a].inputs.lStickAxis[0].y?(player[a].phys.onLedge=-1,player[a].phys.ledgeRegrabCount=!0,aS[13].init(a),!0):.5<player[a].inputs.lStickAxis[0].x*player[a].phys.face||
.5<player[a].inputs.lStickAxis[0].y?(aS[95].init(a),!0):600<player[a].phys.ledgeHangTimer?(player[a].phys.onLedge=-1,player[a].phys.ledgeRegrabCount=!0,aS[40].init(a),!0):60<player[a].timer?(aS[25].init(a),!0):!1}},{name:"DEADLEFT",canBeGrabbed:!1,init:function(a){player[a].actionState=26;player[a].timer=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.kVel.x=0;player[a].phys.kVel.y=0;player[a].percent=0;drawVfx("blastzoneExplosion",player[a].phys.pos,90);isFinalDeath()||(screenShake(500),
percentShake(500,a));playSfx("kill");playSfx("deathShout");aS[26].main(a)},main:function(a){player[a].timer++;aS[26].interrupt(a)||4!=player[a].timer||(isFinalDeath()?finishGame():(screenShake(500),percentShake(500,a)))},interrupt:function(a){return 60<player[a].timer?(0<player[a].stocks?aS[30].init(a):aS[93].init(a),!0):!1}},{name:"DEADRIGHT",canBeGrabbed:!1,init:function(a){player[a].actionState=27;player[a].timer=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.kVel.x=0;player[a].phys.kVel.y=
0;player[a].percent=0;drawVfx("blastzoneExplosion",player[a].phys.pos,-90);isFinalDeath()||(screenShake(500),percentShake(500,a));playSfx("kill");playSfx("deathShout");aS[27].main(a)},main:function(a){player[a].timer++;aS[27].interrupt(a)||4!=player[a].timer||(isFinalDeath()?finishGame():(screenShake(500),percentShake(500,a)))},interrupt:function(a){return 60<player[a].timer?(0<player[a].stocks?aS[30].init(a):aS[93].init(a),!0):!1}},{name:"DEADUP",canBeGrabbed:!1,init:function(a){player[a].actionState=
28;player[a].timer=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.kVel.x=0;player[a].phys.kVel.y=0;player[a].percent=0;drawVfx("blastzoneExplosion",player[a].phys.pos,180);isFinalDeath()||(screenShake(500),percentShake(500,a));playSfx("kill");playSfx("deathShout");aS[28].main(a)},main:function(a){player[a].timer++;aS[28].interrupt(a)||4!=player[a].timer||(isFinalDeath()?finishGame():(screenShake(500),percentShake(500,a)))},interrupt:function(a){return 60<player[a].timer?(0<player[a].stocks?
aS[30].init(a):aS[93].init(a),!0):!1}},{name:"DEADDOWN",canBeGrabbed:!1,init:function(a){player[a].actionState=29;player[a].timer=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.kVel.x=0;player[a].phys.kVel.y=0;player[a].percent=0;drawVfx("blastzoneExplosion",player[a].phys.pos,0);isFinalDeath()||(screenShake(500),percentShake(500,a));playSfx("kill");playSfx("deathShout");aS[29].main(a)},main:function(a){player[a].timer++;aS[29].interrupt(a)||4!=player[a].timer||(isFinalDeath()?finishGame():
(screenShake(500),percentShake(500,a)))},interrupt:function(a){return 60<player[a].timer?(0<player[a].stocks?aS[30].init(a):aS[93].init(a),!0):!1}},{name:"REBIRTH",canBeGrabbed:!1,init:function(a){player[a].actionState=30;player[a].timer=1;player[a].phys.pos.x=stage.respawnPoints[a].x;player[a].phys.pos.y=stage.respawnPoints[a].y+135;player[a].phys.cVel.x=0;player[a].phys.cVel.y=-1.5;player[a].phys.face=stage.respawnFace[a];player[a].phys.doubleJumped=!1;player[a].phys.fastfalled=!1;player[a].phys.wallJumpCount=
0;player[a].phys.sideBJumpFlag=!0;player[a].spawnWaitTime=0;player[a].percent=0;player[a].phys.kVel.x=0;player[a].phys.kVel.y=0},main:function(a){player[a].timer+=.5;aS[30].interrupt(a)},interrupt:function(a){return 45<=player[a].timer?(aS[31].init(a),!0):!1}},{name:"REBIRTHWAIT",canBeGrabbed:!1,init:function(a){player[a].actionState=31;player[a].timer=1;player[a].phys.cVel.y=0},main:function(a){player[a].timer+=.5;player[a].spawnWaitTime++;aS[31].interrupt(a)},interrupt:function(a){return 45<=player[a].timer?
(aS[31].init(a),!0):300<player[a].spawnWaitTime||.3<Math.abs(player[a].inputs.lStickAxis[0].x)||.3<Math.abs(player[a].inputs.lStickAxis[0].y)?(player[a].phys.grounded=!1,player[a].phys.invincibleTimer=120,aS[13].init(a),!0):!1}},{name:"FALLAERIAL",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=32;player[a].timer=0;aS[32].main(a)},main:function(a){player[a].timer++;aS[32].interrupt(a)||(fastfall(a),airDrift(a))},interrupt:function(a){var b=
checkForAerials(a),d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?(aS[11].init(a),!0):(player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped?(aS[19].init(a),!0):d[0]?(aS[d[1]].init(a),!0):10<player[a].timer?(aS[32].init(a),!0):!1}},{name:"ATTACKAIRF",canPassThrough:!1,
canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=33;player[a].timer=0;player[a].phys.autoCancel=!1;player[a].inAerial=!0;player[a].hitboxes.id0=player[a].charHitboxes.fair.id0;player[a].hitboxes.id1=player[a].charHitboxes.fair.id1;player[a].hitboxes.id2=player[a].charHitboxes.fair.id2;player[a].hitboxes.id3=player[a].charHitboxes.fair.id3;turnOffHitboxes(a);aS[33].main(a)},main:function(a){player[a].timer++;aS[33].interrupt(a)||(fastfall(a),airDrift(a),
2<player[a].timer&&11>player[a].timer&&drawVfx("swingFair",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-3),4==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword3")),4<player[a].timer&&8>player[a].timer&&player[a].hitboxes.frame++,8==player[a].timer&&turnOffHitboxes(a),27==player[a].timer&&(player[a].phys.autoCancel=!0))},interrupt:function(a){if(33<player[a].timer)return aS[13].init(a),
!0;if(29<player[a].timer){var b=checkForAerials(a);if((player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped)return aS[19].init(a),!0;if(b[0])return aS[b[1]].init(a),!0}return!1}},{name:"ATTACKAIRB",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=34;player[a].timer=0;player[a].phys.autoCancel=
!1;player[a].inAerial=!0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.bair.id0;player[a].hitboxes.id1=player[a].charHitboxes.bair.id1;player[a].hitboxes.id2=player[a].charHitboxes.bair.id2;player[a].hitboxes.id3=player[a].charHitboxes.bair.id3;aS[34].main(a)},main:function(a){player[a].timer++;aS[34].interrupt(a)||(30==player[a].timer&&(player[a].phys.face*=-1),fastfall(a),airDrift(a),2<player[a].timer&&12>player[a].timer&&drawVfx("swingBair",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,
player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-3),7==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword3")),7<player[a].timer&&12>player[a].timer&&player[a].hitboxes.frame++,12==player[a].timer&&turnOffHitboxes(a),32==player[a].timer&&(player[a].phys.autoCancel=!0))},interrupt:function(a){if(39<player[a].timer)return aS[13].init(a),!0;if(34<player[a].timer){var b=checkForAerials(a);if((player[a].inputs.x[0]&&!player[a].inputs.x[1]||
player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped)return aS[19].init(a),!0;if(b[0])return aS[b[1]].init(a),!0}return!1}},{name:"ATTACKAIRU",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=35;player[a].timer=0;player[a].phys.autoCancel=!0;player[a].inAerial=!0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.upair.id0;
player[a].hitboxes.id1=player[a].charHitboxes.upair.id1;player[a].hitboxes.id2=player[a].charHitboxes.upair.id2;player[a].hitboxes.id3=player[a].charHitboxes.upair.id3;aS[35].main(a)},main:function(a){player[a].timer++;aS[35].interrupt(a)||(fastfall(a),airDrift(a),4<player[a].timer&&15>player[a].timer&&drawVfx("swingUpair",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-5),5==player[a].timer&&(player[a].hitboxes.active=
[!0,!0,!0,!0],player[a].hitboxes.frame=0,player[a].phys.autoCancel=!1,playSfx("sword3")),5<player[a].timer&&9>player[a].timer&&player[a].hitboxes.frame++,9==player[a].timer&&turnOffHitboxes(a),27==player[a].timer&&(player[a].phys.autoCancel=!0))},interrupt:function(a){return 45<player[a].timer?(aS[13].init(a),!0):!1}},{name:"ATTACKAIRD",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=36;player[a].timer=0;player[a].phys.autoCancel=
!0;player[a].inAerial=!0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.dair.id0;player[a].hitboxes.id1=player[a].charHitboxes.dair.id1;player[a].hitboxes.id2=player[a].charHitboxes.dair.id2;player[a].hitboxes.id3=player[a].charHitboxes.dair.id3;aS[36].main(a)},main:function(a){player[a].timer++;aS[36].interrupt(a)||(fastfall(a),airDrift(a),4<player[a].timer&&12>player[a].timer&&drawVfx("swingDair",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),
player[a].phys.face,player[a].timer-5),6==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,player[a].phys.autoCancel=!1,playSfx("sword3")),6<player[a].timer&&10>player[a].timer&&player[a].hitboxes.frame++,10==player[a].timer&&turnOffHitboxes(a),48==player[a].timer&&(player[a].phys.autoCancel=!0))},interrupt:function(a){return 59<player[a].timer?(aS[13].init(a),!0):!1}},{name:"ATTACKAIRN",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,
init:function(a){player[a].actionState=37;player[a].timer=0;player[a].phys.autoCancel=!0;player[a].inAerial=!0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.nair1.id0;player[a].hitboxes.id1=player[a].charHitboxes.nair1.id1;player[a].hitboxes.id2=player[a].charHitboxes.nair1.id2;player[a].hitboxes.id3=player[a].charHitboxes.nair1.id3;aS[37].main(a)},main:function(a){player[a].timer++;aS[37].interrupt(a)||(fastfall(a),airDrift(a),4<player[a].timer&&9>player[a].timer&&drawVfx("swingNair1",
new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-5),13<player[a].timer&&18>player[a].timer&&drawVfx("swingNair2",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-14),6==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,player[a].phys.autoCancel=!1,playSfx("sword1")),7==player[a].timer&&player[a].hitboxes.frame++,
8==player[a].timer&&turnOffHitboxes(a),15==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.id0=player[a].charHitboxes.nair2.id0,player[a].hitboxes.id1=player[a].charHitboxes.nair2.id1,player[a].hitboxes.id2=player[a].charHitboxes.nair2.id2,player[a].hitboxes.id3=player[a].charHitboxes.nair2.id3,player[a].hitboxes.frame=0,playSfx("sword2")),15<player[a].timer&&22>player[a].timer&&player[a].hitboxes.frame++,22==player[a].timer&&turnOffHitboxes(a),25==player[a].timer&&(player[a].phys.autoCancel=
!0))},interrupt:function(a){return 49<player[a].timer?(aS[13].init(a),!0):!1}},{name:"UPSPECIAL",canPassThrough:!0,canGrabLedge:[!0,!1],setVelocities:[[.75685,14.41555],[.7145,15.51062],[.67334,8.65633],[.63338,2.42162],[.59462,2.11897],[.55706,1.83569],[.52069,1.57181],[.48552,1.32731],[.45155,1.10218],[.41878,.89645],[.3872,.7101],[.35682,.54314],[.32765,.39556],[.29966,.26735],[.27288,.15855],[.24729,.06912],[.2229,-9.3E-4]],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
38;player[a].timer=0;player[a].phys.cVel=new Vec2D(0,0);player[a].phys.fastfalled=!1;player[a].phys.upbAngleMultiplier=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.upb1.id0;player[a].hitboxes.id1=player[a].charHitboxes.upb1.id1;player[a].hitboxes.id2=player[a].charHitboxes.upb1.id2;player[a].phys.landingMultiplier=30/34;playSfx("dolphinSlash");playSfx("dolphinSlash2");aS[38].main(a)},main:function(a){player[a].timer++;aS[38].interrupt(a)||(0>=player[a].phys.cVel.y&&(player[a].phys.canWallJump=
!0),6>player[a].timer&&.7<Math.abs(player[a].inputs.lStickAxis[0].x)&&(player[a].phys.upbAngleMultiplier=-player[a].inputs.lStickAxis[0].x*Math.PI/16),6==player[a].timer&&(player[a].phys.grounded=!1,-.7>player[a].inputs.lStickAxis[0].x*player[a].phys.face&&(player[a].phys.face*=-1)),5<player[a].timer&&23>player[a].timer?player[a].phys.cVel=new Vec2D(aS[38].setVelocities[player[a].timer-6][0]*player[a].phys.face*Math.cos(player[a].phys.upbAngleMultiplier)-aS[38].setVelocities[player[a].timer-6][1]*
Math.sin(player[a].phys.upbAngleMultiplier),aS[38].setVelocities[player[a].timer-6][0]*player[a].phys.face*Math.sin(player[a].phys.upbAngleMultiplier)+aS[38].setVelocities[player[a].timer-6][1]*Math.cos(player[a].phys.upbAngleMultiplier)):22<player[a].timer&&(fastfall(a),airDrift(a)),5==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!1],player[a].hitboxes.frame=0),6==player[a].timer&&(player[a].hitboxes.id0=player[a].charHitboxes.upb2.id0,player[a].hitboxes.id1=player[a].charHitboxes.upb2.id1,
player[a].hitboxes.id2=player[a].charHitboxes.upb2.id2),6<player[a].timer&&11>player[a].timer&&player[a].hitboxes.frame++,11==player[a].timer&&turnOffHitboxes(a),2<player[a].timer&&12>player[a].timer&&drawVfx("swingUpb",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-3))},interrupt:function(a){return 39<player[a].timer?(aS[14].init(a),!0):!1}},{name:"DAMAGEFLYN",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,
headBonk:!0,canBeGrabbed:!0,init:function(a,b){player[a].actionState=39;player[a].timer=0;player[a].phys.grabbing=-1;player[a].phys.grabbedBy=-1;b&&(drawVfx("hitSparks",player[a].hit.hitPoint,player[a].phys.face),drawVfx("hitFlair",player[a].hit.hitPoint,player[a].phys.face),drawVfx("hitCurve",player[a].hit.hitPoint,player[a].phys.face,player[a].hit.angle));player[a].hitboxes.id0=player[a].charHitboxes.thrown.id0;turnOffHitboxes(a);aS[39].main(a)},main:function(a){player[a].phys.thrownHitbox&&(1==
player[a].timer&&0<player[a].phys.cVel.y+player[a].phys.kVel.y&&(player[a].hitboxes.active=[!0,!1,!1,!1],player[a].hitboxes.frame=0),1<player[a].timer&&0<player[a].phys.cVel.y+player[a].phys.kVel.y&&player[a].hitboxes.frame++,0>=player[a].phys.cVel.y+player[a].phys.kVel.y&&turnOffHitboxes(a));29>player[a].timer&&player[a].timer++;0==player[a].hit.hitstun%10&&drawVfx("flyingDust",player[a].phys.pos);aS[39].interrupt(a)?player[a].phys.thrownHitbox=!1:1<player[a].timer&&(player[a].hit.hitstun--,player[a].phys.grounded||
(player[a].phys.cVel.y-=player[a].charAttributes.gravity,player[a].phys.cVel.y<-player[a].charAttributes.terminalV&&(player[a].phys.cVel.y=-player[a].charAttributes.terminalV)))},interrupt:function(a){return 1<player[a].timer&&0==player[a].hit.hitstun?(aS[40].init(a),!0):!1}},{name:"DAMAGEFALL",canPassThrough:!1,canGrabLedge:[!0,!1],wallJumpAble:!1,headBonk:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=40;player[a].timer=0;turnOffHitboxes(a);aS[40].main(a)},main:function(a){player[a].timer++;
aS[40].interrupt(a)||(fastfall(a),airDrift(a))},interrupt:function(a){var b=checkForAerials(a),d=checkForSpecials(a);return b[0]?(aS[b[1]].init(a),!0):player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1]?(aS[11].init(a),!0):(player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped?(aS[19].init(a),!0):d[0]?(aS[d[1]].init(a),
!0):.7<player[a].inputs.lStickAxis[0].x&&.7>player[a].inputs.lStickAxis[1].x||-.7>player[a].inputs.lStickAxis[0].x&&-.7<player[a].inputs.lStickAxis[1].x||.7<player[a].inputs.lStickAxis[0].y&&.7>player[a].inputs.lStickAxis[1].y||-.7>player[a].inputs.lStickAxis[0].y&&-.7<player[a].inputs.lStickAxis[1].y?(aS[13].init(a),!0):30<player[a].timer?(aS[40].init(a),!0):!1}},{name:"DAMAGEN2",canEdgeCancel:!0,canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
41;player[a].timer=0;player[a].phys.grabbing=-1;player[a].phys.grabbedBy=-1;turnOffHitboxes(a);drawVfx("hitSparks",player[a].hit.hitPoint,player[a].phys.face);drawVfx("hitFlair",player[a].hit.hitPoint,player[a].phys.face);drawVfx("hitCurve",player[a].hit.hitPoint,player[a].phys.face,player[a].hit.angle);aS[41].main(a)},main:function(a){player[a].inCSS?player[a].timer+=.7:player[a].timer++;!aS[41].interrupt(a)&&1<player[a].timer&&(player[a].hit.hitstun--,player[a].phys.grounded?reduceByTraction(a,
!1):(player[a].phys.cVel.y-=player[a].charAttributes.gravity,player[a].phys.cVel.y<-player[a].charAttributes.terminalV&&(player[a].phys.cVel.y=-player[a].charAttributes.terminalV)))},interrupt:function(a){if(23<player[a].timer)return player[a].phys.grounded||player[a].inCSS?aS[0].init(a):aS[13].init(a),!0;if(0>=player[a].hit.hitstun&&!player[a].inCSS){if(player[a].phys.grounded){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);return checkForJump(a)?(aS[8].init(a),!0):player[a].inputs.l[0]||
player[a].inputs.r[0]||0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0]?(aS[21].init(a),!0):b[0]?(aS[b[1]].init(a),!0):e[0]?(aS[e[1]].init(a),!0):d[0]?(aS[d[1]].init(a),!0):checkForSquat(a)?(aS[16].init(a),!0):checkForDash(a)?(aS[1].init(a),!0):checkForSmashTurn(a)?(aS[3].init(a),!0):checkForTiltTurn(a)?(player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0):.3<Math.abs(player[a].inputs.lStickAxis[0].x)?(aS[7].init(a,!0),!0):!1}d=checkForAerials(a);b=checkForSpecials(a);if(d[0])return aS[d[1]].init(a),
!0;if(player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1])return aS[11].init(a),!0;if((player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped)return aS[19].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(.7<player[a].inputs.lStickAxis[0].x&&.7>player[a].inputs.lStickAxis[1].x||-.7>player[a].inputs.lStickAxis[0].x&&
-.7<player[a].inputs.lStickAxis[1].x||.7<player[a].inputs.lStickAxis[0].y&&.7>player[a].inputs.lStickAxis[1].y||-.7>player[a].inputs.lStickAxis[0].y&&-.7<player[a].inputs.lStickAxis[1].y)return aS[13].init(a),!0;if(30<player[a].timer)return aS[40].init(a),!0}return!1}},{name:"LANDINGATTACKAIRN",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=42;player[a].timer=0;player[a].phys.landingLagScaling=player[a].phys.lCancel?2:1;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);
playSfx("land");aS[42].main(a)},main:function(a){player[a].timer+=2*player[a].phys.landingLagScaling;aS[42].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"LANDINGATTACKAIRF",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=43;player[a].timer=0;player[a].phys.landingLagScaling=player[a].phys.lCancel?2:1;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);playSfx("land");aS[43].main(a)},main:function(a){player[a].timer+=
2*player[a].phys.landingLagScaling;aS[43].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"LANDINGATTACKAIRB",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=44;player[a].timer=0;player[a].phys.landingLagScaling=player[a].phys.lCancel?2:1;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);playSfx("land");aS[44].main(a)},main:function(a){player[a].timer+=1.25*player[a].phys.landingLagScaling;aS[44].interrupt(a)||
reduceByTraction(a,!0)},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"LANDINGATTACKAIRD",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=45;player[a].timer=0;player[a].phys.landingLagScaling=player[a].phys.lCancel?2:1;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);playSfx("land");aS[45].main(a)},main:function(a){player[a].timer+=.9375*player[a].phys.landingLagScaling;aS[45].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 30<
player[a].timer?(aS[0].init(a),!0):!1}},{name:"LANDINGATTACKAIRU",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=46;player[a].timer=0;player[a].phys.landingLagScaling=player[a].phys.lCancel?2:1;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);playSfx("land");aS[46].main(a)},main:function(a){player[a].timer+=2*player[a].phys.landingLagScaling;aS[46].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"DOWNTILT",
canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=47;player[a].timer=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.dtilt.id0;player[a].hitboxes.id1=player[a].charHitboxes.dtilt.id1;player[a].hitboxes.id2=player[a].charHitboxes.dtilt.id2;player[a].hitboxes.id3=player[a].charHitboxes.dtilt.id3;aS[47].main(a)},main:function(a){player[a].timer++;aS[47].interrupt(a)||(reduceByTraction(a,!0),5<player[a].timer&&10>player[a].timer&&drawVfx("swingDtilt",new Vec2D(player[a].phys.pos.x+
player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-6),7==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword2")),7<player[a].timer&&10>player[a].timer&&player[a].hitboxes.frame++,10==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(49<player[a].timer)return aS[17].init(a),!0;if(19<player[a].timer){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),
!0;if(b[0])return aS[b[1]].init(a),!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(-.3>player[a].inputs.lStickAxis[0].x*player[a].phys.face&&Math.abs(player[a].inputs.lStickAxis[0].x)>-1*player[a].inputs.lStickAxis[0].y)return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&Math.abs(player[a].inputs.lStickAxis[0].x)>
-1*player[a].inputs.lStickAxis[0].y)return aS[7].init(a,!0),!0}return!1}},{name:"UPTILT",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=48;player[a].timer=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.uptilt1.id0;player[a].hitboxes.id1=player[a].charHitboxes.uptilt1.id1;player[a].hitboxes.id2=player[a].charHitboxes.uptilt1.id2;player[a].hitboxes.id3=player[a].charHitboxes.uptilt1.id3;aS[48].main(a)},main:function(a){player[a].timer++;aS[48].interrupt(a)||
(reduceByTraction(a,!0),4<player[a].timer&&15>player[a].timer&&drawVfx("swingUptilt",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-5),6==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword2")),6<player[a].timer&&13>player[a].timer&&player[a].hitboxes.frame++,9==player[a].timer&&(player[a].hitboxes.frame=0,player[a].hitboxes.id0=player[a].charHitboxes.uptilt2.id0,player[a].hitboxes.id1=
player[a].charHitboxes.uptilt2.id1,player[a].hitboxes.id2=player[a].charHitboxes.uptilt2.id2,player[a].hitboxes.id3=player[a].charHitboxes.uptilt2.id3),13==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(39<player[a].timer)return aS[0].init(a),!0;if(31<player[a].timer){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),
!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"FTILT",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=49;player[a].timer=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.ftilt.id0;player[a].hitboxes.id1=player[a].charHitboxes.ftilt.id1;player[a].hitboxes.id2=player[a].charHitboxes.ftilt.id2;
player[a].hitboxes.id3=player[a].charHitboxes.ftilt.id3;aS[49].main(a)},main:function(a){player[a].timer++;aS[49].interrupt(a)||(reduceByTraction(a,!0),5<player[a].timer&&14>player[a].timer&&drawVfx("swingFtilt",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-6),7==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword2")),7<player[a].timer&&11>player[a].timer&&player[a].hitboxes.frame++,
11==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){return 35<player[a].timer?(aS[0].init(a),!0):!1}},{name:"JAB1",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=50;player[a].timer=0;player[a].phys.jabCombo=!1;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.jab1.id0;player[a].hitboxes.id1=player[a].charHitboxes.jab1.id1;player[a].hitboxes.id2=player[a].charHitboxes.jab1.id2;player[a].hitboxes.id3=player[a].charHitboxes.jab1.id3;aS[50].main(a)},
main:function(a){player[a].timer++;aS[50].interrupt(a)||(reduceByTraction(a,!0),3<player[a].timer&&14>player[a].timer&&drawVfx("swingJab1",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-4),2<player[a].timer&&26>player[a].timer&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(player[a].phys.jabCombo=!0),4==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword1")),4<player[a].timer&&
8>player[a].timer&&player[a].hitboxes.frame++,8==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(19<player[a].timer&&player[a].phys.jabCombo)return aS[51].init(a),!0;if(27<player[a].timer)return aS[0].init(a),!0;if(26<player[a].timer){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),
!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"JAB2",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=51;player[a].timer=0;player[a].phys.jabCombo=!1;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.jab2.id0;player[a].hitboxes.id1=player[a].charHitboxes.jab2.id1;player[a].hitboxes.id2=
player[a].charHitboxes.jab2.id2;player[a].hitboxes.id3=player[a].charHitboxes.jab2.id3;aS[51].main(a)},main:function(a){player[a].timer++;aS[51].interrupt(a)||(reduceByTraction(a,!0),4<player[a].timer&&14>player[a].timer&&drawVfx("swingJab2",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-5),1<player[a].timer&&26>player[a].timer&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(player[a].phys.jabCombo=!0),5==player[a].timer&&
(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword1")),5<player[a].timer&&10>player[a].timer&&player[a].hitboxes.frame++,10==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(19<player[a].timer&&player[a].phys.jabCombo)return aS[50].init(a),!0;if(28<player[a].timer)return aS[0].init(a),!0;if(27<player[a].timer){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;
if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"ESCAPEB",setVelocities:[-2.267,-2.536,-2.706,-2.78,-2.758,-2.64,-2.426,-2.116,-1.711,-1.209,-.888,-.819,-.758,-.707,-.664,-.631,-.606,-.591,-.585,-.587,
-.599,-.62,-.809,-1.072,-1.205,-1.207,-1.078,-.819,-.617,-.556,-.487,-.413,-.332,-.245,-.152],canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=52;player[a].timer=0;player[a].phys.shielding=!1;aS[52].main(a)},main:function(a){player[a].timer++;aS[52].interrupt(a)||(33==player[a].timer&&playSfx("sworddraw"),player[a].phys.cVel.x=aS[52].setVelocities[player[a].timer-1]*player[a].phys.face,4==player[a].timer&&(player[a].phys.intangibleTimer=20,playSfx("roll")))},interrupt:function(a){return 35<
player[a].timer?(player[a].phys.cVel.x=0,aS[0].init(a),!0):!1}},{name:"ESCAPEF",setVelocities:[2.267,2.536,2.706,2.78,2.758,2.64,2.426,2.116,1.711,1.209,.888,.819,.758,.707,.664,.631,.606,.591,.585,.587,.599,.62,.809,1.072,1.205,1.207,1.078,.819,.617,.556,.487,.413,.332,.245,.152],canEdgeCancel:!1,reverseModel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=53;player[a].timer=0;player[a].phys.shielding=!1;aS[53].main(a)},main:function(a){player[a].timer++;aS[53].interrupt(a)||(33==player[a].timer&&
playSfx("sworddraw"),player[a].phys.cVel.x=aS[53].setVelocities[player[a].timer-1]*player[a].phys.face,4==player[a].timer&&(player[a].phys.intangibleTimer=20,playSfx("roll")))},interrupt:function(a){return 35<player[a].timer?(player[a].phys.cVel.x=0,player[a].phys.face*=-1,aS[0].init(a),!0):!1}},{name:"ESCAPEN",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=54;player[a].timer=0;player[a].phys.shielding=!1;drawVfx("circleDust",player[a].phys.pos,player[a].phys.face);aS[54].main(a)},
main:function(a){player[a].timer++;aS[54].interrupt(a)||(1==player[a].timer&&playSfx("spotdodge"),2==player[a].timer&&playSfx("airdodge"),18==player[a].timer&&playSfx("sworddraw"),reduceByTraction(a,!0),2==player[a].timer&&(player[a].phys.intangibleTimer=16))},interrupt:function(a){return 27<player[a].timer?(aS[0].init(a),!0):!1}},{name:"ATTACKDASH",canEdgeCancel:!1,setVelocities:[.755,1.962,2.714,3.01,2.849,2.232,1.184,.542,.704,1.325,1.487,1.079,.666,.631,.597,.565,.536,.508,.482,.458,.436,.416,
.398,.37,.332,.299,.27,.244,.222,.205,.191,.181,.176,.165,.148,.13,.112,.093,.073,.053,.032,.011,-.783,-.783,0,0,.001,.001,0],canBeGrabbed:!0,init:function(a){player[a].actionState=55;player[a].timer=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.dashattack.id0;player[a].hitboxes.id1=player[a].charHitboxes.dashattack.id1;player[a].hitboxes.id2=player[a].charHitboxes.dashattack.id2;player[a].hitboxes.id3=player[a].charHitboxes.dashattack.id3;aS[55].main(a)},main:function(a){player[a].timer++;
aS[55].interrupt(a)||(player[a].phys.cVel.x=aS[55].setVelocities[player[a].timer-1]*player[a].phys.face,12<player[a].timer&&21>player[a].timer&&drawVfx("swingDashAttack",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-13),12==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword1")),12<player[a].timer&&16>player[a].timer&&player[a].hitboxes.frame++,16==player[a].timer&&
turnOffHitboxes(a))},interrupt:function(a){if(49<player[a].timer)return aS[0].init(a),!0;if(5>player[a].timer&&0<player[a].inputs.lAnalog[0]||0<player[a].inputs.rAnalog[0])return player[a].phys.cVel.x*player[a].phys.face>player[a].charAttributes.dMaxV&&(player[a].phys.cVel.x=player[a].charAttributes.dMaxV*player[a].phys.face),aS[73].init(a),!0;if(39<player[a].timer){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),
!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"SIDESPECIAL",canPassThrough:!1,canEdgeCancel:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
56;player[a].timer=0;player[a].phys.grounded?player[a].phys.cVel.x*=.2:(player[a].phys.sideBJumpFlag?(player[a].phys.cVel.y=1,player[a].phys.sideBJumpFlag=!1):player[a].phys.cVel.y=0,player[a].phys.fastfalled=!1,player[a].phys.cVel.x*=.8);turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.sidespecial.id0;player[a].hitboxes.id1=player[a].charHitboxes.sidespecial.id1;player[a].hitboxes.id2=player[a].charHitboxes.sidespecial.id2;player[a].hitboxes.id3=player[a].charHitboxes.sidespecial.id3;
playSfx("shout6");aS[56].main(a)},main:function(a){player[a].timer++;aS[56].interrupt(a)||(6==player[a].timer&&playSfx("dancingBlade"),player[a].phys.grounded?reduceByTraction(a,!0):(player[a].phys.cVel.y-=.06,0<player[a].phys.cVel.x?(player[a].phys.cVel.x-=.0025,0>player[a].phys.cVel.x&&(player[a].phys.cVel.x=0)):(player[a].phys.cVel.x+=.0025,0<player[a].phys.cVel.x&&(player[a].phys.cVel.x=0))),4<player[a].timer&&12>player[a].timer&&drawVfx("swingSideB",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,
player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-5),6==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0),6<player[a].timer&&9>player[a].timer&&player[a].hitboxes.frame++,9==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){return 29<player[a].timer?(player[a].phys.grounded?aS[0].init(a):aS[13].init(a),!0):!1}},{name:"FSMASH",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=57;player[a].timer=0;player[a].phys.charging=
!1;player[a].phys.chargeFrames=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.fsmash.id0;player[a].hitboxes.id1=player[a].charHitboxes.fsmash.id1;player[a].hitboxes.id2=player[a].charHitboxes.fsmash.id2;player[a].hitboxes.id3=player[a].charHitboxes.fsmash.id3;aS[57].main(a)},main:function(a){3==player[a].timer?player[a].inputs.a[0]||player[a].inputs.z[0]?(player[a].phys.charging=!0,player[a].phys.chargeFrames++,5==player[a].phys.chargeFrames&&playSfx("smashcharge"),60==player[a].phys.chargeFrames&&
(player[a].timer++,player[a].phys.charging=!1)):(player[a].timer++,player[a].phys.charging=!1):(player[a].timer++,player[a].phys.charging=!1);aS[57].interrupt(a)||(reduceByTraction(a,!0),5==player[a].timer&&playSfx("sword3"),6<player[a].timer&&14>player[a].timer&&drawVfx("swingFsmash",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-7),10==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=
0,randomShout()),10<player[a].timer&&14>player[a].timer&&player[a].hitboxes.frame++,14==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(49<player[a].timer)return aS[0].init(a),!0;if(47<player[a].timer&&!player[a].inCSS){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),
!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"UPSMASH",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=58;player[a].timer=0;player[a].phys.charging=!1;player[a].phys.chargeFrames=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.upsmash.id0;player[a].hitboxes.id1=player[a].charHitboxes.upsmash.id1;player[a].hitboxes.id2=
player[a].charHitboxes.upsmash.id2;player[a].hitboxes.id3=player[a].charHitboxes.upsmash.id3;aS[58].main(a)},main:function(a){7==player[a].timer?player[a].inputs.a[0]||player[a].inputs.z[0]?(player[a].phys.charging=!0,player[a].phys.chargeFrames++,5==player[a].phys.chargeFrames&&playSfx("smashcharge"),60==player[a].phys.chargeFrames&&(player[a].timer++,player[a].phys.charging=!1)):(player[a].timer++,player[a].phys.charging=!1):(player[a].timer++,player[a].phys.charging=!1);aS[58].interrupt(a)||(reduceByTraction(a,
!0),10<player[a].timer&&15>player[a].timer&&drawVfx("swingUpsmash",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-11),13==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword3"),randomShout()),13<player[a].timer&&17>player[a].timer&&player[a].hitboxes.frame++,17==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(54<player[a].timer)return aS[0].init(a),!0;
if(45<player[a].timer&&!player[a].inCSS){var b=checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,
!0),!0}return!1}},{name:"DSMASH",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=59;player[a].timer=0;player[a].phys.charging=!1;player[a].phys.chargeFrames=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.dsmash1.id0;player[a].hitboxes.id1=player[a].charHitboxes.dsmash1.id1;player[a].hitboxes.id2=player[a].charHitboxes.dsmash1.id2;player[a].hitboxes.id3=player[a].charHitboxes.dsmash1.id3;aS[59].main(a)},main:function(a){3==player[a].timer?player[a].inputs.a[0]||
player[a].inputs.z[0]?(player[a].phys.charging=!0,player[a].phys.chargeFrames++,5==player[a].phys.chargeFrames&&playSfx("smashcharge"),60==player[a].phys.chargeFrames&&(player[a].timer++,player[a].phys.charging=!1)):(player[a].timer++,player[a].phys.charging=!1):(player[a].timer++,player[a].phys.charging=!1);aS[59].interrupt(a)||(reduceByTraction(a,!0),3<player[a].timer&&10>player[a].timer&&drawVfx("swingDsmash1",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),
player[a].phys.face,player[a].timer-4),16<player[a].timer&&26>player[a].timer&&drawVfx("swingDsmash2",new Vec2D(player[a].phys.pos.x+player[a].phys.cVel.x,player[a].phys.pos.y+player[a].phys.cVel.y),player[a].phys.face,player[a].timer-17),5==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword3"),randomShout()),5<player[a].timer&&8>player[a].timer&&player[a].hitboxes.frame++,8==player[a].timer&&turnOffHitboxes(a),20==player[a].timer&&(player[a].hitboxes.id0=
player[a].charHitboxes.dsmash2.id0,player[a].hitboxes.id1=player[a].charHitboxes.dsmash2.id1,player[a].hitboxes.id2=player[a].charHitboxes.dsmash2.id2,player[a].hitboxes.id3=player[a].charHitboxes.dsmash2.id3,player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword3")),20<player[a].timer&&23>player[a].timer&&player[a].hitboxes.frame++,23==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){if(64<player[a].timer)return aS[0].init(a),!0;if(61<player[a].timer&&!player[a].inCSS){var b=
checkForSpecials(a),d=checkForTilts(a),e=checkForSmashes(a);if(checkForJump(a))return aS[8].init(a),!0;if(b[0])return aS[b[1]].init(a),!0;if(e[0])return aS[e[1]].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(checkForDash(a))return aS[1].init(a),!0;if(checkForSmashTurn(a))return aS[3].init(a),!0;if(checkForTiltTurn(a))return player[a].phys.dashbuffer=tiltTurnDashBuffer(a),aS[4].init(a),!0;if(.3<Math.abs(player[a].inputs.lStickAxis[0].x))return aS[7].init(a,!0),!0}return!1}},{name:"DOWNBOUND",canEdgeCancel:!0,
canBeGrabbed:!0,init:function(a){player[a].actionState=60;player[a].timer=0;player[a].phys.kVel.y=0;drawVfx("groundBounce",player[a].phys.pos,player[a].phys.face);playSfx("bounce");aS[60].main(a)},main:function(a){player[a].timer++;aS[60].interrupt(a)||(1==player[a].timer?reduceByTraction(a,!0):player[a].phys.cVel.x=0)},interrupt:function(a){return 26<player[a].timer?(aS[61].init(a),!0):!1}},{name:"DOWNWAIT",canEdgeCancel:!0,canBeGrabbed:!1,init:function(a){player[a].actionState=61;player[a].timer=
0;aS[61].main(a)},main:function(a){player[a].timer++;aS[61].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 60<player[a].timer?(aS[61].init(a),!0):-.7>player[a].inputs.lStickAxis[0].x*player[a].phys.face?(aS[63].init(a),!0):.7<player[a].inputs.lStickAxis[0].x*player[a].phys.face?(aS[64].init(a),!0):.7<player[a].inputs.lStickAxis[0].y?(aS[62].init(a),!0):player[a].inputs.a[0]&&!player[a].inputs.a[1]||player[a].inputs.b[0]&&!player[a].inputs.b[1]?(aS[65].init(a),!0):!1}},{name:"DOWNSTANDN",
canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=62;player[a].timer=0;aS[62].main(a)},main:function(a){player[a].timer++;aS[62].interrupt(a)||(reduceByTraction(a,!0),1==player[a].timer&&(player[a].phys.intangibleTimer=22))},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"DOWNSTANDB",canEdgeCancel:!1,canBeGrabbed:!0,setVelocities:[-.185,-.37,-.573,-1.54,-1.614,-1.586,-1.566,-1.614,-1.647,-1.666,-1.669,-1.657,-1.63,-1.588,-1.531,-1.397,-1.224,-1.094,
-1.006,-.962,-.96,-.926,-.816,-.684,-.529,-.352,-.226,-.171,-.124,-.084,-.051,-.025,-.007,.004,.008],init:function(a){player[a].actionState=63;player[a].timer=0;aS[63].main(a)},main:function(a){player[a].timer++;aS[63].interrupt(a)||(player[a].phys.cVel.x=aS[63].setVelocities[player[a].timer-1]*player[a].phys.face,1==player[a].timer&&(player[a].phys.intangibleTimer=19))},interrupt:function(a){return 35<player[a].timer?(aS[0].init(a),!0):!1}},{name:"DOWNSTANDF",canEdgeCancel:!1,canBeGrabbed:!0,setVelocities:[.467,
1.36,1.733,2.135,2.355,2.581,2.055,2.281,2.184,1.902,1.703,1.521,1.357,1.211,1.082,.971,.878,.802,.743,.703,.68,.674,.686,.716,.763,.775,.727,.661,.577,.474,.352,.241,.163,.101,.055],init:function(a){player[a].actionState=64;player[a].timer=0;aS[64].main(a)},main:function(a){player[a].timer++;aS[64].interrupt(a)||(player[a].phys.cVel.x=aS[64].setVelocities[player[a].timer-1]*player[a].phys.face,6==player[a].timer&&(player[a].phys.intangibleTimer=14))},interrupt:function(a){return 35<player[a].timer?
(aS[0].init(a),!0):!1}},{name:"DOWNATTACK",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=65;player[a].timer=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.downattack1.id0;player[a].hitboxes.id1=player[a].charHitboxes.downattack1.id1;player[a].hitboxes.id2=player[a].charHitboxes.downattack1.id2;player[a].hitboxes.id3=player[a].charHitboxes.downattack1.id3;aS[65].main(a)},main:function(a){player[a].timer++;aS[65].interrupt(a)||(reduceByTraction(a,!0),1==
player[a].timer&&(player[a].phys.intangibleTimer=31),20==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword2")),20<player[a].timer&&24>player[a].timer&&player[a].hitboxes.frame++,24==player[a].timer&&turnOffHitboxes(a),30==player[a].timer&&(player[a].hitboxes.id0=player[a].charHitboxes.downattack2.id0,player[a].hitboxes.id1=player[a].charHitboxes.downattack2.id1,player[a].hitboxes.id2=player[a].charHitboxes.downattack2.id2,player[a].hitboxes.id3=player[a].charHitboxes.downattack2.id3,
player[a].hitboxes.active=[!0,!0,!0,!0],player[a].hitboxes.frame=0,playSfx("sword2")),30<player[a].timer&&32>player[a].timer&&player[a].hitboxes.frame++,32==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){return 49<player[a].timer?(aS[0].init(a),!0):!1}},{name:"TECHN",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=66;player[a].timer=0;drawVfx("tech",player[a].phys.pos);playSfx("tech");aS[66].main(a)},main:function(a){player[a].timer++;aS[66].interrupt(a)||(reduceByTraction(a,
!0),1==player[a].timer&&(player[a].phys.intangibleTimer=20))},interrupt:function(a){return 26<player[a].timer?(aS[0].init(a),!0):!1}},{name:"TECHB",canEdgeCancel:!1,canBeGrabbed:!0,setVelocities:[0,0,0,0,0,0,0,-2.832,-2.726,-2.622,-2.521,-2.422,-2.326,-2.233,-2.142,-2.054,-1.968,-1.885,-1.811,-1.748,-1.691,-1.639,-1.593,-1.553,-1.519,-1.49,-1.467,-1.45,-1.439,-1.433,-1.433,-.002,-.003,-.004,-.005,-.006,-.006,-.007,-.007,-.006],init:function(a){player[a].actionState=67;player[a].timer=0;drawVfx("tech",
player[a].phys.pos);playSfx("tech");aS[67].main(a)},main:function(a){player[a].timer++;aS[67].interrupt(a)||(1==player[a].timer&&(player[a].phys.intangibleTimer=20),player[a].phys.cVel.x=aS[67].setVelocities[player[a].timer-1]*player[a].phys.face)},interrupt:function(a){return 40<player[a].timer?(aS[0].init(a),!0):!1}},{name:"TECHF",canEdgeCancel:!1,canBeGrabbed:!0,setVelocities:[0,0,0,0,0,0,0,4.036,3.526,2.726,2.317,1.862,1.656,1.625,1.768,1.989,2.094,2.083,1.956,1.846,1.814,1.757,1.676,1.57,1.44,
1.286,1.107,.949,.834,.727,.629,.54,.459,.387,.323,.268,.222,.184,.155,.135],init:function(a){player[a].actionState=68;player[a].timer=0;drawVfx("tech",player[a].phys.pos);playSfx("tech");aS[68].main(a)},main:function(a){player[a].timer++;aS[68].interrupt(a)||(1==player[a].timer&&(player[a].phys.intangibleTimer=20),player[a].phys.cVel.x=aS[68].setVelocities[player[a].timer-1]*player[a].phys.face)},interrupt:function(a){return 40<player[a].timer?(aS[0].init(a),!0):!1}},{name:"SHIELDBREAKFALL",canPassThrough:!1,
canBeGrabbed:!0,canGrabLedge:[!1,!1],wallJumpAble:!1,headBonk:!1,init:function(a){player[a].actionState=69;player[a].timer=0;aS[69].main(a)},main:function(a){player[a].timer++;aS[69].interrupt(a)||(player[a].phys.intangibleTimer=1,player[a].phys.cVel.y-=player[a].charAttributes.gravity)},interrupt:function(a){return 30<player[a].timer?(aS[69].init(a),!0):!1}},{name:"SHIELDBREAKDOWNBOUND",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=70;player[a].timer=0;player[a].phys.cVel.y=
0;player[a].phys.kVel.y=0;drawVfx("groundBounce",player[a].phys.pos,player[a].phys.face);playSfx("bounce");aS[70].main(a)},main:function(a){player[a].timer++;aS[70].interrupt(a)||(player[a].phys.intangibleTimer=1,1==player[a].timer?reduceByTraction(a,!0):player[a].phys.cVel.x=0)},interrupt:function(a){return 26<player[a].timer?(aS[71].init(a),!0):!1}},{name:"SHIELDBREAKSTAND",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=71;player[a].timer=0;aS[71].main(a)},main:function(a){player[a].timer++;
aS[71].interrupt(a)||(reduceByTraction(a,!0),player[a].phys.intangibleTimer=1)},interrupt:function(a){return 30<player[a].timer?(aS[72].init(a),!0):!1}},{name:"FURAFURA",canEdgeCancel:!0,canBeGrabbed:!0,init:function(a){player[a].actionState=72;player[a].timer=0;player[a].phys.stuckTimer=490;drawVfx("furaFura",new Vec2D(player[a].phys.pos.x+(4+2*Math.random())*player[a].phys.face,player[a].phys.pos.y+11+3*Math.random()),player[a].phys.face);player[a].furaLoopID=sounds.furaloop.play();aS[72].main(a)},
main:function(a){player[a].timer++;aS[72].interrupt(a)||(65==player[a].timer%100&&playSfx("furacry"),reduceByTraction(a,!0),0==player[a].timer%49&&drawVfx("furaFura",new Vec2D(player[a].phys.pos.x+(3+2*Math.random())*player[a].phys.face,player[a].phys.pos.y+11+3*Math.random()),player[a].phys.face),20==player[a].timer%49&&drawVfx("furaFura",new Vec2D(player[a].phys.pos.x+(5+2*Math.random())*player[a].phys.face,player[a].phys.pos.y+8+3*Math.random()),player[a].phys.face),30<player[a].phys.shieldHP&&
(player[a].phys.shieldHP=30),player[a].phys.stuckTimer--,mashOut(a)&&(player[a].phys.stuckTimer-=3))},interrupt:function(a){return 0>=player[a].phys.stuckTimer?(sounds.furaloop.stop(player[a].furaLoopID),aS[0].init(a),!0):!1}},{name:"GRAB",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=73;player[a].timer=0;player[a].phys.charging=!1;player[a].phys.chargeFrames=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.grab.id0;player[a].hitboxes.id1=player[a].charHitboxes.grab.id1;
player[a].hitboxes.id2=player[a].charHitboxes.grab.id2;aS[73].main(a)},main:function(a){player[a].timer++;aS[73].interrupt(a)||(reduceByTraction(a,!0),7==player[a].timer&&(player[a].hitboxes.active=[!0,!0,!0,!1],player[a].hitboxes.frame=0,playSfx("grab")),7<player[a].timer&&9>player[a].timer&&player[a].hitboxes.frame++,9==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"CAPTUREPULLED",canEdgeCancel:!1,canBeGrabbed:!1,init:function(a){player[a].actionState=
74;player[a].timer=0;player[a].phys.grounded=!0;player[a].phys.face=-1*player[player[a].phys.grabbedBy].phys.face;player[a].phys.onSurface=[player[player[a].phys.grabbedBy].phys.onSurface[0],player[player[a].phys.grabbedBy].phys.onSurface[1]];player[a].phys.stuckTimer=100+2*player[a].percent;playSfx("grabbed");aS[74].main(a)},main:function(a){player[a].timer++;aS[74].interrupt(a)||2!=player[a].timer||(player[a].phys.pos=new Vec2D(player[player[a].phys.grabbedBy].phys.pos.x+-16.41205*player[a].phys.face,
player[player[a].phys.grabbedBy].phys.pos.y))},interrupt:function(a){return 2<player[a].timer?(aS[75].init(a),aS[76].init(player[a].phys.grabbedBy),drawVfx("tech",new Vec2D(player[a].phys.pos.x,player[a].phys.pos.y+10)),!0):!1}},{name:"CAPTUREWAIT",canEdgeCancel:!1,canBeGrabbed:!1,init:function(a){player[a].actionState=75;player[a].timer=0;player[a].phys.pos=new Vec2D(player[player[a].phys.grabbedBy].phys.pos.x+-9.04298*player[a].phys.face,player[player[a].phys.grabbedBy].phys.pos.y);aS[75].main(a)},
main:function(a){player[a].timer++;aS[75].interrupt(a)||(player[a].phys.stuckTimer--,mashOut(a)?(player[a].phys.stuckTimer-=3,player[a].phys.pos.x+=.5*Math.sign(Math.random()-.5)):player[a].phys.pos.x=player[player[a].phys.grabbedBy].phys.pos.x+-9.04298*player[a].phys.face)},interrupt:function(a){return 0>player[a].phys.stuckTimer?(aS[78].init(player[a].phys.grabbedBy),aS[77].init(a),!0):1<player[a].timer?(aS[75].init(a),!0):!1}},{name:"CATCHWAIT",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
76;player[a].timer=0;turnOffHitboxes(a);aS[76].main(a)},main:function(a){player[a].timer++;aS[76].interrupt(a)},interrupt:function(a){return player[a].inputs.a[0]&&!player[a].inputs.a[1]?(aS[79].init(a),!0):.7<player[a].inputs.lStickAxis[0].y&&.7>player[a].inputs.lStickAxis[1].y||.7<player[a].inputs.cStickAxis[0].y?(aS[81].init(a),!0):-.7>player[a].inputs.lStickAxis[0].y&&-.7<player[a].inputs.lStickAxis[1].y||-.7>player[a].inputs.cStickAxis[0].y?(aS[83].init(a),!0):-.7>player[a].inputs.lStickAxis[0].x*
player[a].phys.face&&-.7<player[a].inputs.lStickAxis[1].x*player[a].phys.face||-.7>player[a].inputs.cStickAxis[0].x*player[a].phys.face?(aS[85].init(a),!0):.7<player[a].inputs.lStickAxis[0].x*player[a].phys.face&&.7>player[a].inputs.lStickAxis[1].x*player[a].phys.face||.7<player[a].inputs.cStickAxis[0].x*player[a].phys.face?(aS[87].init(a),!0):1<player[a].timer?(aS[76].init(a),!0):!1}},{name:"CAPTURECUT",canEdgeCancel:!1,canGrabLedge:[!0,!1],wallJumpAble:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=
77;player[a].timer=0;player[a].phys.grabbedBy=-1;player[a].phys.cVel.x=-1*player[a].phys.face;aS[77].main(a)},main:function(a){player[a].timer++;aS[77].interrupt(a)||(2==player[a].timer&&(player[a].phys.grabTech=!1),reduceByTraction(a,!0))},interrupt:function(a){return 30<player[a].timer?(aS[0].init(a),!0):!1}},{name:"CATCHCUT",canEdgeCancel:!1,canGrabLedge:[!0,!1],canBeGrabbed:!0,init:function(a){player[a].actionState=78;player[a].timer=0;player[a].phys.grabbing=-1;player[a].phys.cVel.x=-1*player[a].phys.face;
aS[78].main(a)},main:function(a){player[a].timer++;aS[78].interrupt(a)||reduceByTraction(a,!0)},interrupt:function(a){return 29<player[a].timer?(aS[0].init(a),!0):!1}},{name:"CATCHATTACK",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=79;player[a].timer=0;turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.pummel.id0;aS[79].main(a)},main:function(a){player[a].timer++;aS[79].interrupt(a)||(6==player[a].timer&&(player[a].hitboxes.active=[!0,!1,!1,!1],player[a].hitboxes.frame=
0),7==player[a].timer&&turnOffHitboxes(a))},interrupt:function(a){return 24<player[a].timer?(aS[76].init(a),!0):!1}},{name:"CAPTUREDAMAGE",canEdgeCancel:!1,canBeGrabbed:!1,setPositions:[9.478,9.478,9.478,9.478,9.478,9.478,9.478,9.478,9.478,9.306,8.92,8.516,8.29,8.293,8.41,8.593,8.792,8.959,9.043,9.068],init:function(a){player[a].actionState=80;player[a].timer=0;aS[80].main(a)},main:function(a){player[a].timer++;aS[80].interrupt(a)||(player[a].phys.pos.x=player[player[a].phys.grabbedBy].phys.pos.x+
-aS[80].setPositions[player[a].timer-1]*player[a].phys.face)},interrupt:function(a){return 20<player[a].timer?(aS[75].init(a),!0):!1}},{name:"THROWUP",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=81;player[a].timer=0;aS[82].init(player[a].phys.grabbing);turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.throwup.id0;randomShout();aS[81].main(a)},main:function(a){player[a].timer++;aS[81].interrupt(a)||11!=player[a].timer||(hitQueue.push([player[a].phys.grabbing,
a,0,!1,!0,!1]),turnOffHitboxes(a))},interrupt:function(a){return 39<player[a].timer?(player[a].phys.grabbing=-1,aS[0].init(a),!0):11>player[a].timer&&player[player[a].phys.grabbing].phys.grabbedBy!=a?(console.log("test"),aS[78].init(a),!0):!1}},{name:"THROWNUP",canEdgeCancel:!1,canGrabLedge:[!1,!1],canBeGrabbed:!1,init:function(a){player[a].actionState=82;player[a].timer=player[a].phys.grabbedBy<a?-1:0;player[a].phys.grounded=!1;player[a].phys.pos=new Vec2D(player[player[a].phys.grabbedBy].phys.pos.x,
player[player[a].phys.grabbedBy].phys.pos.y);aS[82].main(a)},main:function(a){player[a].timer++;aS[82].interrupt(a)},interrupt:function(a){return!1}},{name:"THROWDOWN",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=83;player[a].timer=0;aS[84].init(player[a].phys.grabbing);turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.throwdown.id0;randomShout();aS[83].main(a)},main:function(a){player[a].timer++;aS[83].interrupt(a)||13!=player[a].timer||(hitQueue.push([player[a].phys.grabbing,
a,0,!1,!0,!0]),turnOffHitboxes(a))},interrupt:function(a){return 37<player[a].timer?(player[a].phys.grabbing=-1,aS[0].init(a),!0):13>player[a].timer&&player[player[a].phys.grabbing].phys.grabbedBy!=a?(console.log("test"),aS[78].init(a),!0):!1}},{name:"THROWNDOWN",canEdgeCancel:!1,reverseModel:!0,canGrabLedge:[!1,!1],canBeGrabbed:!1,init:function(a){player[a].actionState=84;player[a].timer=player[a].phys.grabbedBy<a?-1:0;player[a].phys.grounded=!1;player[a].phys.face*=-1;player[a].phys.pos=new Vec2D(player[player[a].phys.grabbedBy].phys.pos.x,
player[player[a].phys.grabbedBy].phys.pos.y);aS[84].main(a)},main:function(a){player[a].timer++;aS[84].interrupt(a)},interrupt:function(a){return!1}},{name:"THROWBACK",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=85;player[a].timer=0;aS[86].init(player[a].phys.grabbing);turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.throwback.id0;randomShout();aS[85].main(a)},main:function(a){player[a].timer++;aS[85].interrupt(a)||7!=player[a].timer||(hitQueue.push([player[a].phys.grabbing,
a,0,!1,!0,!0]),turnOffHitboxes(a))},interrupt:function(a){return 39<player[a].timer?(player[a].phys.grabbing=-1,aS[0].init(a),!0):7>player[a].timer&&player[player[a].phys.grabbing].phys.grabbedBy!=a?(aS[78].init(a),!0):!1}},{name:"THROWNBACK",canEdgeCancel:!1,reverseModel:!0,canGrabLedge:[!1,!1],canBeGrabbed:!1,init:function(a){player[a].actionState=86;player[a].timer=player[a].phys.grabbedBy<a?-1:0;player[a].phys.grounded=!1;player[a].phys.face*=-1;player[a].phys.pos=new Vec2D(player[player[a].phys.grabbedBy].phys.pos.x,
player[player[a].phys.grabbedBy].phys.pos.y);aS[86].main(a)},main:function(a){player[a].timer++;aS[86].interrupt(a)},interrupt:function(a){return!1}},{name:"THROWFORWARD",canEdgeCancel:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=87;player[a].timer=0;aS[88].init(player[a].phys.grabbing);turnOffHitboxes(a);player[a].hitboxes.id0=player[a].charHitboxes.throwforward.id0;randomShout();aS[87].main(a)},main:function(a){player[a].timer++;aS[87].interrupt(a)||13!=player[a].timer||(hitQueue.push([player[a].phys.grabbing,
a,0,!1,!0,!0]),turnOffHitboxes(a))},interrupt:function(a){return 27<player[a].timer?(player[a].phys.grabbing=-1,aS[0].init(a),!0):13>player[a].timer&&player[player[a].phys.grabbing].phys.grabbedBy!=a?(aS[78].init(a),!0):!1}},{name:"THROWNFORWARD",canEdgeCancel:!1,canGrabLedge:[!1,!1],canBeGrabbed:!1,init:function(a){player[a].actionState=88;player[a].timer=player[a].phys.grabbedBy<a?-1:0;player[a].phys.grounded=!1;player[a].phys.pos=new Vec2D(player[player[a].phys.grabbedBy].phys.pos.x,player[player[a].phys.grabbedBy].phys.pos.y);
aS[88].main(a)},main:function(a){player[a].timer++;aS[88].interrupt(a)},interrupt:function(a){return!1}},{name:"WALLDAMAGE",canPassThrough:!1,canGrabLedge:[!1,!1],wallJumpAble:!1,canBeGrabbed:!0,headBonk:!0,init:function(a){player[a].actionState=89;player[a].timer=0;playSfx("bounce");aS[89].main(a)},main:function(a){player[a].timer++;0==player[a].hit.hitstun%10&&drawVfx("flyingDust",player[a].phys.pos);2==player[a].timer&&(player[a].phys.kVel.y*=.8,player[a].phys.kVel.x*=-.8,player[a].phys.kDec.x*=
-1);aS[89].interrupt(a)||(player[a].hit.hitstun--,player[a].phys.cVel.y-=player[a].charAttributes.gravity,player[a].phys.cVel.y<-player[a].charAttributes.terminalV&&(player[a].phys.cVel.y=-player[a].charAttributes.terminalV))},interrupt:function(a){return 50<player[a].timer?(aS[40].init(a),!0):!1}},{name:"WALLTECH",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=90;player[a].timer=0;player[a].phys.fastfalled=!1;player[a].hit.hitstun=
0;player[a].phys.kVel.y=0;player[a].phys.kVel.x=0;player[a].phys.cVel.x=0;player[a].phys.intangibleTimer=Math.max(player[a].phys.intangibleTimer,14);1==player[a].phys.face?drawVfx("tech",player[a].phys.ECBp[3]):drawVfx("tech",player[a].phys.ECBp[1]);aS[90].main(a)},main:function(a){1>player[a].timer?(player[a].timer+=.15,1<player[a].timer&&(player[a].timer=1)):player[a].timer++;aS[90].interrupt(a)||(2==player[a].timer&&playSfx("walljump"),.89<player[a].timer&&.91>player[a].timer&&(player[a].phys.cVel.x=
.5*player[a].phys.face),1<=player[a].timer&&(fastfall(a),airDrift(a)))},interrupt:function(a){if(1<player[a].timer){var b=checkForAerials(a),d=checkForSpecials(a);if(b[0])return aS[b[1]].init(a),!0;if(player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1])return aS[11].init(a),!0;if((player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped)return aS[19].init(a),
!0;if(d[0])return aS[d[1]].init(a),!0;if(26<player[a].timer)return aS[13].init(a),!0}return!1}},{name:"WALLJUMP",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!1,canBeGrabbed:!0,init:function(a){player[a].actionState=91;player[a].timer=0;player[a].phys.fastfalled=!1;player[a].hit.hitstun=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.intangibleTimer=Math.max(player[a].phys.intangibleTimer,14);player[a].phys.cVel.x=1.3*player[a].phys.face;player[a].phys.cVel.y=2.4*
Math.pow(.97,player[a].phys.wallJumpCount);player[a].phys.wallJumpCount++;player[a].hit.hitlag=5;player[a].hit.knockback=0;1==player[a].phys.face?drawVfx("tech",player[a].phys.ECBp[3]):drawVfx("tech",player[a].phys.ECBp[1]);aS[91].main(a)},main:function(a){player[a].timer++;2==player[a].timer&&playSfx("walljump");aS[91].interrupt(a)||(fastfall(a),airDrift(a))},interrupt:function(a){if(1<player[a].timer){var b=checkForAerials(a),d=checkForSpecials(a);if(b[0])return aS[b[1]].init(a),!0;if(player[a].inputs.l[0]&&
!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1])return aS[11].init(a),!0;if((player[a].inputs.x[0]&&!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped)return aS[19].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(40<player[a].timer)return aS[13].init(a),!0}return!1}},{name:"WALLTECHJUMP",canPassThrough:!0,canGrabLedge:[!0,!1],wallJumpAble:!0,headBonk:!1,
canBeGrabbed:!0,init:function(a){player[a].actionState=92;player[a].timer=0;player[a].phys.fastfalled=!1;player[a].hit.hitstun=0;player[a].phys.kVel.y=0;player[a].phys.kVel.x=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.intangibleTimer=Math.max(player[a].phys.intangibleTimer,14);1==player[a].phys.face?drawVfx("tech",player[a].phys.ECBp[3]):drawVfx("tech",player[a].phys.ECBp[1]);aS[92].main(a)},main:function(a){1>player[a].timer?(player[a].timer+=.15,1<player[a].timer&&(player[a].timer=
1)):player[a].timer++;2==player[a].timer&&playSfx("walljump");aS[90].interrupt(a)||(.89<player[a].timer&&.91>player[a].timer&&(player[a].phys.cVel.x=1.3*player[a].phys.face,player[a].phys.cVel.y=2.4),1<=player[a].timer&&(fastfall(a),airDrift(a)))},interrupt:function(a){if(1<player[a].timer){var b=checkForAerials(a),d=checkForSpecials(a);if(b[0])return aS[b[1]].init(a),!0;if(player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&!player[a].inputs.r[1])return aS[11].init(a),!0;if((player[a].inputs.x[0]&&
!player[a].inputs.x[1]||player[a].inputs.y[0]&&!player[a].inputs.y[1]||.7<player[a].inputs.lStickAxis[0].y&&.7>=player[a].inputs.lStickAxis[1].y)&&!player[a].phys.doubleJumped)return aS[19].init(a),!0;if(d[0])return aS[d[1]].init(a),!0;if(40<player[a].timer)return aS[13].init(a),!0}return!1}},{name:"SLEEP",canBeGrabbed:!1,init:function(a){player[a].actionState=93;player[a].timer=0;player[a].hit.hitstun=0;player[a].phys.kVel.y=0;player[a].phys.kVel.x=0;player[a].phys.cVel.x=0;player[a].phys.cVel.y=
0;player[a].phys.pos.x=300;aS[93].main(a)},main:function(a){},interrupt:function(a){return!1}},{name:"ENTRANCE",canBeGrabbed:!1,init:function(a){player[a].actionState=94;player[a].timer=0;player[a].phys.grounded=!1;aS[94].main(a)},main:function(a){player[a].timer++;aS[94].interrupt(a)},interrupt:function(a){60<player[a].timer&&aS[13].init(a)}},{name:"CLIFFGETUPQUICK",canBeGrabbed:!0,offset:[[-71.33,-23.71],[-71.38,-23.71],[-71.42,-23.71],[-71.45,-23.71],[-71.46,-23.71],[-71.44,-23.71],[-71.38,-23.71],
[-71.26,-23.71],[-71.07,-22.69],[-70.8,-19.99],[-70.47,-16.19],[-70.11,-11.83],[-69.71,-7.48],[-69.28,-3.68],[-68.83,-1.01],[-67.88,0],[-67.38,0],[-66.87,0],[-66.35,0],[-65.81,0],[-65.27,0],[-64.73,0],[-64.19,0],[-63.65,0],[-63.12,0],[-62.59,0],[-62.08,0],[-61.6,0],[-61.17,0],[-60.8,0],[-60.5,0],[-60.28,0]],init:function(a){player[a].actionState=95;player[a].timer=0;player[a].phys.intangibleTimer=30;aS[95].main(a)},main:function(a){player[a].timer++;if(!aS[95].interrupt(a)){var b=stage.ledge[player[a].phys.onLedge][1]?
stage.box[stage.ledge[player[a].phys.onLedge][0]].max.x:stage.box[stage.ledge[player[a].phys.onLedge][0]].min.x,d=stage.box[stage.ledge[player[a].phys.onLedge][0]].max.y;16>player[a].timer?player[a].phys.pos=new Vec2D(b+(aS[95].offset[player[a].timer-1][0]+68.4)*player[a].phys.face,d+aS[95].offset[player[a].timer-1][1]):player[a].phys.pos.x=b+(68.4+aS[95].offset[player[a].timer-1][0])*player[a].phys.face;16==player[a].timer&&(player[a].phys.grounded=!0,player[a].phys.onSurface=[0,stage.ledge[player[a].phys.onLedge][0]],
player[a].phys.airborneTimer=0,player[a].phys.pos.y=d)}},interrupt:function(a){return 32<player[a].timer?(player[a].phys.onLedge=-1,player[a].phys.ledgeRegrabCount=!0,aS[0].init(a),!0):!1}}];twoPi=2*Math.PI;function drawArrayPath(a,b,d,e,f,h,q){for(var n=0;n<f.length;n++){var m=f[n][0]*h*b+d,g=f[n][1]*q+e;0==n?(c.fillStyle=a,c.beginPath(),c.moveTo(m,g)):c.lineTo(m,g)}c.closePath();c.fill()}
function renderPlayer(a){var b=player[a].phys.pos.x*stage.scale+stage.offset[0],d=player[a].phys.pos.y*-stage.scale+stage.offset[1],e=player[a].phys.face,f=Math.floor(player[a].timer);0==f&&(f=1);var h=animations[charSelect[a]][aS[player[a].actionState].name][f-1];switch(player[a].actionState){case 15:case 17:case 20:case 25:case 61:case 72:case 94:h=animations[charSelect[a]][aS[player[a].actionState].name][0]}aS[player[a].actionState].reverseModel?e*=-1:4==player[a].actionState?5<f&&(e*=-1):6==player[a].actionState?
18<f&&(e*=-1):34==player[a].actionState&&29<f&&(e*=-1);if(player[a].phys.shielding&&!(player[a].phys.powerShielded&&0<player[a].hit.hitlag)){var q=player[a].phys.shieldPositionReal.x*stage.scale+stage.offset[0],n=player[a].phys.shieldPositionReal.y*-stage.scale+stage.offset[1],m=palettes[pPal[a]][2];0<Math.floor(player[a].hit.shieldstun)&&(m=palettes[pPal[a]][4]);c.fillStyle=m+.6*player[a].phys.shieldAnalog+")";c.beginPath();c.arc(q,n,player[a].phys.shieldSize*stage.scale,twoPi,0);c.fill()}if(26>
player[a].actionState||29<player[a].actionState){q=player[a].phys.shielding&&player[a].phys.powerShielded&&0<player[a].hit.hitlag?"rgb(255,255,255)":3<player[a].phys.intangibleTimer%9||3<player[a].phys.invincibleTimer%9||0<player[a].hit.hitlag?palettes[pPal[a]][1]:player[a].phys.charging&&3<player[a].phys.chargeFrames%9?"rgba(252, 255, 91, 0.7)":72==player[a].actionState&&6>player[a].timer%30?palettes[pPal[a]][3]:palettes[pPal[a]][0];3==player[a].phys.chargeFrames%4?b+=2:1==player[a].phys.chargeFrames%
4&&(b-=2);if(1220<b||-20>b||880<d||-30>d){var n=new Vec2D(b-600,d-375),m=new Vec2D(0,0),g=(n.y-m.y)/(n.x-m.x);-375<=600*g&&375>=600*g?(n.x>m.x?(player[a].miniViewPoint=new Vec2D(1150,600*g+375),player[a].miniViewSide=0):(player[a].miniViewPoint=new Vec2D(50,600*-g+375),player[a].miniViewSide=1),player[a].miniView=!0):-600<=375/g&&600>=375/g?(player[a].miniViewPoint=n.y>m.y?50>b?new Vec2D(50,700):1150<b?new Vec2D(1150,700):new Vec2D(b,700):new Vec2D(-375/g+stage.offset[0],50),player[a].miniViewSide=
2,player[a].miniView=!0):player[a].miniView=!1}else player[a].miniView=!1;player[a].miniView&&93!=player[a].actionState?(c.fillStyle="black",c.strokeStyle=palettes[pPal[a]][0],c.beginPath(),c.arc(player[a].miniViewPoint.x,player[a].miniViewPoint.y,35,twoPi,0),c.fill(),c.lineWidth=6,c.stroke(),c.lineWidth=1,drawArrayPath(q,e,player[a].miniViewPoint.x,player[a].miniViewPoint.y+30,h,.14,.14)):94==player[a].actionState?drawArrayPath(q,e,b,d,h,stage.scale/4.5*.2,stage.scale/4.5*Math.min(.2,.2*(1.5-startTimer))):
drawArrayPath(q,e,b,d,h,stage.scale/4.5*.2,stage.scale/4.5*.2)}hasTag[a]&&(c.fillStyle="rgba(0,0,0,0.5)",c.strokeStyle=palettes[pPal[a]][0],e=10*tagText[a].length,c.fillRect(b-e/2,d-stage.scale/4.5*130,e,20),c.strokeRect(b-e/2,d-stage.scale/4.5*130,e,20),c.font="13px Lucida Console, monaco, monospace",c.textAlign="center",c.fillStyle="white",c.fillText(tagText[a],b,d+15-stage.scale/4.5*130),c.fillStyle=palettes[pPal[a]][0],c.beginPath(),c.moveTo(b-8,d+20-stage.scale/4.5*130),c.lineTo(b+8,d+20-stage.scale/
4.5*130),c.lineTo(b,d+28-stage.scale/4.5*130),c.closePath(),c.fill(),c.textAlign="start");if(30==player[a].actionState||31==player[a].actionState)c.fillStyle=palettes[pPal[a]][1],c.strokeStyle=palettes[pPal[a]][0],c.beginPath(),c.moveTo(b+stage.scale/4.5*18,d+stage.scale/4.5*13.5),c.lineTo(b+stage.scale/4.5*31.5,d),c.lineTo(b-stage.scale/4.5*31.5,d),c.lineTo(b-stage.scale/4.5*18,d+stage.scale/4.5*13.5),c.closePath(),c.fill(),c.stroke();player[a].showLedgeGrabBox&&(c.strokeStyle="#4478ff",c.strokeRect(player[a].phys.ledgeSnapBoxF.min.x*
stage.scale+stage.offset[0],player[a].phys.ledgeSnapBoxF.min.y*-stage.scale+stage.offset[1],14*stage.scale,10*stage.scale),c.strokeStyle="#ff4444",c.strokeRect(player[a].phys.ledgeSnapBoxB.min.x*stage.scale+stage.offset[0],player[a].phys.ledgeSnapBoxB.min.y*-stage.scale+stage.offset[1],14*stage.scale,10*stage.scale));player[a].showECB&&(c.fillStyle="#ff8d2f",c.beginPath(),c.moveTo(player[a].phys.ECB1[0].x*stage.scale+stage.offset[0],player[a].phys.ECB1[0].y*-stage.scale+stage.offset[1]),c.lineTo(player[a].phys.ECB1[1].x*
stage.scale+stage.offset[0],player[a].phys.ECB1[1].y*-stage.scale+stage.offset[1]),c.lineTo(player[a].phys.ECB1[2].x*stage.scale+stage.offset[0],player[a].phys.ECB1[2].y*-stage.scale+stage.offset[1]),c.lineTo(player[a].phys.ECB1[3].x*stage.scale+stage.offset[0],player[a].phys.ECB1[3].y*-stage.scale+stage.offset[1]),c.closePath(),c.fill(),c.strokeStyle="white",c.beginPath(),c.moveTo(player[a].phys.ECBp[0].x*stage.scale+stage.offset[0],player[a].phys.ECBp[0].y*-stage.scale+stage.offset[1]),c.lineTo(player[a].phys.ECBp[1].x*
stage.scale+stage.offset[0],player[a].phys.ECBp[1].y*-stage.scale+stage.offset[1]),c.lineTo(player[a].phys.ECBp[2].x*stage.scale+stage.offset[0],player[a].phys.ECBp[2].y*-stage.scale+stage.offset[1]),c.lineTo(player[a].phys.ECBp[3].x*stage.scale+stage.offset[0],player[a].phys.ECBp[3].y*-stage.scale+stage.offset[1]),c.closePath(),c.stroke(),c.beginPath(),c.moveTo(b,d-6),c.lineTo(b,d+6),c.closePath(),c.stroke(),c.beginPath(),c.moveTo(b+6,d),c.lineTo(b-6,d),c.closePath(),c.stroke());if(player[a].showHitbox)for(c.fillStyle=
hurtboxColours[player[a].phys.hurtBoxState],c.fillRect(player[a].phys.hurtbox.min.x*stage.scale+stage.offset[0],player[a].phys.hurtbox.min.y*-stage.scale+stage.offset[1],8*stage.scale,18*stage.scale),c.fillStyle="rgba(255, 29, 29, 0.69)",b=0;4>b;b++)player[a].hitboxes.active[b]&&(d=player[a].hitboxes["id"+b].offset[player[a].hitboxes.frame],39==player[a].actionState&&(d=player[a].hitboxes["id"+b].offset[0]),c.beginPath(),c.arc((d.x*player[a].phys.face+player[a].phys.pos.x)*stage.scale+stage.offset[0],
(d.y+player[a].phys.pos.y)*-stage.scale+stage.offset[1],player[a].hitboxes["id"+b].size*stage.scale,2*Math.PI,0),c.fill());$("#actState"+a).empty().append(aS[player[a].actionState].name);$("#stateNum"+a).empty().append(f);$("#face"+a).empty().append(player[a].phys.face);$("#percent"+a).empty().append(player[a].percent)}lostStockQueue=[];
function renderOverlay(a){c.strokeStyle="black";if(!versusMode){c.fillStyle="white";c.lineWidth=2;c.font="900 40px Arial";c.textAlign="center";var b=Math.floor(matchTimer/60).toString(),d=(matchTimer%60).toFixed(2);c.fillText((2>b.length?"0"+b:b)+":"+(5>d.length?"0"+d[0]:d[0]+d[1]),590,70);c.strokeText((2>b.length?"0"+b:b)+":"+(5>d.length?"0"+d[0]:d[0]+d[1]),590,70);c.font="900 25px Arial";c.fillText(5>d.length?d[2]+d[3]:d[3]+d[4],670,70);c.strokeText(5>d.length?d[2]+d[3]:d[3]+d[4],670,70)}if(a){c.font=
"900 53px Arial";c.lineWidth=2;c.textAlign="end";c.save();c.scale(.8,1);for(a=0;4>a;a++)-1<playerType[a]&&(c.fillStyle="rgb(255,"+Math.max(255-player[a].percent,0)+", "+Math.max(255-player[a].percent,0)+")",c.fillText(player[a].percent+"%",1.25*(450+145*a+player[a].percentShake.x),670+player[a].percentShake.y),c.strokeText(player[a].percent+"%",1.25*(450+145*a+player[a].percentShake.x),670+player[a].percentShake.y));c.restore();for(a=0;4>a;a++)if(-1<playerType[a])for(c.fillStyle=palettes[pPal[a]][0],
b=0;b<player[a].stocks;b++)c.beginPath(),c.arc(337+145*a+30*b,600,12,0,twoPi),c.closePath(),c.fill(),c.stroke();lostStockPopQueue=[];c.fillStyle="white";c.strokeStyle="white";for(a=0;a<lostStockQueue.length;a++)lostStockQueue[a][2]++,20<lostStockQueue[a][2]?lostStockPopQueue.push(a):(c.save(),c.translate(337+145*lostStockQueue[a][0]+30*lostStockQueue[a][1]-2,598),c.fillRect(lostStockQueue[a][2],0,4,4),c.fillRect(lostStockQueue[a][2],lostStockQueue[a][2],4,4),c.fillRect(-lostStockQueue[a][2],lostStockQueue[a][2],
4,4),c.fillRect(lostStockQueue[a][2],-lostStockQueue[a][2],4,4),c.fillRect(-lostStockQueue[a][2],-lostStockQueue[a][2],4,4),c.fillRect(-lostStockQueue[a][2],0,4,4),c.fillRect(0,lostStockQueue[a][2],4,4),c.fillRect(0,-lostStockQueue[a][2],4,4),c.beginPath(),c.arc(2,2,lostStockQueue[a][2]/2,0,twoPi),c.closePath(),c.stroke(),c.restore());for(a=0;a<lostStockPopQueue.length;a++)lostStockQueue.splice(lostStockPopQueue[a]-a,1);c.textAlign="start"}}
function renderForeground(){c.fillStyle="#8e8e8e";c.save();c.fillRect(45,48,300,24);c.fillStyle="#3724a6";c.fillRect(60,50,50,20);c.beginPath();c.arc(60,60,10,0,twoPi);c.closePath();c.fill();c.beginPath();c.arc(110,60,10,0,twoPi);c.closePath();c.fill();c.restore();c.save();c.translate(950,650);c.fillRect(0,0,8,45);c.fillRect(0,25,200,20);c.fillRect(192,0,8,45);c.fillRect(0,0,12,4);c.fillRect(188,0,12,4);for(var a=54,b=0;3>b;b++)c.fillRect(a-2,-6,4,12),c.fillRect(a-6,-2,12,4),a+=46;c.beginPath();c.arc(169,
2,12,0,twoPi);c.closePath();c.fill();c.fillStyle="#21792f";c.beginPath();c.arc(123,2,15,0,twoPi);c.closePath();c.fill();c.fillStyle="#9a2622";c.beginPath();c.arc(40,62,12,0,twoPi);c.closePath();c.fill();c.fillStyle="#636363";c.beginPath();c.arc(31,2,15,.8*Math.PI,twoPi);c.closePath();c.fill();c.beginPath();c.arc(77,2,15,twoPi/2,.2*Math.PI);c.closePath();c.fill();c.fillRect(14,55,4,12);c.fillRect(10,59,12,4);c.fillRect(60,52,140,20);c.fillStyle="black";c.font="800 20px Arial";c.fillText("S",158,8);
c.fillText("B",32,70);c.fillText("Z",-872,-583);c.font="800 17px Arial";c.fillText("T",170,9);c.scale(1.2,1);c.font="900 24px Arial";c.fillText("RESET",72,43);c.fillText("L",17,7);c.fillText("R",56,7);c.fillText("A",93,9);c.font="900 20px Arial";c.fillText("RUNBACK",53,70);c.font="900 18px Arial";c.fillText("FRAME ADVANCE",-685,-584);c.restore()}angB=0;angles=[0,Math.PI];mlPos=mlVel=angR=0;mlDir=1;
circlePos=[[200,0,.4,1,200],[600,240,.21,1,250],[10,600,.7,-1,150],[350,500,.65,-1,270],[1E3,50,.9,1,200],[900,400,.1,-1,260]];var p=1;lightDust=[];for(var k=0;20>k;k++)lightDust[k]=[3*Math.random()+2,330+(26*k+26*Math.random()),520,.2];
function drawStartScreen(){c.fillStyle="rgba(46, 8, 154, 1)";var a=c.createRadialGradient(600,375,5,600,375,750);a.addColorStop(0,"#27005b");a.addColorStop(.25,"#2b0170");a.addColorStop(.5,"#2b005b");a.addColorStop(.75,"#35005b");a.addColorStop(1,"#38005b");c.fillStyle=a;c.fillRect(0,0,canvas.width,canvas.height);c.save();c.scale(1.5,1);c.shadowBlur=60;c.shadowColor="rgba(147, 14, 42, 1)";c.shadowOffsetX=-3150;c.fillStyle="rgba(147, 14, 42, 0.5)";c.translate(2440,380);for(var b=a=0;10>b;b++)c.beginPath(),
c.arc(0,0,720,a,a+Math.PI/20),c.lineTo(0,0),c.closePath(),c.fill(),a+=Math.PI/5;c.restore();c.save();c.lineWidth=60;c.strokeStyle="rgba(92, 18, 18, 0.2)";for(a=0;6>a;a++){circlePos[a][0]+=circlePos[a][2]*circlePos[a][3];circlePos[a][1]+=circlePos[a][2]*circlePos[a][3];if(1300<circlePos[a][0]||850<circlePos[a][1])--circlePos[a][0],--circlePos[a][1],circlePos[a][3]*=-1;if(-100>circlePos[a][0]||-100>circlePos[a][1])circlePos[a][0]+=1,circlePos[a][1]+=1,circlePos[a][3]*=-1;c.beginPath();c.arc(Math.round(circlePos[a][0]),
Math.round(circlePos[a][1]),circlePos[a][4],0,twoPi);c.closePath();c.stroke()}c.restore();c.save();c.fillStyle="#333236";c.translate(600,375);a=angB+=.001;for(b=0;30>b;b++)c.beginPath(),c.arc(0,0,720,a,a+Math.PI/30),c.lineTo(0,0),c.closePath(),c.fill(),a+=Math.PI/15;c.restore();a=c.createRadialGradient(600,375,5,600,375,300);a.addColorStop(0,"rgb(51, 51, 51)");a.addColorStop(1,"rgba(51, 51, 51, 0)");c.fillStyle=a;c.fillRect(0,0,canvas.width,canvas.height);c.save();c.lineWidth=3;c.strokeStyle="rgba(149, 255, 131, 0.12)";
c.scale(1.3,1.1);a=20;for(b=0;15>b;b++)c.beginPath(),c.arc(515,530+10*b,a,0,twoPi),c.closePath(),c.stroke(),a+=30+5*b;c.restore();c.save();c.lineWidth=3;c.strokeStyle="rgba(149, 255, 131, 0.12)";c.translate(670,580);angR+=.001;c.rotate(angR);a=[angles[0],angles[1]];for(b=0;25>b;b++)c.beginPath(),c.moveTo(0,0),c.bezierCurveTo(6E3*Math.cos(a[0]),6E3*Math.sin(a[0]),6E3*Math.cos(a[1]),6E3*Math.sin(a[1]),0,0),c.closePath(),c.stroke(),a[0]+=Math.PI/16,a[1]-=Math.PI/16;c.restore();c.save();c.strokeStyle=
"rgba(0, 0, 0, 0.3)";c.strokeStyle="rgba(255, 255, 255, 0.6)";c.lineWidth=5;c.globalCompositeOperation="xor";a=c.createLinearGradient(0,0,0,390);a.addColorStop(0,"rgba(0, 0, 0, 1)");a.addColorStop(1,"rgba(255, 255, 255, 0.5)");c.fillStyle=a;c.textAlign="center";c.font="900 250px Arial";c.strokeText("Melee",600,350);c.fillText("Melee",600,350);c.globalCompositeOperation="lighter";a=c.createLinearGradient(0,440+mlPos,0,500+mlPos);a.addColorStop(0,"rgba(255, 255, 255,0.45)");a.addColorStop(1,"rgba(255, 255, 255,0.2)");
c.fillStyle=a;c.shadowBlur=30;c.shadowColor="rgba(255, 255, 255, 0.7)";c.font="900 150px Arial";c.fillText("LIGHT",600,500+mlPos);mlVel+=.05*mlDir;mlPos+=mlVel;if(.8<Math.abs(mlVel)&&(mlDir*=-1,-1==mlDir))for(a=0;10>a;a++);c.restore();for(a=0;20>a;a++)410>lightDust[a][2]&&(lightDust[a]=[3*Math.random()+2,330+(26*a+26*Math.random()),520,.2]),lightDust[a][2]-=lightDust[a][0],lightDust[a][3]=Math.max(0,lightDust[a][3]-.01),c.fillStyle="rgba(155,155,255,"+lightDust[a][3]+")",c.beginPath(),c.arc(lightDust[a][1],
lightDust[a][2],10,0,twoPi),c.closePath(),c.fill();c.save();c.fillStyle="#989898";c.beginPath();c.arc(600,580,30,0,twoPi);c.closePath();c.fill();c.fillStyle="#6c6b6b";c.beginPath();c.arc(600,580,15,0,twoPi);c.closePath();c.fill();c.lineWidth=7;c.font="900 40px monospace";c.textAlign="center";c.fillStyle="#f0c900";c.strokeStyle="black";c.strokeText("PRESS START",600,600);c.fillText("PRESS START",600,600);c.fillStyle="rgba(0,0,0,0.6)";c.beginPath();c.arc(600,-2900,3E3,.05*Math.PI,.95*Math.PI);c.closePath();
c.fill();c.beginPath();c.arc(600,3650,3E3,1.05*Math.PI,1.95*Math.PI);c.closePath();c.fill();c.restore()}menuSelected=0;menuText=["VS. Melee","Target Test","Target Builder"];menuExplanation=["Multiplayer Battles!","Smash ten targets!","Build target test stages!"];menuColours=[238,358,117];menuCurColour=238;stickHold=menuGlobalTimer=menuTimer=menuCycle=0;stickHoldEach=[];
function menuMove(a){var b=!1,d=menuSelected;if(player[a].inputs.a[0]&&!player[a].inputs.a[1])playSfx("menuForward"),0==menuSelected?(gameMode=2,positionPlayersInCSS()):1==menuSelected?(targetPlayer=a,targetPointerPos=[178.5,137],player[a].inputs.a[1]=!0,gameMode=7):2==menuSelected&&(targetBuilder=a,player[a].inputs.a[1]=!0,gameMode=4);else if(!player[a].inputs.b[0])if(.7<player[a].inputs.lStickAxis[0].y)stickHoldEach[a]=!0,0==stickHold?(menuSelected--,b=!0,stickHold++):(stickHold++,0==stickHold%
10&&(menuSelected--,b=!0));else if(-.7>player[a].inputs.lStickAxis[0].y)stickHoldEach[a]=!0,0==stickHold?(menuSelected++,b=!0,stickHold++):(stickHold++,0==stickHold%10&&(menuSelected++,b=!0));else if(stickHoldEach[a]=!1,a==ports-1){a=!1;for(var e=0;e<ports;e++)if(stickHoldEach[e]){a=!0;break}a||(stickHold=0)}b&&(menuTimer=menuCycle=0,playSfx("menuSelect"),-1==menuSelected&&(menuSelected=2),3==menuSelected&&(menuSelected=0),3==d+menuSelected?1==menuSelected?menuColours[menuSelected]=0:menuCurColour=
0:1==d&&(menuCurColour=358,menuColours[1]=358),menuColourOffset=menuColours[menuSelected]-menuCurColour)}menuAngle=menuColourOffset=0;menuRandomBox=[Math.random(),Math.random(),Math.random(),Math.random()];
function drawMainMenu(){menuGlobalTimer++;600<menuGlobalTimer&&(menuGlobalTimer=0);var a=c.createLinearGradient(0,0,1200,750);a.addColorStop(0,"rgba(12, 11, 54, 1)");a.addColorStop(1,"rgba(1, 2, 15, 1)");c.fillStyle=a;c.fillRect(0,0,canvas.width,canvas.height);c.save();c.fillStyle="rgba(18, 16, 85, 0.4)";c.translate(400,400);c.rotate(.7);c.fillRect(-150,800-10*menuGlobalTimer,40,70);c.fillRect(-350,1200-9*menuGlobalTimer,30,170);c.fillRect(-320,1900-10*menuGlobalTimer,40,120);c.fillRect(-420,1E3-
5*menuGlobalTimer,90,210);c.fillRect(-100,1600-6*menuGlobalTimer,95,200);c.fillRect(-80,2100-6*menuGlobalTimer,65,260);c.fillRect(-170,2200-8*menuGlobalTimer,65,80);c.fillRect(-400,2700-10*menuGlobalTimer,30,130);c.fillRect(-300,3E3-7*menuGlobalTimer,40,90);c.fillRect(-50,4400-10*menuGlobalTimer,80,90);c.fillRect(-220,4500-9*menuGlobalTimer,50,180);c.fillRect(-500,4900-10*menuGlobalTimer,20,220);c.fillRect(-480,5100-15*menuGlobalTimer,50,80);c.fillRect(-300,5500-10*menuGlobalTimer,30,90);c.fillRect(-50,
5900-12*menuGlobalTimer,40,110);0==menuGlobalTimer%130&&(menuRandomBox=[Math.random(),Math.random(),Math.random(),Math.random()]);50>menuGlobalTimer%130&&(c.fillStyle="rgba(118, 113, 255,"+Math.max(.5-menuGlobalTimer%130*.01,0)+")",c.fillRect(-450*menuRandomBox[0],800*menuRandomBox[1]-400,50*menuRandomBox[2]+30,60*menuRandomBox[3]+30));c.restore();c.lineWidth=5;c.strokeStyle="rgb(0, 0, 0)";for(a=0;60>a;a++)c.beginPath(),c.moveTo(0,900-15*a),c.lineTo(1200,750-15*a),c.stroke();c.strokeStyle="rgba(3, 31, 219,0.5)";
c.fillStyle="hsla("+menuCurColour+",100%,50%,0.5)";c.save();c.translate(800,400);c.rotate(.7);menuAngle+=.015;menuAngle>=twoPi&&(menuAngle=0);c.beginPath();c.arc(160*Math.cos(menuAngle),400*Math.sin(menuAngle),15,0,twoPi);c.closePath();c.fill();c.scale(.4,1);c.beginPath();c.arc(0,0,400,0,twoPi);c.closePath();c.stroke();c.restore();c.save();c.translate(800,400);c.rotate(.8);c.scale(.4,1);c.beginPath();c.arc(0,0,400,0,twoPi);c.closePath();c.stroke();c.restore();c.lineWidth=3;c.strokeStyle="rgba(255,255,255,0.13)";
c.beginPath();for(a=0;60>a;a++)c.moveTo(0+30*a,0),c.lineTo(0+30*a,750),c.moveTo(0,0+30*a),c.lineTo(1200,0+30*a);c.stroke();menuCurColour!=menuColours[menuSelected]&&(menuCurColour+=.05*menuColourOffset,19==menuTimer&&(menuCurColour=Math.round(menuCurColour)));c.fillStyle="hsla("+menuCurColour+", 60%, 41%,0.75)";c.strokeStyle="hsl("+menuCurColour+", 60%, 41%)";c.beginPath();c.moveTo(300,620);c.lineTo(180,620);c.bezierCurveTo(130,620,130,620,130,570);c.lineTo(130,200);c.bezierCurveTo(130,150,130,150,
180,150);c.lineTo(550,150);c.lineTo(600,80);c.lineTo(1020,80);c.bezierCurveTo(1070,80,1070,80,1070,130);c.lineTo(1070,570);c.bezierCurveTo(1070,620,1070,620,1020,620);c.lineTo(900,620);c.lineTo(900,680);c.lineTo(1050,680);c.bezierCurveTo(1100,680,1100,680,1100,630);c.lineTo(1100,110);c.bezierCurveTo(1100,60,1100,60,1050,60);c.lineTo(590,60);c.lineTo(540,130);c.lineTo(150,130);c.bezierCurveTo(100,130,100,130,100,180);c.lineTo(100,630);c.bezierCurveTo(100,680,100,680,150,680);c.lineTo(300,680);c.closePath();
c.fill();c.stroke();c.beginPath();c.moveTo(590,60);c.lineTo(570,60);c.lineTo(520,130);c.lineTo(540,130);c.closePath();c.fill();c.stroke();c.beginPath();c.moveTo(570,60);c.lineTo(550,60);c.lineTo(500,130);c.lineTo(520,130);c.closePath();c.fill();c.stroke();c.beginPath();c.moveTo(550,60);c.lineTo(530,60);c.lineTo(480,130);c.lineTo(500,130);c.closePath();c.fill();c.stroke();c.fillStyle="rgba(0,0,0,0.7)";c.strokeStyle="white";c.beginPath();c.moveTo(330,610);c.lineTo(870,610);c.bezierCurveTo(890,610,890,
610,890,630);c.lineTo(890,670);c.bezierCurveTo(890,690,890,690,870,690);c.lineTo(330,690);c.bezierCurveTo(310,690,310,690,310,670);c.lineTo(310,630);c.bezierCurveTo(310,610,310,610,330,610);c.closePath();c.fill();c.stroke();c.save();c.textAlign="center";c.fillStyle="rgba(255, 255, 255, 0.8)";c.font="700 35px Arial";c.fillText(menuExplanation[menuSelected],600,660);c.fillStyle="rgba(255, 255, 255, 0.5)";c.font="italic 900 48px Arial";c.fillText("Main Menu",300,120);c.fillStyle="rgba(0, 0, 0, 0.76)";
c.lineWidth=5;c.strokeStyle="rgba(255, 214, 0, 0.95)";for(a=0;3>a;a++)c.beginPath(),c.moveTo(410-80*a,250+100*a),c.lineTo(960-80*a,250+100*a),c.arc(960-80*a,285+100*a,35,1.5*Math.PI,.5*Math.PI),c.lineTo(960-80*a,312+100*a),c.arc(960-80*a,285+100*a,20,.5*Math.PI,1.5*Math.PI,!0),c.lineTo(960-80*a,275+100*a),c.arc(960-80*a,285+100*a,10,1.5*Math.PI,.5*Math.PI),c.lineTo(960-80*a,320+100*a),c.lineTo(405-80*a,320+100*a),c.lineTo(395-80*a,300+100*a),c.closePath(),c.fill(),c.stroke();c.fillStyle="rgb(254, 238, 27)";
for(a=0;3>a;a++){var b=1E3;menuSelected==a&&(b=0);c.beginPath();c.moveTo(410-80*a+b,250+100*a);c.lineTo(960-80*a+b,250+100*a);c.arc(960-80*a+b,285+100*a,35,1.5*Math.PI,.5*Math.PI);c.lineTo(960-80*a+b,312+100*a);c.arc(960-80*a+b,285+100*a,20,.5*Math.PI,1.5*Math.PI,!0);c.lineTo(960-80*a+b,275+100*a);c.arc(960-80*a+b,285+100*a,10,1.5*Math.PI,.5*Math.PI);c.lineTo(960-80*a+b,320+100*a);c.lineTo(405-80*a+b,320+100*a);c.lineTo(395-80*a+b,300+100*a);c.closePath();c.fill();c.stroke();menuSelected==a?(c.save(),
c.fillStyle="black",c.textAlign="center",c.fillText(menuText[a],670-80*a,300+100*a),c.globalAlpha=.7,c.strokeStyle="rgb(255, 247, 144)",c.lineWidth=8,c.beginPath(),c.arc(960-80*a,285+100*a,35,0,twoPi),c.closePath(),c.stroke(),c.lineWidth=15,c.beginPath(),c.arc(960-80*a,285+100*a,13,0,twoPi),c.closePath(),c.stroke(),menuTimer++,60<menuTimer&&(menuTimer=0,menuCycle=1-menuCycle),c.fillStyle="rgb(255, 247, 144)",c.globalAlpha=Math.abs(1-.033*menuTimer),c.beginPath(),c.arc(960-80*a,285+100*a,25,0,twoPi),
c.closePath(),c.fill(),c.lineWidth=3,c.globalAlpha=.5,c.beginPath(),c.arc(960-80*a,285+100*a,Math.max(13,100-2*menuTimer),0,twoPi),c.closePath(),c.stroke(),1==menuCycle&&10<menuTimer&&(c.beginPath(),c.arc(960-80*a,285+100*a,Math.max(13,130-2*menuTimer),0,twoPi),c.closePath(),c.stroke()),c.restore(),c.fillStyle="rgb(254, 238, 27)"):c.fillText(menuText[a],670-80*a,300+100*a)}c.restore()}var marthPic=new Image;marthPic.src="marth.png";var handPoint=new Image;handPoint.src="handpoint.png";
var handOpen=new Image;handOpen.src="handopen.png";var handGrab=new Image;handGrab.src="handgrab.png";choosingTag=-1;handType=[0,0,0,0];handPos=[new Vec2D(140,700),new Vec2D(365,700),new Vec2D(590,700),new Vec2D(815,700)];tokenPos=[new Vec2D(568,268),new Vec2D(608,268),new Vec2D(568,308),new Vec2D(608,308)];chosenChar=[0,0,0,0];tokenGrabbed=[!1,!1,!1,!1];bHold=[0,0,0,0];readyToFight=!1;rtfFlash=25;rtfFlashD=1;
function cssControls(a){if(-1==choosingTag){player[a].inputs.b[0]?(bHold[a]++,60==bHold[a]&&(playSfx("menuBack"),gameMode=1)):bHold[a]=0;handPos[a].x+=12*player[a].inputs.lStickAxis[0].x;handPos[a].y+=12*-player[a].inputs.lStickAxis[0].y;1200<handPos[a].x?handPos[a].x=1200:0>handPos[a].x&&(handPos[a].x=0);750<handPos[a].y?handPos[a].y=750:0>handPos[a].y&&(handPos[a].y=0);if(400>handPos[a].y&&160<handPos[a].y)if(handType[a]=1,player[a].inputs.b[0]&&!player[a].inputs.b[1]&&0==playerType[a]&&(handType[a]=
2,tokenPos[a]=new Vec2D(handPos[a].x,handPos[a].y),tokenGrabbed[a]=!0),tokenGrabbed[a]){if(handType[a]=2,tokenPos[a]=new Vec2D(handPos[a].x,handPos[a].y),player[a].inputs.a[0]&&!player[a].inputs.a[1]||0==!playerType[a])tokenPos[a]=new Vec2D(568+a%2*40,268+(1<a?40:0)),tokenGrabbed[a]=!1,playSfx("marth")}else handPos[a].y>tokenPos[a].y-50&&handPos[a].y<tokenPos[a].y+50&&handPos[a].x>tokenPos[a].x-50&&handPos[a].x<tokenPos[a].x+50&&0==!playerType[a]&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&0==
playerType[a]&&(handType[a]=2,tokenPos[a]=new Vec2D(handPos[a].x,handPos[a].y),tokenGrabbed[a]=!0);else{handType[a]=0;tokenPos[a]=new Vec2D(568+a%2*40,268+(1<a?40:0));tokenGrabbed[a]=!1;for(var b=0;4>b;b++)430<handPos[a].y&&485>handPos[a].y&&handPos[a].x>109+225*b&&handPos[a].x<207+225*b&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(playSfx("menuSelect"),togglePort(b),hasTag[b]=!1)}160>handPos[a].y&&920<handPos[a].x&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(playSfx("menuBack"),gameMode=
1);player[a].inputs.x[0]&&!player[a].inputs.x[1]&&(playSfx("menuSelect"),pPal[a]++,6<pPal[a]&&(pPal[a]=0));player[a].inputs.y[0]&&!player[a].inputs.y[1]&&(playSfx("menuSelect"),pPal[a]--,0>pPal[a]&&(pPal[a]=6));100<handPos[a].y&&160>handPos[a].y&&380<handPos[a].x&&910>handPos[a].x&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(playSfx("menuSelect"),versusMode=1-versusMode);640<handPos[a].y&&680>handPos[a].y&&handPos[a].x>130+225*a&&handPos[a].x<310+225*a&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&
(handPos[a].x<154+225*a?(playSfx("menuSelect"),hasTag[a]=!0,tagText[a]=randomTags[Math.round((randomTags.length-1)*Math.random())]):handPos[a].x>286+225*a?(playSfx("menuSelect"),hasTag[a]=!1):(playSfx("menuSelect"),hasTag[a]=!0,choosingTag=a,c.fillStyle="rgba(0,0,0,0.8)",c.fillRect(0,0,canvas.width,canvas.height),$("#pTagEdit"+a).show().select()))}else choosingTag==a&&player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(playSfx("menuSelect"),tagText[choosingTag]=$("#pTagEdit"+choosingTag).val(),$("#pTagEdit"+
choosingTag).hide(),choosingTag=-1);readyToFight&&-1==choosingTag&&pause[a][0]&&!pause[a][1]&&(playSfx("menuForward"),gameMode=6)}
function drawCSS(){var a=c.createLinearGradient(0,0,1200,700);a.addColorStop(0,"rgb(17, 12, 56)");a.addColorStop(1,"black");c.fillStyle=a;c.fillRect(0,0,canvas.width,canvas.height);c.fillStyle="rgb(85, 96, 107)";c.strokeStyle="rgb(144, 152, 161)";c.save();c.strokeStyle="rgb(120, 127, 161)";c.beginPath();c.moveTo(-10,200);c.lineTo(290,200);c.arc(290,225,25,1.5*Math.PI,.5*Math.PI);c.lineTo(-10,250);c.closePath();c.stroke();c.fillStyle="rgb(29, 144, 61)";c.beginPath();c.arc(145,225,20,0,twoPi);c.closePath();
c.fill();c.fillStyle="rgb(120, 127, 161)";c.fillText("Push     to join",37,235);c.fillStyle="rgb(17, 71, 32)";c.fillText("A",133,235);c.restore();c.save();c.lineWidth=3;c.translate(canvas.width/2,canvas.height/2+20);for(var b=0;2>b;b++)c.rotate(b*Math.PI),c.beginPath(),c.moveTo(-10-canvas.width/2,-250),c.lineTo(-300,-250),c.bezierCurveTo(-240,-250,-240,-330,-180,-330),c.lineTo(10+canvas.width/2,-330),c.lineTo(10+canvas.width/2,-30-canvas.height/2),c.lineTo(-10-canvas.width/2,-30-canvas.height/2),
c.closePath(),c.fill(),c.stroke();c.restore();c.lineWidth=3;c.beginPath();c.moveTo(410,80);c.lineTo(950,80);c.lineTo(955,105);c.lineTo(946,130);c.lineTo(406,130);c.lineTo(400,105);c.closePath();c.stroke();c.lineWidth=5;c.beginPath();c.moveTo(412,81);c.lineTo(422,81);c.lineTo(412,105);c.lineTo(418,129);c.lineTo(408,129);c.lineTo(402,105);c.closePath();c.fill();c.stroke();c.beginPath();c.moveTo(938,81);c.lineTo(948,81);c.lineTo(953,105);c.lineTo(944,129);c.lineTo(934,129);c.lineTo(943,105);c.closePath();
c.fill();c.stroke();c.lineWidth=3;c.fillStyle="black";c.font="italic 900 50px Arial";c.save();c.scale(1,1.9);c.fillText("MELEE",50,65);c.restore();c.beginPath();c.arc(305,85,30,0,twoPi);c.closePath();c.fill();c.stroke();c.fillStyle="rgb(144, 152, 161)";c.font="700 32px Arial";c.fillText("VS",284,98);c.fillStyle="rgb(219, 219, 219)";c.save();c.scale(1.25,1);versusMode?c.fillText("An endless KO fest!",393,117):c.fillText("4-man survival test!",390,117);c.restore();c.fillStyle="rgba(0,0,0,0.65)";c.beginPath();
c.moveTo(1100,0);c.lineTo(1E3,110);c.lineTo(1020,125);c.lineTo(1200,125);c.lineTo(1200,0);c.closePath();c.fill();c.fillStyle="rgb(255, 222, 0)";c.beginPath();c.moveTo(1100,0);c.lineTo(1E3,110);c.lineTo(1020,125);c.lineTo(1200,125);c.lineTo(1200,119);c.lineTo(1015,119);c.lineTo(1002,110);c.lineTo(1102,0);c.closePath();c.fill();c.font="700 27px Arial";c.fillText("BACK",1035,112);c.fillStyle="rgb(194, 24, 8)";c.beginPath();c.moveTo(1025,75);c.lineTo(992,110);c.lineTo(1010,125);c.lineTo(972,110);c.closePath();
c.fill();a=c.createLinearGradient(0,250,0,350);a.addColorStop(0,"rgb(41, 47, 68)");a.addColorStop(1,"rgb(85, 95, 128)");c.lineWidth=2;c.fillStyle=a;c.beginPath();c.moveTo(545,265);c.bezierCurveTo(545,245,545,245,565,245);c.lineTo(610,245);c.bezierCurveTo(630,245,630,245,630,265);c.lineTo(630,310);c.bezierCurveTo(630,330,630,330,610,330);c.lineTo(565,330);c.bezierCurveTo(545,330,545,330,545,310);c.closePath();c.fill();c.stroke();c.fillStyle="black";c.beginPath();c.moveTo(628,305);c.lineTo(628,310);
c.bezierCurveTo(628,328,628,328,610,328);c.lineTo(565,328);c.bezierCurveTo(547,328,547,328,547,310);c.lineTo(547,305);c.closePath();c.fill();c.fillStyle="rgb(180, 180, 180)";c.font="700 18px Arial";c.fillText("MARTH",555,323);c.drawImage(marthPic,547,247,81,58);c.fillStyle="rgb(49, 52, 56)";for(b=0;4>b;b++)c.fillRect(145+225*b,430,210,280),c.strokeRect(145+225*b,430,210,280);c.fillStyle="rgb(55, 58, 62)";c.strokeStyle="rgb(72, 77, 85)";for(b=0;4>b;b++)c.fillRect(158+225*b,440,184,260),c.strokeRect(158+
225*b,440,184,260);c.fillStyle="rgba(255,255,255,0.1)";for(b=0;4>b;b++)c.fillRect(158+225*b,630,184,50);c.strokeStyle="rgba(0,0,0,0.2)";c.fillStyle="rgba(0,0,0,0.2)";c.lineWidth=15;for(b=0;4>b;b++)c.beginPath(),c.moveTo(150+225*b,435),c.lineTo(350+225*b,705),c.closePath(),c.stroke(),c.beginPath(),c.arc(250+225*b,570,60,0,twoPi),c.closePath(),c.stroke(),c.beginPath(),c.moveTo(150+225*b,570),c.lineTo(350+225*b,570),c.closePath(),c.stroke();c.lineWidth=3;for(b=0;4>b;b++)for(a=0;7>a;a++)c.beginPath(),
c.arc(165+225*b+30*a,450,11,0,twoPi),c.closePath(),c.fill(),c.beginPath(),c.arc(165+225*b+30*a,690,10,0,twoPi),c.closePath(),c.stroke(),3==a&&c.fill();for(b=0;4>b;b++)if(-1<playerType[b]){if(0==playerType[b])switch(b){case 0:c.fillStyle="rgb(218, 51, 51)";break;case 1:c.fillStyle="rgb(51, 53, 218)";break;case 2:c.fillStyle="rgb(226, 218, 34)";break;case 3:c.fillStyle="rgb(44, 217, 29)"}else c.fillStyle="rgb(91, 91, 91)";c.fillRect(147+225*b,432,206,276);c.fillStyle="rgba(0,0,0,0.5)";c.beginPath();
c.moveTo(152+225*b,465);c.lineTo(210+225*b,465);c.lineTo(230+225*b,450);c.lineTo(318+225*b,450);c.bezierCurveTo(338+225*b,450,338+225*b,450,338+225*b,470);c.lineTo(338+225*b,708);c.lineTo(152+225*b,708);c.closePath();c.fill();c.save();c.fillStyle="rgba(0, 0, 0, 0.3)";c.translate(250+225*b,615);c.scale(1,.3);c.beginPath();c.arc(0,0,50,0,twoPi);c.closePath();c.fill();c.restore();c.fillStyle="black";c.strokeStyle="rgb(102, 102, 102)";c.fillRect(152+225*b,640,196,60);c.strokeRect(152+225*b,640,196,60);
c.save();c.fillStyle="rgb(84, 84, 84)";c.font="italic 900 45px Arial";c.scale(1.75,1);var d="P"+(b+1);1==playerType[b]&&(d="CP");c.fillText(d,87+225*b/1.75,690);c.restore();c.fillRect(160+225*b,620,180,40);c.strokeRect(160+225*b,620,180,40);c.font="900 24px Arial";0==playerType[b]&&(c.fillStyle="rgb(42, 42, 42)",c.fillRect(162+225*b,622,22,37),c.fillRect(316+225*b,622,22,37),c.fillStyle="rgb(83, 83, 83)",c.fillText("?",166+225*b,648),c.fillText("x",319+225*b,647));c.font="500 28px Arial";c.fillStyle=
"white";d="Marth";hasTag[b]&&(d=tagText[b]);c.textAlign="center";c.fillText(d,250+225*b,650);c.textAlign="start"}c.fillStyle="rgb(82, 81, 81)";for(b=0;4>b;b++){c.fillStyle="rgb(82, 81, 81)";switch(playerType[b]){case 0:c.fillStyle="rgb(201, 178, 20)";break;case 1:c.fillStyle="rgb(161, 161, 161)";break;default:c.fillStyle="rgb(82, 81, 81)"}c.beginPath();c.moveTo(139+225*b,420);c.lineTo(220+225*b,420);c.lineTo(237+225*b,432);c.lineTo(215+225*b,455);c.lineTo(142+225*b,455);c.lineTo(139+225*b,452);c.closePath();
c.fill()}c.fillStyle="rgba(0, 0, 0,0.7)";c.strokeStyle="rgba(0, 0, 0,0.7)";c.lineWidth=4;for(b=0;4>b;b++)c.beginPath(),c.moveTo(160+225*b,424),c.lineTo(215+225*b,424),c.lineTo(228+225*b,432),c.lineTo(210+225*b,451),c.lineTo(160+225*b,451),c.closePath(),c.fill(),c.beginPath(),c.moveTo(139+225*b,420),c.lineTo(151+225*b,424),c.lineTo(151+225*b,451),c.lineTo(140+225*b,451),c.stroke();c.fillStyle="rgb(82, 81, 81)";c.font="700 22px Arial";for(b=0;4>b;b++){c.fillStyle="rgb(82, 81, 81)";d="N/A";switch(playerType[b]){case 0:d=
"HMN";c.fillStyle="rgb(201, 178, 20)";break;case 1:d="CPU",c.fillStyle="rgb(161, 161, 161)"}c.fillText(d,163+225*b,445)}for(b=0;4>b;b++)if(-1<playerType[b]){a=Math.floor(player[b].timer);0==a&&(a=1);var d=player[b].phys.face,e=animations[charSelect[b]][aS[player[b].actionState].name][a-1];switch(player[b].actionState){case 15:case 17:case 20:case 25:case 61:case 72:case 94:e=animations[charSelect[b]][aS[player[b].actionState].name][0]}aS[player[b].actionState].reverseModel?d*=-1:4==player[b].actionState?
5<a&&(d*=-1):6==player[b].actionState?18<a&&(d*=-1):34==player[b].actionState&&29<a&&(d*=-1);drawArrayPath(palettes[pPal[b]][0],d,6.75*player[b].phys.pos.x+600,-4.5*player[b].phys.pos.y+480,e,.3,.3);player[b].phys.shielding&&(c.fillStyle=palettes[pPal[b]][2]+.6*player[b].phys.shieldAnalog+")",c.beginPath(),c.arc(6.75*player[b].phys.shieldPositionReal.x+600,-4.5*player[b].phys.shieldPositionReal.y+460,6.75*player[b].phys.shieldSize,twoPi,0),c.fill())}c.font="900 31px Arial";c.lineWidth=2;for(b=0;4>
b;b++)if(-1<playerType[b]){a=c.createLinearGradient(tokenPos[b].x-100,tokenPos[b].y,tokenPos[b].x+50,tokenPos[b].y);a.addColorStop(0,"rgb(255, 255, 255)");d="";switch(playerType[b]){case 0:d="P"+(b+1);switch(b){case 0:a.addColorStop(1,"rgb(233, 57, 57)");break;case 1:a.addColorStop(1,"rgb(62, 130, 233)");break;case 2:a.addColorStop(1,"rgb(255, 253, 47)");break;case 3:a.addColorStop(1,"rgb(36, 242, 45)")}break;case 1:d="CP",a.addColorStop(1,"rgb(135, 135, 135)")}c.fillStyle="rgba(0,0,0,0.4)";c.beginPath();
c.arc(tokenPos[b].x,tokenPos[b].y,34,0,twoPi);c.closePath();c.fill();c.fillStyle=a;c.beginPath();c.arc(tokenPos[b].x,tokenPos[b].y,30,0,twoPi);c.closePath();c.fill();c.fillStyle="rgba(0,0,0,0.4)";c.beginPath(tokenPos[b].y);c.arc(tokenPos[b].x,tokenPos[b].y,26,1.2*Math.PI,.4*Math.PI);c.arc(tokenPos[b].x-3,tokenPos[b].y,23,.5*Math.PI,1.2*Math.PI,!0);c.closePath();c.fill();c.strokeStyle="rgb(57, 57, 57)";c.fillStyle="rgb(207, 207, 207)";c.fillText(d,tokenPos[b].x-22,tokenPos[b].y+13);c.strokeText(d,
tokenPos[b].x-22,tokenPos[b].y+13)}for(b=0;b<ports;b++){switch(handType[b]){case 0:c.drawImage(handPoint,handPos[b].x-40,handPos[b].y-30,101,133);break;case 1:c.drawImage(handOpen,handPos[b].x-40,handPos[b].y-30,101,133);break;case 2:c.drawImage(handGrab,handPos[b].x-40,handPos[b].y-30,101,133)}switch(b){case 0:c.fillStyle="rgb(233, 57, 57)";break;case 1:c.fillStyle="rgb(62, 130, 233)";break;case 2:c.fillStyle="rgb(255, 253, 47)";break;case 3:c.fillStyle="rgb(36, 242, 45)"}c.fillText("P"+(b+1),handPos[b].x-
15,handPos[b].y+60);c.strokeText("P"+(b+1),handPos[b].x-15,handPos[b].y+60)}for(a=b=0;4>a;a++)if(-1<playerType[a])if(b++,2<=b){readyToFight=!0;break}else readyToFight=!1;readyToFight&&(c.save(),c.fillStyle="rgba(223, 31, 31, 0.8)",c.beginPath(),c.moveTo(50,300),c.bezierCurveTo(450,270,750,270,1150,300),c.bezierCurveTo(750,280,450,280,50,300),c.closePath(),c.fill(),c.beginPath(),c.moveTo(50,370),c.bezierCurveTo(450,350,750,350,1150,370),c.bezierCurveTo(750,360,900,365,900,365),c.bezierCurveTo(850,
365,830,380,800,380),c.lineTo(400,380),c.bezierCurveTo(370,380,350,365,300,365),c.bezierCurveTo(300,360,450,370,0,370),c.closePath(),c.fill(),c.fillStyle="rgba(0,0,0,0.5)",c.beginPath(),c.moveTo(50,300),c.bezierCurveTo(450,280,750,280,1150,300),c.arc(1150,335,35,1.5*Math.PI,.5*Math.PI,!0),c.bezierCurveTo(750,350,450,350,50,370),c.arc(50,335,35,.5*Math.PI,1.5*Math.PI,!0),c.closePath(),c.fill(),c.scale(1.4,1),rtfFlash+=.5*rtfFlashD,25>rtfFlash&&(rtfFlashD=1),50<rtfFlash&&(rtfFlashD=-1),c.fillStyle=
"hsl(52, 85%, "+rtfFlash+"%)",c.font="italic 600 65px Arial",c.rotate(-.03),c.fillText("READY",120,353),c.rotate(.03),c.fillText("TO",390,342),c.rotate(.03),c.fillText("FIGHT",520,329),c.rotate(-.03),c.fillStyle="rgb(193, 193, 193)",c.font="900 15px Arial",c.scale(2.3/1.4,1),c.fillText("PRESS START",205,373),c.restore());-1<choosingTag&&(c.fillStyle="rgba(0,0,0,0.8)",c.fillRect(0,0,canvas.width,canvas.height),c.fillStyle="white",c.textAlign="center",c.fillText("Type tag now",250+225*choosingTag,570),
c.fillText("Press A to finish",250+225*choosingTag,600),c.textAlign="start")}crossHairPos=new Vec2D(0,0);targetTool=targetBuilder=0;showingCode=!1;toolInfoTimer=0;toolInfo="Box Platform Ledge Target Move Delete".split(" ");holdingA=!1;drawingBox=new Box2D([0,0],[0,0]);drawingPlatform=[new Vec2D(0,0),new Vec2D(0,0)];tooSmallTimer=0;tooSmallPos=new Vec2D(0,0);
function createTargetCode(){var a;a=""+(stageTemp.startingPoint.x+","+stageTemp.startingPoint.y+"~");for(var b=0;b<stageTemp.box.length;b++)a+=stageTemp.box[b].min.x+","+stageTemp.box[b].min.y+","+stageTemp.box[b].max.x+","+stageTemp.box[b].max.y,b!=stageTemp.box.length-1&&(a+="#");a+="~";for(b=0;b<stageTemp.platform.length;b++)a+=stageTemp.platform[b][0].x+","+stageTemp.platform[b][1].x+","+stageTemp.platform[b][0].y,b!=stageTemp.platform.length-1&&(a+="#");a+="~";for(b=0;b<stageTemp.ledge.length;b++)a+=
stageTemp.ledge[b][0]+","+stageTemp.ledge[b][1],b!=stageTemp.ledge.length-1&&(a+="#");a+="~";for(b=0;b<stageTemp.target.length;b++)a+=stageTemp.target[b].x+","+stageTemp.target[b].y,b!=stageTemp.target.length-1&&(a+="#");return a+="~"+stageTemp.scale}
stageTemp={box:[],platform:[],ground:[],ceiling:[],wallL:[],wallR:[],target:[],startingPoint:new Vec2D(0,0),ledge:[],blastzone:new Box2D([-250,-250],[250,250]),scale:3,offset:[600,375],draw:{box:[],platform:[],ground:[],ceiling:[],wallL:[],wallR:[],target:[],startingPoint:new Vec2D(600,375),ledge:[]}};ledgeHoverItem=hoverItem=grabbedItem=0;builderPaused=!1;builderPauseSelected=0;undoList=[];
function undo(){var a=undoList.length-1;0<=a&&(a=undoList[a],stageTemp[a].pop(),stageTemp.draw[a].pop(),"box"==a&&(stageTemp.ground.pop(),stageTemp.ceiling.pop(),stageTemp.wallL.pop(),stageTemp.wallR.pop(),stageTemp.draw.ground.pop(),stageTemp.draw.ceiling.pop(),stageTemp.draw.wallL.pop(),stageTemp.draw.wallR.pop()),undoList.pop())}
function createStageObject(){var a;a="{startingPoint:new Vec2D("+(stageTemp.startingPoint.x+","+stageTemp.startingPoint.y+"),box:[");for(var b=0;b<stageTemp.box.length;b++)a+="new Box2D(["+stageTemp.box[b].min.x+","+stageTemp.box[b].min.y+"],["+stageTemp.box[b].max.x+","+stageTemp.box[b].max.y+"])",b!=stageTemp.box.length-1&&(a+=",");a+="],ground:[";for(b=0;b<stageTemp.ground.length;b++)a+="[new Vec2D("+stageTemp.ground[b][0].x+","+stageTemp.ground[b][0].y+"),new Vec2D("+stageTemp.ground[b][1].x+
","+stageTemp.ground[b][1].y+")]",b!=stageTemp.ground.length-1&&(a+=",");a+="],ceiling:[";for(b=0;b<stageTemp.ceiling.length;b++)a+="[new Vec2D("+stageTemp.ceiling[b][0].x+","+stageTemp.ceiling[b][0].y+"),new Vec2D("+stageTemp.ceiling[b][1].x+","+stageTemp.ceiling[b][1].y+")]",b!=stageTemp.ceiling.length-1&&(a+=",");a+="],wallL:[";for(b=0;b<stageTemp.wallL.length;b++)a+="[new Vec2D("+stageTemp.wallL[b][0].x+","+stageTemp.wallL[b][0].y+"),new Vec2D("+stageTemp.wallL[b][1].x+","+stageTemp.wallL[b][1].y+
")]",b!=stageTemp.wallL.length-1&&(a+=",");a+="],wallR:[";for(b=0;b<stageTemp.wallR.length;b++)a+="[new Vec2D("+stageTemp.wallR[b][0].x+","+stageTemp.wallR[b][0].y+"),new Vec2D("+stageTemp.wallR[b][1].x+","+stageTemp.wallR[b][1].y+")]",b!=stageTemp.wallR.length-1&&(a+=",");a+="],platform:[";for(b=0;b<stageTemp.platform.length;b++)a+="[new Vec2D("+stageTemp.platform[b][0].x+","+stageTemp.platform[b][0].y+"),new Vec2D("+stageTemp.platform[b][1].x+","+stageTemp.platform[b][1].y+")]",b!=stageTemp.platform.length-
1&&(a+=",");a+="],ledge:[";for(b=0;b<stageTemp.ledge.length;b++)a+="["+stageTemp.ledge[b][0]+","+stageTemp.ledge[b][1]+"]",b!=stageTemp.ledge.length-1&&(a+=",");a+="],target:[";for(b=0;b<stageTemp.target.length;b++)a+="new Vec2D("+stageTemp.target[b].x+","+stageTemp.target[b].y+")",b!=stageTemp.target.length-1&&(a+=",");return a+="],scale:"+stageTemp.scale+",blastzone:new Box2D([-250,-250],[250,250]),offset:[600,375]}"}
function targetBuilderControls(a){if(showingCode)player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(showingCode=!1,$("#customStageContainer").hide(),playSfx("menuForward"));else if(builderPaused)if(.7<=player[a].inputs.lStickAxis[0].y&&.7>player[a].inputs.lStickAxis[1].y?(builderPauseSelected--,0>builderPauseSelected&&(builderPauseSelected=2),playSfx("menuSelect")):-.7>=player[a].inputs.lStickAxis[0].y&&-.7<player[a].inputs.lStickAxis[1].y&&(builderPauseSelected++,2<builderPauseSelected&&(builderPauseSelected=
0),playSfx("menuSelect")),player[a].inputs.a[0]&&!player[a].inputs.a[1])switch(builderPauseSelected){case 0:playSfx("menuForward");startTargetGame(targetBuilder,!0);break;case 1:playSfx("menuForward");showingCode=!0;b=createStageObject();$("#customStageContainer").show();$("#cStageEdit").select().val(b);break;case 2:playSfx("menuForward"),gameMode=1}else player[a].inputs.s[0]&&!player[a].inputs.s[1]&&(builderPaused=!1,builderPauseSelected=0,playSfx("menuBack"));else{ledgeHoverItem=hoverItem=0;if(player[a].inputs.z[0]&&
!player[a].inputs.z[1]){var b=createStageObject();console.log(b)}b=player[a].inputs.y[0]||player[a].inputs.x[0]?1:5;crossHairPos.x+=player[a].inputs.lStickAxis[0].x*b;crossHairPos.y+=player[a].inputs.lStickAxis[0].y*b;b=new Vec2D(3*crossHairPos.x+600,-3*crossHairPos.y+375);200<crossHairPos.x&&(crossHairPos.x=200,b.x=1200);-200>crossHairPos.x&&(crossHairPos.x=-200,b.x=0);125<crossHairPos.y&&(crossHairPos.y=125,b.y=0);-125>crossHairPos.y&&(crossHairPos.y=-125,b.y=750);player[a].inputs.l[0]&&!player[a].inputs.l[1]?
(playSfx("menuSelect"),targetTool--,-1==targetTool&&(targetTool=5),toolInfoTimer=120):player[a].inputs.r[0]&&!player[a].inputs.r[1]&&(playSfx("menuSelect"),targetTool++,6==targetTool&&(targetTool=0),toolInfoTimer=120);switch(targetTool){case 0:holdingA?player[a].inputs.a[0]?drawingBox.max=new Vec2D(b.x,b.y):(drawingBox.max=new Vec2D(b.x,b.y),11.19<=Math.abs(drawingBox.min.x-drawingBox.max.x)&&Math.abs(drawingBox.min.y-drawingBox.max.y)>=2.8*3?(stageTemp.draw.box.push(new Box2D([Math.min(drawingBox.min.x,
drawingBox.max.x),Math.max(drawingBox.min.y,drawingBox.max.y)],[Math.max(drawingBox.min.x,drawingBox.max.x),Math.min(drawingBox.min.y,drawingBox.max.y)])),b=stageTemp.draw.box[stageTemp.draw.box.length-1],stageTemp.draw.ground.push([new Vec2D(b.min.x,b.max.y),new Vec2D(b.max.x,b.max.y)]),stageTemp.draw.ceiling.push([new Vec2D(b.min.x,b.min.y),new Vec2D(b.max.x,b.min.y)]),stageTemp.draw.wallL.push([new Vec2D(b.min.x,b.max.y),new Vec2D(b.min.x,b.min.y)]),stageTemp.draw.wallR.push([new Vec2D(b.max.x,
b.max.y),new Vec2D(b.max.x,b.min.y)]),stageTemp.box.push(new Box2D([(Math.min(drawingBox.min.x,drawingBox.max.x)-600)/3,(Math.max(drawingBox.min.y,drawingBox.max.y)-375)/-3],[(Math.max(drawingBox.min.x,drawingBox.max.x)-600)/3,(Math.min(drawingBox.min.y,drawingBox.max.y)-375)/-3])),b=stageTemp.box[stageTemp.box.length-1],stageTemp.ground.push([new Vec2D(b.min.x,b.max.y),new Vec2D(b.max.x,b.max.y)]),stageTemp.ceiling.push([new Vec2D(b.min.x,b.min.y),new Vec2D(b.max.x,b.min.y)]),stageTemp.wallL.push([new Vec2D(b.min.x,
b.max.y),new Vec2D(b.min.x,b.min.y)]),stageTemp.wallR.push([new Vec2D(b.max.x,b.max.y),new Vec2D(b.max.x,b.min.y)]),undoList.push("box")):(tooSmallTimer=60,tooSmallPos=new Vec2D(b.x,b.y)),holdingA=!1,playSfx("blunthit")):player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(20>stageTemp.box.length?(drawingBox.min=new Vec2D(b.x,b.y),drawingBox.max=new Vec2D(b.x,b.y),holdingA=!0):playSfx("deny"));break;case 1:holdingA?player[a].inputs.a[0]?drawingPlatform[1]=new Vec2D(b.x,drawingPlatform[0].y):(drawingPlatform[1]=
new Vec2D(b.x,drawingPlatform[0].y),console.log(drawingPlatform),10<=Math.abs(drawingPlatform[0].x-drawingPlatform[1].x)?(stageTemp.draw.platform.push([new Vec2D(Math.min(drawingPlatform[0].x,drawingPlatform[1].x),drawingPlatform[0].y),new Vec2D(Math.max(drawingPlatform[0].x,drawingPlatform[1].x),drawingPlatform[1].y)]),stageTemp.platform.push([new Vec2D((Math.min(drawingPlatform[0].x,drawingPlatform[1].x)-600)/3,(drawingPlatform[0].y-375)/-3),new Vec2D((Math.max(drawingPlatform[0].x,drawingPlatform[1].x)-
600)/3,(drawingPlatform[1].y-375)/-3)]),stageTemp.platform[stageTemp.platform.length-1][0].x>stageTemp.platform[stageTemp.platform.length-1][1].x&&console.log("wtf"),undoList.push("platform")):(tooSmallTimer=60,tooSmallPos=new Vec2D(b.x,b.y)),holdingA=!1,playSfx("blunthit")):player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(20>stageTemp.platform.length?(drawingPlatform[0]=new Vec2D(b.x,b.y),drawingPlatform[1]=new Vec2D(b.x,drawingPlatform[0].y),holdingA=!0):playSfx("deny"));break;case 2:for(var d=ledgeHoverItem=
0;d<stageTemp.box.length;d++)if(b.x>=stageTemp.draw.box[d].min.x-5&&b.x<=stageTemp.draw.box[d].max.x+5&&b.y>=stageTemp.draw.box[d].max.y-5&&b.y<=stageTemp.draw.box[d].min.y+5){ledgeHoverItem=["box",d];break}if(0!=ledgeHoverItem&&(Math.abs(b.x-stageTemp.draw.box[d].min.x)<Math.abs(b.x-stageTemp.draw.box[d].max.x)?ledgeHoverItem.push(0):ledgeHoverItem.push(1),player[a].inputs.a[0]&&!player[a].inputs.a[1])){d=!1;for(b=0;b<stageTemp.ledge.length;b++)if(stageTemp.ledge[b][0]==ledgeHoverItem[1]&&stageTemp.ledge[b][1]==
ledgeHoverItem[2]){stageTemp.ledge.splice(b,1);d=!0;break}d||(stageTemp.ledge.push([ledgeHoverItem[1],ledgeHoverItem[2]]),undoList.push("ledge"));playSfx("blunthit")}break;case 3:player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(10>stageTemp.target.length?(stageTemp.draw.target.push(new Vec2D(b.x,b.y)),stageTemp.target.push(new Vec2D(crossHairPos.x,crossHairPos.y)),undoList.push("target"),playSfx("blunthit")):playSfx("deny"));break;case 4:0==grabbedItem?30>=Math.abs(b.x-stageTemp.draw.startingPoint.x)&&
30>=Math.abs(b.y-stageTemp.draw.startingPoint.y)?hoverItem=["startingPoint",0]:findTarget(b)||findPlatform(b)||findBox(b)||(hoverItem=0):hoverItem=grabbedItem;0!=hoverItem&&(holdingA?player[a].inputs.a[0]?centerItem(hoverItem,b):(centerItem(hoverItem,b),holdingA=!1,grabbedItem=0,playSfx("blunthit")):player[a].inputs.a[0]&&!player[a].inputs.a[1]&&(centerItem(hoverItem,b),grabbedItem=hoverItem,holdingA=!0));break;case 5:if(30>=Math.abs(b.x-stageTemp.draw.startingPoint.x)&&30>=Math.abs(b.y-stageTemp.draw.startingPoint.y)?
hoverItem=["startingPoint",0]:findTarget(b)||findPlatform(b)||findBox(b)||(hoverItem=0),0!=hoverItem&&player[a].inputs.a[0]&&!player[a].inputs.a[1]){switch(hoverItem[0]){case "startingPoint":playSfx("deny");break;case "platform":case "target":stageTemp.draw[hoverItem[0]].splice(hoverItem[1],1);stageTemp[hoverItem[0]].splice(hoverItem[1],1);playSfx("menuBack");break;case "box":d=[];for(b=0;b<stageTemp.ledge.length;b++)stageTemp.ledge[b][0]==hoverItem[1]&&d.push(b);for(b=0;b<d.length;b++)stageTemp.ledge.splice(d[b]-
b,1);for(b=0;b<stageTemp.ledge.length;b++)stageTemp.ledge[b][0]>hoverItem[1]&&stageTemp.ledge[b][0]--;stageTemp.draw[hoverItem[0]].splice(hoverItem[1],1);stageTemp[hoverItem[0]].splice(hoverItem[1],1);stageTemp.draw.ground.splice(hoverItem[1],1);stageTemp.ground.splice(hoverItem[1],1);stageTemp.draw.wallL.splice(hoverItem[1],1);stageTemp.wallL.splice(hoverItem[1],1);stageTemp.draw.wallR.splice(hoverItem[1],1);stageTemp.wallR.splice(hoverItem[1],1);stageTemp.draw.ceiling.splice(hoverItem[1],1);stageTemp.ceiling.splice(hoverItem[1],
1);playSfx("menuBack")}hoverItem=0}}player[a].inputs.s[0]&&!player[a].inputs.s[1]&&(builderPaused=!0,playSfx("pause"))}}
function drawTargetStage(){for(var a=0;a<stageTemp.draw.box.length;a++){var b=stageTemp.draw.box[a];c.fillRect(b.min.x,b.max.y,Math.abs(b.max.x-b.min.x),Math.abs(b.max.y-b.min.y))}for(a=0;a<stageTemp.draw.target.length;a++)for(var b=stageTemp.draw.target[a].x,d=stageTemp.draw.target[a].y,e=0;5>e;e++)c.fillStyle="target"==hoverItem[0]&&hoverItem[1]==a?e%2?"white":"rgb(241, 111, 111)":e%2?"white":"red",c.beginPath(),c.arc(b,d,25-5*e,0,twoPi),c.closePath(),c.fill();c.strokeStyle="#db80cc";c.lineWidth=
1;for(a=0;a<stageTemp.draw.ground.length;a++)b=stageTemp.draw.ground[a],c.beginPath(),c.moveTo(b[0].x,b[0].y),c.lineTo(b[1].x,b[1].y),c.closePath(),c.stroke();c.strokeStyle="#4794c6";for(a=0;a<stageTemp.draw.platform.length;a++)b=stageTemp.draw.platform[a],c.beginPath(),c.moveTo(b[0].x,b[0].y),c.lineTo(b[1].x,b[1].y),c.closePath(),c.stroke();c.strokeStyle="#47c648";for(a=0;a<stageTemp.draw.wallL.length;a++)b=stageTemp.draw.wallL[a],c.beginPath(),c.moveTo(b[0].x,b[0].y),c.lineTo(b[1].x,b[1].y),c.closePath(),
c.stroke();c.strokeStyle="#9867de";for(a=0;a<stageTemp.draw.wallR.length;a++)b=stageTemp.draw.wallR[a],c.beginPath(),c.moveTo(b[0].x,b[0].y),c.lineTo(b[1].x,b[1].y),c.closePath(),c.stroke();c.strokeStyle="#f04c4c";for(a=0;a<stageTemp.draw.ceiling.length;a++)b=stageTemp.draw.ceiling[a],c.beginPath(),c.moveTo(b[0].x,b[0].y),c.lineTo(b[1].x,b[1].y),c.closePath(),c.stroke();c.strokeStyle="#e7a44c";c.lineWidth=1;for(a=0;a<stageTemp.ledge.length;a++)b=stageTemp.ledge[a],c.beginPath(),b[1]?(c.moveTo(stageTemp.draw.box[b[0]].max.x,
stageTemp.draw.box[b[0]].max.y+Math.min(30,(stageTemp.draw.box[b[0]].min.y-stageTemp.draw.box[b[0]].max.y)/2)),c.lineTo(stageTemp.draw.box[b[0]].max.x,stageTemp.draw.box[b[0]].max.y),c.lineTo(stageTemp.draw.box[b[0]].max.x-Math.min(30,(stageTemp.draw.box[b[0]].max.x-stageTemp.draw.box[b[0]].min.x)/2),stageTemp.draw.box[b[0]].max.y)):(c.moveTo(stageTemp.draw.box[b[0]].min.x,stageTemp.draw.box[b[0]].max.y+Math.min(30,(stageTemp.draw.box[b[0]].min.y-stageTemp.draw.box[b[0]].max.y)/2)),c.lineTo(stageTemp.draw.box[b[0]].min.x,
stageTemp.draw.box[b[0]].max.y),c.lineTo(stageTemp.draw.box[b[0]].min.x+Math.min(30,(stageTemp.draw.box[b[0]].max.x-stageTemp.draw.box[b[0]].min.x)/2),stageTemp.draw.box[b[0]].max.y)),c.closePath(),c.stroke()}
function renderTargetBuilder(){drawBackground();drawTargetStage();if(holdingA)switch(targetTool){case 0:c.strokeStyle="white";c.lineWidth=4;c.strokeRect(Math.min(drawingBox.min.x,drawingBox.max.x),Math.min(drawingBox.min.y,drawingBox.max.y),Math.abs(drawingBox.min.x-drawingBox.max.x),Math.abs(drawingBox.min.y-drawingBox.max.y));break;case 1:c.strokeStyle="rgb(79, 244, 255)",c.lineWidth=4,c.beginPath(),c.moveTo(drawingPlatform[0].x,drawingPlatform[0].y),c.lineTo(drawingPlatform[1].x,drawingPlatform[1].y),
c.stroke(),c.closePath()}c.textAlign="center";c.lineWidth=2;var a=["rgb(0, 0, 0)","rgb(110, 255, 66)"];"startingPoint"==hoverItem[0]&&(a=["rgb(82, 82, 82)","rgb(171, 255, 145)"]);c.fillStyle=a[0];c.fillRect(stageTemp.draw.startingPoint.x-4,stageTemp.draw.startingPoint.y-12,8,24);c.fillRect(stageTemp.draw.startingPoint.x-12,stageTemp.draw.startingPoint.y-4,24,8);c.fillRect(stageTemp.draw.startingPoint.x-27,stageTemp.draw.startingPoint.y-23,54,13);c.fillStyle=a[1];c.fillRect(stageTemp.draw.startingPoint.x-
2,stageTemp.draw.startingPoint.y-10,4,20);c.fillRect(stageTemp.draw.startingPoint.x-10,stageTemp.draw.startingPoint.y-2,20,4);c.font="900 14px Arial";c.fillText("START",stageTemp.draw.startingPoint.x,stageTemp.draw.startingPoint.y-12);a=hoverItem[1];if("box"==hoverItem[0]){c.strokeStyle="#e9bee2";c.lineWidth=3;var b=stageTemp.draw.ground[a];c.beginPath();c.moveTo(b[0].x,b[0].y);c.lineTo(b[1].x,b[1].y);c.closePath();c.stroke();c.strokeStyle="#86df87";b=stageTemp.draw.wallL[a];c.beginPath();c.moveTo(b[0].x,
b[0].y);c.lineTo(b[1].x,b[1].y);c.closePath();c.stroke();c.strokeStyle="#b99fde";b=stageTemp.draw.wallR[a];c.beginPath();c.moveTo(b[0].x,b[0].y);c.lineTo(b[1].x,b[1].y);c.closePath();c.stroke();c.strokeStyle="#fa9292";b=stageTemp.draw.ceiling[a];c.beginPath();c.moveTo(b[0].x,b[0].y);c.lineTo(b[1].x,b[1].y);c.closePath();c.stroke();c.strokeStyle="#e8bd84";for(b=0;b<stageTemp.ledge.length;b++){var d=stageTemp.ledge[b];d[0]==a&&(c.beginPath(),d[1]?(c.moveTo(stageTemp.draw.box[d[0]].max.x,stageTemp.draw.box[d[0]].max.y+
Math.min(30,(stageTemp.draw.box[d[0]].min.y-stageTemp.draw.box[d[0]].max.y)/2)),c.lineTo(stageTemp.draw.box[d[0]].max.x,stageTemp.draw.box[d[0]].max.y),c.lineTo(stageTemp.draw.box[d[0]].max.x-Math.min(30,(stageTemp.draw.box[d[0]].max.x-stageTemp.draw.box[d[0]].min.x)/2),stageTemp.draw.box[d[0]].max.y)):(c.moveTo(stageTemp.draw.box[d[0]].min.x,stageTemp.draw.box[d[0]].max.y+Math.min(30,(stageTemp.draw.box[d[0]].min.y-stageTemp.draw.box[d[0]].max.y)/2)),c.lineTo(stageTemp.draw.box[d[0]].min.x,stageTemp.draw.box[d[0]].max.y),
c.lineTo(stageTemp.draw.box[d[0]].min.x+Math.min(30,(stageTemp.draw.box[d[0]].max.x-stageTemp.draw.box[d[0]].min.x)/2),stageTemp.draw.box[d[0]].max.y)),c.closePath(),c.stroke())}}else"platform"==hoverItem[0]&&(c.lineWidth=3,c.strokeStyle="#7eb3d5",a=stageTemp.draw.platform[a],c.beginPath(),c.moveTo(a[0].x,a[0].y),c.lineTo(a[1].x,a[1].y),c.closePath(),c.stroke());0!=ledgeHoverItem&&(c.fillStyle="rgb(255, 148, 70)",c.beginPath(),ledgeHoverItem[2]?c.arc(stageTemp.draw.box[ledgeHoverItem[1]].max.x,stageTemp.draw.box[ledgeHoverItem[1]].max.y,
10,0,twoPi):c.arc(stageTemp.draw.box[ledgeHoverItem[1]].min.x,stageTemp.draw.box[ledgeHoverItem[1]].max.y,10,0,twoPi),c.closePath(),c.fill());0<toolInfoTimer&&toolInfoTimer--;c.fillStyle="rgb(255,255,255)";c.font="13px Lucida Console, monaco, monospace";for(a=0;6>a;a++)targetTool==a?(0<toolInfoTimer&&(c.save(),c.globalAlpha=1,c.fillStyle="rgba(0,0,0,"+Math.min(toolInfoTimer/60,1)+")",c.fillRect(690+70*a,715,80,30),c.fillStyle="rgba(255,255,255,"+Math.min(toolInfoTimer/60,1)+")",c.fillText(toolInfo[targetTool],
730+70*a,733),c.restore()),c.globalAlpha=.6):c.globalAlpha=.2,c.beginPath(),c.moveTo(700+70*a,660),c.arc(710+70*a,660,10,Math.PI,1.5*Math.PI),c.lineTo(750+70*a,650),c.arc(750+70*a,660,10,1.5*Math.PI,twoPi),c.lineTo(760+70*a,710),c.arc(750+70*a,700,10,0,Math.PI/2),c.lineTo(710+70*a,710),c.arc(710+70*a,700,10,Math.PI/2,Math.PI),c.closePath(),c.fill();c.globalAlpha=1;c.fillStyle="rgba(0,0,0,0.8)";c.strokeStyle="rgba(0,0,0,0.8)";c.lineWidth=4;c.font="600 14px Lucida Console, monaco, monospace";c.fillText(20-
stageTemp.box.length,745,707);c.strokeRect(720,670,20,20);c.fillText(20-stageTemp.platform.length,815,707);c.beginPath();c.moveTo(788,680);c.lineTo(812,680);c.stroke();c.closePath();c.beginPath();c.moveTo(860,690);c.lineTo(860,670);c.lineTo(880,670);c.stroke();c.closePath();c.fillText(10-stageTemp.target.length,955,707);c.fillStyle="rgba(255,0,0,0.8)";c.beginPath();c.arc(940,680,15,0,twoPi);c.closePath();c.fill();c.fillStyle="rgba(255,255,255,0.8)";c.beginPath();c.arc(940,680,10,0,twoPi);c.closePath();
c.fill();c.fillStyle="rgba(255,0,0,0.8)";c.beginPath();c.arc(940,680,5,0,twoPi);c.closePath();c.fill();c.drawImage(handOpen,997,663,29,38);c.font="900 30px Arial";c.fillStyle="rgba(252, 45, 45, 0.8)";c.fillText("X",1080,692);c.font="13px Lucida Console, monaco, monospace";0<tooSmallTimer&&(tooSmallTimer--,c.fillStyle="rgba(0,0,0,"+Math.min(tooSmallTimer/60,1)+")",c.fillRect(tooSmallPos.x+30,tooSmallPos.y,80,25),c.fillStyle="rgba(255,255,255,"+Math.min(tooSmallTimer/60,1)+")",c.fillText("Too small",
tooSmallPos.x+70,tooSmallPos.y+17));4==targetTool?0==grabbedItem?c.drawImage(handOpen,3*crossHairPos.x+600-18,-3*crossHairPos.y+375-24,36,48):c.drawImage(handGrab,3*crossHairPos.x+600-18,-3*crossHairPos.y+375-24,36,48):5==targetTool?(c.font="900 40px Arial",c.fillStyle="rgb(255, 83, 83)",c.strokeStyle="black",c.fillText("X",3*crossHairPos.x+600,-3*crossHairPos.y+385),c.strokeText("X",3*crossHairPos.x+600,-3*crossHairPos.y+385)):(c.fillStyle="#ffffff",c.fillRect(3*crossHairPos.x+600-2,-3*crossHairPos.y+
375-10,4,20),c.fillRect(3*crossHairPos.x+600-10,-3*crossHairPos.y+375-2,20,4));if(builderPaused){c.fillStyle="rgba(0,0,0,0.4)";c.fillRect(0,0,canvas.width,canvas.height);for(a=0;3>a;a++)c.fillStyle=builderPauseSelected==a?"rgba(255,255,255,0.9)":"rgba(255,255,255,0.2)",c.fillRect(400,150+150*a,400,100);c.font="900 50px Arial";c.fillStyle="rgba(0,0,0,0.8)";c.fillText("Test stage",600,220);c.fillText("Save stage",600,370);c.fillText("Quit",600,520)}}
function findTarget(a){for(var b=!1,d=0;d<stageTemp.target.length;d++)if(30>=Math.abs(a.x-stageTemp.draw.target[d].x)&&30>=Math.abs(a.y-stageTemp.draw.target[d].y)){hoverItem=["target",d];b=!0;break}return b}
function findPlatform(a){for(var b=!1,d=0;d<stageTemp.platform.length;d++)if(Math.abs(a.x-(stageTemp.draw.platform[d][0].x+stageTemp.draw.platform[d][1].x)/2)<=Math.abs(stageTemp.draw.platform[d][0].x-stageTemp.draw.platform[d][1].x)/2+10&&20>=Math.abs(a.y-stageTemp.draw.platform[d][0].y)){hoverItem=["platform",d];b=!0;break}return b}
function findBox(a){for(var b=!1,d=0;d<stageTemp.box.length;d++)if(a.x>=stageTemp.draw.box[d].min.x-5&&a.x<=stageTemp.draw.box[d].max.x+5&&a.y>=stageTemp.draw.box[d].max.y-5&&a.y<=stageTemp.draw.box[d].min.y+5){hoverItem=["box",d];b=!0;break}return b}
function centerItem(a,b){switch(a[0]){case "startingPoint":stageTemp.draw.startingPoint=new Vec2D(b.x,b.y);stageTemp.startingPoint=new Vec2D(crossHairPos.x,crossHairPos.y);break;case "target":stageTemp.draw.target[a[1]]=new Vec2D(b.x,b.y);stageTemp.target[a[1]]=new Vec2D(crossHairPos.x,crossHairPos.y);break;case "platform":var d=Math.abs(stageTemp.platform[a[1]][0].x-stageTemp.platform[a[1]][1].x)/2,e=Math.abs(stageTemp.draw.platform[a[1]][0].x-stageTemp.draw.platform[a[1]][1].x)/2;stageTemp.draw.platform[a[1]]=
[new Vec2D(b.x-e,b.y),new Vec2D(b.x+e,b.y)];stageTemp.platform[a[1]]=[new Vec2D(crossHairPos.x-d,crossHairPos.y),new Vec2D(crossHairPos.x+d,crossHairPos.y)];break;case "box":var d=Math.abs(stageTemp.box[a[1]].max.x-stageTemp.box[a[1]].min.x)/2,f=Math.abs(stageTemp.box[a[1]].max.y-stageTemp.box[a[1]].min.y)/2,e=Math.abs(stageTemp.draw.box[a[1]].max.x-stageTemp.draw.box[a[1]].min.x)/2,h=Math.abs(stageTemp.draw.box[a[1]].min.y-stageTemp.draw.box[a[1]].max.y)/2;stageTemp.box[a[1]]=new Box2D([crossHairPos.x-
d,crossHairPos.y-f],[crossHairPos.x+d,crossHairPos.y+f]);stageTemp.draw.box[a[1]]=new Box2D([b.x-e,b.y+h],[b.x+e,b.y-h]);d=stageTemp.draw.box[a[1]];stageTemp.draw.ground[a[1]]=[new Vec2D(d.min.x,d.max.y),new Vec2D(d.max.x,d.max.y)];stageTemp.draw.ceiling[a[1]]=[new Vec2D(d.min.x,d.min.y),new Vec2D(d.max.x,d.min.y)];stageTemp.draw.wallL[a[1]]=[new Vec2D(d.min.x,d.max.y),new Vec2D(d.min.x,d.min.y)];stageTemp.draw.wallR[a[1]]=[new Vec2D(d.max.x,d.max.y),new Vec2D(d.max.x,d.min.y)];d=stageTemp.box[a[1]];
stageTemp.ground[a[1]]=[new Vec2D(d.min.x,d.max.y),new Vec2D(d.max.x,d.max.y)];stageTemp.ceiling[a[1]]=[new Vec2D(d.min.x,d.min.y),new Vec2D(d.max.x,d.min.y)];stageTemp.wallL[a[1]]=[new Vec2D(d.min.x,d.max.y),new Vec2D(d.min.x,d.min.y)];stageTemp.wallR[a[1]]=[new Vec2D(d.max.x,d.max.y),new Vec2D(d.max.x,d.min.y)]}}targetTesting=!1;targetStagePlaying=targetPlayer=0;targetDestroyed=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];targetsDestroyed=0;endTargetGame=!1;
targetRecords=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13.43,-1,-1,-1,-1,-1,-1,-1,-1,-1];worldRecords=[15.4,13.03,16.53,17.32,17.32,17.32,17.32,17.32,17.32,17.32];medalTimes=[[30,21,17],[29,20,15],[35,24,19],[35,23,15],[35,23,15],[35,23,15],[35,23,15],[35,23,15],[35,23,15],[35,23,15]];medalsEarned=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]];
function startTargetGame(a,b){endTargetGame=!1;b&&(stage=stageTemp);targetTesting=b;gameMode=5;targetDestroyed=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];targetsDestroyed=0;vfxQueue=[];initializePlayers(a,!0);renderPlayer(a);player[a].phys.pos=new Vec2D(stage.startingPoint.x,stage.startingPoint.y);matchTimer=0;startTimer=1.5;starting=!0;sounds.menu2.stop();sounds.battlefield.stop();sounds.battlefield.play("battlefieldStart");drawVfx("start",new Vec2D(0,0));findingPlayers=!1;playing=!0;player[a].inCSS=!1;player[a].stocks=
1}function destroyTarget(a){targetDestroyed[a]=!0;targetsDestroyed++;drawVfx("targetDestroy",stage.target[a]);playSfx("targetBreak");targetsDestroyed==stage.target.length&&(endTargetGame=!0)}function targetHitDetection(a){for(var b=0;b<stage.target.length;b++)if(!targetDestroyed[b])for(var d=0;4>d;d++)if(player[a].hitboxes.active[d]&&hitTargetCollision(a,d,b)){destroyTarget(b);break}}
function hitTargetCollision(a,b,d){var e=new Vec2D(player[a].phys.pos.x+player[a].hitboxes["id"+b].offset[player[a].hitboxes.frame].x*player[a].phys.face,player[a].phys.pos.y+player[a].hitboxes["id"+b].offset[player[a].hitboxes.frame].y);d=new Vec2D(stage.target[d].x,stage.target[d].y);return Math.pow(d.x-e.x,2)+Math.pow(e.y-d.y,2)<=Math.pow(player[a].hitboxes["id"+b].size+7,2)}
function targetTimerTick(){matchTimer+=.016667;$("#matchMinutes").empty().append(Math.floor(matchTimer/60));var a=(matchTimer%60).toFixed(2);$("#matchSeconds").empty().append(5>a.length?"0"+a:a)}targetSelectTimer=targetSelected=0;targetPointerPos=[600,635];
function tssControls(a){targetPointerPos[0]+=15*player[a].inputs.lStickAxis[0].x;targetPointerPos[1]+=-15*player[a].inputs.lStickAxis[0].y;c.fillRect(50+260*Math.floor(a/5)+65*Math.floor(a/10),110+a%5*60,250,50);if(45<=targetPointerPos[1]&&420>=targetPointerPos[1])for(var b=0;3>b;b++)if(targetPointerPos[0]>=50+260*Math.floor(b/5)+65*Math.floor(b/10)&&targetPointerPos[0]<=300+260*Math.floor(b/5)+65*Math.floor(b/10)&&targetPointerPos[1]>=110+b%5*60&&targetPointerPos[1]<=160+b%5*60){targetSelected!=
b&&playSfx("menuSelect");targetSelected=b;break}if(player[a].inputs.b[0]&&!player[a].inputs.b[1])playSfx("menuBack"),gameMode=1;else if(player[a].inputs.s[0]&&!player[a].inputs.s[1]||player[a].inputs.a[0]&&!player[a].inputs.a[1])playSfx("menuForward"),stage=targetStages[targetSelected],targetStagePlaying=targetSelected,startTargetGame(a,!1)}var shine=.5;
function drawTSS(){var a=c.createLinearGradient(0,0,1200,750);a.addColorStop(0,"rgb(66, 42, 6)");a.addColorStop(1,"rgb(26, 2, 2)");c.fillStyle=a;c.fillRect(0,0,canvas.width,canvas.height);c.lineWidth=3;shine+=.01;1.8<shine&&(shine=-.8);var b=0>shine?.05+.3125*(.8+shine):1<shine?.3-.3125*(shine-1):.3,a=c.createLinearGradient(0,0,1200,750);a.addColorStop(0,"rgba(255, 255, 255,0.05)");a.addColorStop(Math.min(Math.max(0,shine),1),"rgba(255,255,255,"+b+")");a.addColorStop(1,"rgba(255, 255, 255,0.05)");
c.strokeStyle=a;c.beginPath();for(a=0;60>a;a++)c.moveTo(0+30*a,0),c.lineTo(0+30*a,750),c.moveTo(0,0+30*a),c.lineTo(1200,0+30*a);c.stroke();c.lineWidth=4;c.fillStyle="rgba(255,255,255,0.7)";c.textAlign="start";c.font="800 35px Arial";c.fillText("Select Target Stage",50,85);c.fillText("Custom Stages",640,85);c.fillStyle="black";c.lineWidth=3;targetSelectTimer++;for(a=0;3>a;a++)c.strokeStyle=targetSelected==a?4<targetSelectTimer%8?"rgb(251, 116, 155)":"rgb(255, 182, 204)":"rgb(166, 166, 166)",c.fillRect(50+
260*Math.floor(a/5)+65*Math.floor(a/10),110+a%5*60,250,50),c.strokeRect(50+260*Math.floor(a/5)+65*Math.floor(a/10),110+a%5*60,250,50);c.font="700 25px Arial";c.fillStyle="rgba(255,255,255,0.6)";for(a=0;3>a;a++)c.fillText("Target "+(a+1),60+260*Math.floor(a/5),143+a%5*60);c.save();c.setLineDash([5,5]);c.strokeStyle="rgb(157, 157, 157)";c.lineWidth=2;for(a=0;3>a;a++)c.beginPath(),c.arc(220+260*Math.floor(a/5),135+a%5*60,10,0,twoPi),c.closePath(),medalsEarned[a][0]?(b=c.createLinearGradient(210+260*
Math.floor(a/5),125+a%5*60,230+260*Math.floor(a/5),145+a%5*60),b.addColorStop(0,"rgb(180, 123, 65)"),b.addColorStop(1,"rgb(236, 179, 120)"),c.fillStyle=b,c.fill()):c.stroke(),c.beginPath(),c.arc(250+260*Math.floor(a/5),135+a%5*60,10,0,twoPi),c.closePath(),medalsEarned[a][1]?(b=c.createLinearGradient(240+260*Math.floor(a/5),125+a%5*60,260+260*Math.floor(a/5),145+a%5*60),b.addColorStop(0,"rgb(161, 161, 161)"),b.addColorStop(1,"rgb(246, 246, 246)"),c.fillStyle=b,c.fill()):c.stroke(),c.beginPath(),c.arc(280+
260*Math.floor(a/5),135+a%5*60,10,0,twoPi),c.closePath(),medalsEarned[a][2]?(b=c.createLinearGradient(270+260*Math.floor(a/5),125+a%5*60,290+260*Math.floor(a/5),145+a%5*60),b.addColorStop(0,"rgb(255, 221, 42)"),b.addColorStop(1,"rgb(255, 237, 140)"),c.fillStyle=b,c.fill()):c.stroke();c.restore();c.strokeStyle="rgba(255, 255, 255, 0.5)";c.fillStyle="rgba(0, 0, 0, 0.5)";c.fillRect(200,450,800,200);c.strokeRect(200,450,800,200);if(10>targetSelected){b=c.createLinearGradient(270,470,330,530);b.addColorStop(0,
"rgb(180, 123, 65)");b.addColorStop(1,"rgb(236, 179, 120)");c.fillStyle=b;c.beginPath();c.arc(300,500,30,0,twoPi);c.closePath();c.fill();b=c.createLinearGradient(510,470,570,530);b.addColorStop(0,"rgb(161, 161, 161)");b.addColorStop(1,"rgb(246, 246, 246)");c.fillStyle=b;c.beginPath();c.arc(540,500,30,0,twoPi);c.closePath();c.fill();b=c.createLinearGradient(750,470,810,530);b.addColorStop(0,"rgb(255, 221, 42)");b.addColorStop(1,"rgb(255, 237, 140)");c.fillStyle=b;c.beginPath();c.arc(780,500,30,0,twoPi);
c.closePath();c.fill();c.fillStyle="rgba(255,255,255,0.7)";c.font="700 30px Arial";for(a=0;3>a;a++){var b="0"+Math.floor(medalTimes[targetSelected][a]/60)+":",d=(medalTimes[targetSelected][a]%60).toFixed(2),b=b+(5>d.length?"0"+d:d);c.fillText(b,345+240*a,513)}c.font="italic 900 38px Arial";c.fillText("World Record",250,625);c.font="700 38px Arial";c.textAlign="center";b="0"+Math.floor(worldRecords[targetSelected]/60)+":";d=(worldRecords[targetSelected]%60).toFixed(2);b+=5>d.length?"0"+d:d;c.fillText(b,
750,625)}c.fillStyle="rgba(255,255,255,0.7)";c.textAlign="start";c.font="italic 900 38px Arial";c.fillText("Personal Best",250,575-(9<targetSelected?15:0));c.font="700 38px Arial";c.textAlign="center";-1==targetRecords[targetSelected]?b="--:--:--":(b="0"+Math.floor(targetRecords[targetSelected]/60)+":",d=(targetRecords[targetSelected]%60).toFixed(2),b+=5>d.length?"0"+d:d);c.fillText(b,750,575-(9<targetSelected?15:0));c.lineWidth=8;c.strokeStyle="rgba(255,255,255,0.8)";c.beginPath();c.arc(targetPointerPos[0],
targetPointerPos[1],40,0,twoPi);c.closePath();c.stroke()}
stages={bf:{box:[new Box2D([-68.4,-9],[68.4,0]),new Box2D([-29.3,-34],[-13.68,-9]),new Box2D([13.68,-34],[29.3,-9]),new Box2D([-13.68,-20],[13.68,-9])],platform:[[new Vec2D(-57.6,27.2),new Vec2D(-20,27.2)],[new Vec2D(20,27.2),new Vec2D(57.6,27.2)],[new Vec2D(-18.8,54.4),new Vec2D(18.8,54.4)]],ground:[[new Vec2D(-68.4,0),new Vec2D(68.4,0)]],ceiling:[[new Vec2D(-68.4,-9),new Vec2D(-29.3,-9)],[new Vec2D(-29.3,-34),new Vec2D(-13.68,-34)],[new Vec2D(13.68,-34),new Vec2D(29.3,-34)],[new Vec2D(29.3,-9),
new Vec2D(68.4,-9)],[new Vec2D(-13.68,-20),new Vec2D(13.68,-20)]],wallL:[[new Vec2D(-68.4,0),new Vec2D(-68.4,-9)],[new Vec2D(-29.3,-9),new Vec2D(-29.3,-34)],[new Vec2D(13.68,-20),new Vec2D(13.68,-34)]],wallR:[[new Vec2D(68.4,0),new Vec2D(68.4,-9)],[new Vec2D(29.3,-9),new Vec2D(29.3,-34)],[new Vec2D(-13.68,-20),new Vec2D(-13.68,-34)]],startingPoint:[new Vec2D(-50,50),new Vec2D(50,50),new Vec2D(-25,5),new Vec2D(25,5)],startingFace:[1,-1,1,-1],respawnPoints:[new Vec2D(-50,50),new Vec2D(50,50),new Vec2D(-25,
35),new Vec2D(25,35)],respawnFace:[1,-1,1,-1],blastzone:new Box2D([-224,-108.8],[224,200]),ledge:[[0,0],[0,1]],scale:4.5,offset:[600,480],movingPlatforms:function(){}},ys:{box:[new Box2D([-56,-100],[56,0])],platform:[[new Vec2D(-103.6,-33.25),new Vec2D(-91.7,-33.25)],[new Vec2D(-59.5,23.45),new Vec2D(-28,23.45)],[new Vec2D(28,23.45),new Vec2D(59.5,23.45)],[new Vec2D(-15.75,42),new Vec2D(15.75,42)]],ground:[[new Vec2D(-56,0),new Vec2D(56,0)]],ceiling:[[new Vec2D(-56,-100),new Vec2D(56,-100)]],wallL:[[new Vec2D(-56,
0),new Vec2D(-56,-100)]],wallR:[[new Vec2D(56,0),new Vec2D(56,-100)]],startingPoint:[new Vec2D(-42,30),new Vec2D(42,30),new Vec2D(-15,15),new Vec2D(15,15)],startingFace:[1,-1,1,-1],respawnPoints:[new Vec2D(-42,30),new Vec2D(42,30),new Vec2D(-20,30),new Vec2D(-20,30)],respawnFace:[1,-1,1,-1],blastzone:new Box2D([-175.7,-91],[173.6,168]),ledge:[[0,0],[0,1]],scale:5,offset:[600,430],movingPlatforms:function(){var a=stage.platform[0],b=[0,0];-103.6>=a[0].x&&-33.25<a[0].y&&(a[0].x=-103.6,a[1].x=-91.7,
a[0].y-=.354845,a[1].y-=.354845,b=[0,-.354845]);91.35<=a[0].x&&-13.65>a[0].y&&(a[0].x=91.35,a[1].x=103.25,a[0].y+=.354845,a[1].y+=.354845,b=[0,.354845]);-33.25>=a[0].y&&(a[0].y=-33.25,a[1].y=-33.25,a[0].x+=.354845,a[1].x+=.354845,b=[.354845,0]);-13.65<=a[0].y&&(a[0].y=-13.65,a[1].y=-13.65,a[0].x-=.354845,a[1].x-=.354845,b=[-.354845,0]);for(a=0;4>a;a++)1==player[a].phys.onSurface[0]&&0==player[a].phys.onSurface[1]&&player[a].phys.grounded&&(player[a].phys.pos.x+=b[0],player[a].phys.pos.y+=b[1])}},
ps:{box:[new Box2D([-87.7,-17.75],[87.7,0]),new Box2D([-62,-38],[62,-17.75]),new Box2D([-15,-112],[15,-38])],platform:[[new Vec2D(-55,25),new Vec2D(-25,25)],[new Vec2D(25,25),new Vec2D(55,25)]],ground:[[new Vec2D(-87.7,0),new Vec2D(87.7,0)]],ceiling:[[new Vec2D(-87.7,-17.75),new Vec2D(-62,-17.75)],[new Vec2D(-62,-38),new Vec2D(-15,-38)],[new Vec2D(-15,-112),new Vec2D(15,-112)],[new Vec2D(62,-17.75),new Vec2D(87.7,-17.75)],[new Vec2D(15,-38),new Vec2D(62,-38)]],wallL:[[new Vec2D(-87.7,0),new Vec2D(-87.7,
-17.75)],[new Vec2D(-62,-17.75),new Vec2D(-62,-38)],[new Vec2D(-15,-38),new Vec2D(-15,-112)]],wallR:[[new Vec2D(87.7,0),new Vec2D(87.7,-17.75)],[new Vec2D(62,-17.75),new Vec2D(62,-38)],[new Vec2D(15,-38),new Vec2D(15,-112)]],startingPoint:[new Vec2D(-45,44),new Vec2D(45,44),new Vec2D(-25,44),new Vec2D(25,44)],startingFace:[1,-1,1,-1],respawnPoints:[new Vec2D(-45,44),new Vec2D(45,44),new Vec2D(-25,44),new Vec2D(25,44)],respawnFace:[1,-1,1,-1],blastzone:new Box2D([-230,-111],[230,180]),ledge:[[0,0],
[0,1]],scale:4.2,offset:[600,500],movingPlatforms:function(){}},dl:{box:[new Box2D([-77.27,-36],[77.27,0])],platform:[[new Vec2D(-61.393,30.142),new Vec2D(-31.725,30.142)],[new Vec2D(-19.018,51.425),new Vec2D(19.017,51.425)],[new Vec2D(31.704,30.243),new Vec2D(63.075,30.243)]],ground:[[new Vec2D(-77.27,0),new Vec2D(77.27,0)]],ceiling:[[new Vec2D(-77.27,-36),new Vec2D(77.27,-36)]],wallL:[[new Vec2D(-77.27,0),new Vec2D(-77.27,-36)]],wallR:[[new Vec2D(77.27,0),new Vec2D(77.27,-36)]],startingPoint:[new Vec2D(-60,
50),new Vec2D(60,50),new Vec2D(-40,50),new Vec2D(40,50)],startingFace:[1,-1,1,-1],respawnPoints:[new Vec2D(-60,50),new Vec2D(60,50),new Vec2D(-40,50),new Vec2D(40,50)],respawnFace:[1,-1,1,-1],blastzone:new Box2D([-255,-123],[255,250]),ledge:[[0,0],[0,1]],scale:3.5,offset:[600,500],movingPlatforms:function(){}}};customTargetStages=[];
targetStages=[{startingPoint:new Vec2D(0,0),box:[new Box2D([-150.5625,70.1875],[-16.0625,88.1875]),new Box2D([-56.5625,-21.8125],[55.5625,-14]),new Box2D([114.70000000000009,-78.675],[143.4,17.000000000000057]),new Box2D([82.2500000000003,-78.78749999999995],[143.46250000000018,-20.57499999999995]),new Box2D([-172.0124999999996,-118.12499999999996],[-159.1999999999996,-13.499999999999963]),new Box2D([-133.0749999999996,-48.812499999999964],[-111.57499999999959,-27.12499999999996]),new Box2D([37.56250000000042,
-78.71249999999993],[143.45000000000041,-50.87499999999992])],ground:[[new Vec2D(-150.5625,88.1875),new Vec2D(-16.0625,88.1875)],[new Vec2D(-56.5625,-14),new Vec2D(55.5625,-14)],[new Vec2D(114.70000000000009,17.000000000000057),new Vec2D(143.4,17.000000000000057)],[new Vec2D(82.2500000000003,-20.57499999999995),new Vec2D(143.46250000000018,-20.57499999999995)],[new Vec2D(-172.0124999999996,-13.499999999999963),new Vec2D(-159.1999999999996,-13.499999999999963)],[new Vec2D(-133.0749999999996,-27.12499999999996),
new Vec2D(-111.57499999999959,-27.12499999999996)],[new Vec2D(37.56250000000042,-50.87499999999992),new Vec2D(143.45000000000041,-50.87499999999992)]],ceiling:[[new Vec2D(-150.5625,70.1875),new Vec2D(-16.0625,70.1875)],[new Vec2D(-56.5625,-21.8125),new Vec2D(55.5625,-21.8125)],[new Vec2D(114.70000000000009,-78.675),new Vec2D(143.4,-78.675)],[new Vec2D(82.2500000000003,-78.78749999999995),new Vec2D(143.46250000000018,-78.78749999999995)],[new Vec2D(-172.0124999999996,-118.12499999999996),new Vec2D(-159.1999999999996,
-118.12499999999996)],[new Vec2D(-133.0749999999996,-48.812499999999964),new Vec2D(-111.57499999999959,-48.812499999999964)],[new Vec2D(37.56250000000042,-78.71249999999993),new Vec2D(143.45000000000041,-78.71249999999993)]],wallL:[[new Vec2D(-150.5625,88.1875),new Vec2D(-150.5625,70.1875)],[new Vec2D(-56.5625,-14),new Vec2D(-56.5625,-21.8125)],[new Vec2D(114.70000000000009,17.000000000000057),new Vec2D(114.70000000000009,-78.675)],[new Vec2D(82.2500000000003,-20.57499999999995),new Vec2D(82.2500000000003,
-78.78749999999995)],[new Vec2D(-172.0124999999996,-13.499999999999963),new Vec2D(-172.0124999999996,-118.12499999999996)],[new Vec2D(-133.0749999999996,-27.12499999999996),new Vec2D(-133.0749999999996,-48.812499999999964)],[new Vec2D(37.56250000000042,-50.87499999999992),new Vec2D(37.56250000000042,-78.71249999999993)]],wallR:[[new Vec2D(-16.0625,88.1875),new Vec2D(-16.0625,70.1875)],[new Vec2D(55.5625,-14),new Vec2D(55.5625,-21.8125)],[new Vec2D(143.4,17.000000000000057),new Vec2D(143.4,-78.675)],
[new Vec2D(143.46250000000018,-20.57499999999995),new Vec2D(143.46250000000018,-78.78749999999995)],[new Vec2D(-159.1999999999996,-13.499999999999963),new Vec2D(-159.1999999999996,-118.12499999999996)],[new Vec2D(-111.57499999999959,-27.12499999999996),new Vec2D(-111.57499999999959,-48.812499999999964)],[new Vec2D(143.45000000000041,-50.87499999999992),new Vec2D(143.45000000000041,-78.71249999999993)]],platform:[[new Vec2D(143.36250000000027,-21.537499999999948),new Vec2D(169.4625000000004,-21.537499999999948)],
[new Vec2D(143.38750000000041,-50.59999999999991),new Vec2D(168.5875000000004,-50.59999999999991)],[new Vec2D(-95.19999999999959,-63.937499999999964),new Vec2D(-5.299999999999652,-63.937499999999964)],[new Vec2D(-140.1374999999996,29.93750000000004),new Vec2D(-84.63749999999959,29.93750000000004)],[new Vec2D(-193.0999999999996,70.10000000000002),new Vec2D(-149.5124999999996,70.10000000000002)]],ledge:[[3,0],[2,0],[4,1]],target:[new Vec2D(-48.59999999999965,.6875),new Vec2D(48.40000000000035,.6875),
new Vec2D(156.96250000000035,-66.3125),new Vec2D(-15.13749999999959,-43.18749999999997),new Vec2D(-186.3874999999996,-86.99999999999997),new Vec2D(-113.16249999999962,47.72500000000002),new Vec2D(-128.91249999999962,103.60000000000002),new Vec2D(53.150000000000375,103.60000000000002),new Vec2D(153.96250000000038,-7.212499999999977),new Vec2D(-51.912499999999625,103.91250000000002)],scale:3,blastzone:new Box2D([-250,-250],[250,250]),offset:[600,375]},{startingPoint:new Vec2D(-159.5,-73.75),box:[new Box2D([-200,
-103],[-48.9375,-88.3125]),new Box2D([-200,-51.3125],[-49.8125,-36.75]),new Box2D([-145.40000000000026,-37.0375],[-111.575,20.82499999999999]),new Box2D([-76.00000000000036,6.700000000000007],[10.36249999999965,19.950000000000006]),new Box2D([141.33749999999978,-44.625],[155.79999999999987,60.88749999999999]),new Box2D([181.5625,-43.5375],[195.225,61])],ground:[[new Vec2D(-200,-88.3125),new Vec2D(-48.9375,-88.3125)],[new Vec2D(-200,-36.75),new Vec2D(-49.8125,-36.75)],[new Vec2D(-145.40000000000026,
20.82499999999999),new Vec2D(-111.575,20.82499999999999)],[new Vec2D(-76.00000000000036,19.950000000000006),new Vec2D(10.36249999999965,19.950000000000006)],[new Vec2D(141.33749999999978,60.88749999999999),new Vec2D(155.79999999999987,60.88749999999999)],[new Vec2D(181.5625,61),new Vec2D(195.225,61)]],ceiling:[[new Vec2D(-200,-103),new Vec2D(-48.9375,-103)],[new Vec2D(-200,-51.3125),new Vec2D(-49.8125,-51.3125)],[new Vec2D(-145.40000000000026,-37.0375),new Vec2D(-111.575,-37.0375)],[new Vec2D(-76.00000000000036,
6.700000000000007),new Vec2D(10.36249999999965,6.700000000000007)],[new Vec2D(141.33749999999978,-44.625),new Vec2D(155.79999999999987,-44.625)],[new Vec2D(181.5625,-43.5375),new Vec2D(195.225,-43.5375)]],wallL:[[new Vec2D(-200,-88.3125),new Vec2D(-200,-103)],[new Vec2D(-200,-36.75),new Vec2D(-200,-51.3125)],[new Vec2D(-145.40000000000026,20.82499999999999),new Vec2D(-145.40000000000026,-37.0375)],[new Vec2D(-76.00000000000036,19.950000000000006),new Vec2D(-76.00000000000036,6.700000000000007)],[new Vec2D(141.33749999999978,
60.88749999999999),new Vec2D(141.33749999999978,-44.625)],[new Vec2D(181.5625,61),new Vec2D(181.5625,-43.5375)]],wallR:[[new Vec2D(-48.9375,-88.3125),new Vec2D(-48.9375,-103)],[new Vec2D(-49.8125,-36.75),new Vec2D(-49.8125,-51.3125)],[new Vec2D(-111.575,20.82499999999999),new Vec2D(-111.575,-37.0375)],[new Vec2D(10.36249999999965,19.950000000000006),new Vec2D(10.36249999999965,6.700000000000007)],[new Vec2D(155.79999999999987,60.88749999999999),new Vec2D(155.79999999999987,-44.625)],[new Vec2D(195.225,
61),new Vec2D(195.225,-43.5375)]],platform:[[new Vec2D(-43.5625,-69.6875),new Vec2D(-.3125,-69.6875)],[new Vec2D(-139.16250000000025,47.17499999999999),new Vec2D(-117.96250000000028,47.17499999999999)],[new Vec2D(-134.8250000000004,71.9875),new Vec2D(-122.86250000000037,71.9875)],[new Vec2D(12.912499999999682,33.63750000000001),new Vec2D(48.31249999999962,33.63750000000001)],[new Vec2D(53.32499999999967,39.22500000000002),new Vec2D(90.86249999999973,39.22500000000002)],[new Vec2D(95.5625,32.86249999999999),
new Vec2D(134.56249999999986,32.86249999999999)],[new Vec2D(155.5624999999997,82.92499999999993),new Vec2D(182.91249999999945,82.92499999999993)]],ledge:[[2,1],[2,0]],target:[new Vec2D(-185.0625,-75.0625),new Vec2D(-178.27500000000026,-19.17500000000001),new Vec2D(-129.02500000000038,95.20000000000002),new Vec2D(72.21249999999984,22.699999999999996),new Vec2D(70.67499999999984,76.43750000000001),new Vec2D(168.4375,5.5249999999999915),new Vec2D(185.1875,114.21249999999999),new Vec2D(170.125,-97.01250000000007),
new Vec2D(-25.3125,-44.825000000000074),new Vec2D(-67.625,28.924999999999926)],scale:3,blastzone:new Box2D([-250,-250],[250,250]),offset:[600,375]},{startingPoint:new Vec2D(-179.6875,-74.375),box:[new Box2D([-150.19374999999914,-126.30625],[-115.75624999999886,39.806250000000006]),new Box2D([-18.581249999999045,-128.59375],[16.731250000000955,36.46875]),new Box2D([109.73125000000095,-143.15625],[144.04375000000095,36.40625]),new Box2D([-25.237499999999635,71.27499999999998],[-11.86249999999962,129.10000000000002]),
new Box2D([11.39375000000037,70.63124999999994],[24.081250000000377,163.06875])],ground:[[new Vec2D(-150.19374999999914,39.806250000000006),new Vec2D(-115.75624999999886,39.806250000000006)],[new Vec2D(-18.581249999999045,36.46875),new Vec2D(16.731250000000955,36.46875)],[new Vec2D(109.73125000000095,36.40625),new Vec2D(144.04375000000095,36.40625)],[new Vec2D(-25.237499999999635,129.10000000000002),new Vec2D(-11.86249999999962,129.10000000000002)],[new Vec2D(11.39375000000037,163.06875),new Vec2D(24.081250000000377,
163.06875)]],ceiling:[[new Vec2D(-150.19374999999914,-126.30625),new Vec2D(-115.75624999999886,-126.30625)],[new Vec2D(-18.581249999999045,-128.59375),new Vec2D(16.731250000000955,-128.59375)],[new Vec2D(109.73125000000095,-143.15625),new Vec2D(144.04375000000095,-143.15625)],[new Vec2D(-25.237499999999635,71.27499999999998),new Vec2D(-11.86249999999962,71.27499999999998)],[new Vec2D(11.39375000000037,70.63124999999994),new Vec2D(24.081250000000377,70.63124999999994)]],wallL:[[new Vec2D(-150.19374999999914,
39.806250000000006),new Vec2D(-150.19374999999914,-126.30625)],[new Vec2D(-18.581249999999045,36.46875),new Vec2D(-18.581249999999045,-128.59375)],[new Vec2D(109.73125000000095,36.40625),new Vec2D(109.73125000000095,-143.15625)],[new Vec2D(-25.237499999999635,129.10000000000002),new Vec2D(-25.237499999999635,71.27499999999998)],[new Vec2D(11.39375000000037,163.06875),new Vec2D(11.39375000000037,70.63124999999994)]],wallR:[[new Vec2D(-115.75624999999886,39.806250000000006),new Vec2D(-115.75624999999886,
-126.30625)],[new Vec2D(16.731250000000955,36.46875),new Vec2D(16.731250000000955,-128.59375)],[new Vec2D(144.04375000000095,36.40625),new Vec2D(144.04375000000095,-143.15625)],[new Vec2D(-11.86249999999962,129.10000000000002),new Vec2D(-11.86249999999962,71.27499999999998)],[new Vec2D(24.081250000000377,163.06875),new Vec2D(24.081250000000377,70.63124999999994)]],platform:[[new Vec2D(-181.125,-53.875),new Vec2D(-82.625,-53.875)],[new Vec2D(-170.375,-20.1875),new Vec2D(-92.6875,-20.1875)],[new Vec2D(-187.25,
-84.48750000000003),new Vec2D(-75.18749999999945,-84.48750000000003)],[new Vec2D(-158.87499999999946,7.949999999999989),new Vec2D(-106.49999999999946,7.949999999999989)],[new Vec2D(-148.04999999999944,65.87499999999999),new Vec2D(-118.8999999999993,65.87499999999999)],[new Vec2D(-141.16249999999926,90.3875),new Vec2D(-126.58749999999922,90.3875)],[new Vec2D(-29.268749999999045,-85.46249999999999),new Vec2D(27.418750000000955,-85.46249999999999)],[new Vec2D(-36.206249999999045,-53.49999999999999),
new Vec2D(34.356250000000955,-53.49999999999999)],[new Vec2D(-47.87499999999902,-20.6625),new Vec2D(46.02500000000093,-20.6625)],[new Vec2D(70.63750000000064,-86.5625),new Vec2D(184.66250000000014,-86.5625)],[new Vec2D(80.8125000000004,-53.775),new Vec2D(174.48750000000038,-53.775)],[new Vec2D(89.76875000000041,-21.287500000000005),new Vec2D(165.08125000000038,-21.287500000000005)],[new Vec2D(100.83750000000038,8.874999999999998),new Vec2D(152.91250000000042,8.874999999999998)],[new Vec2D(118.75625000000039,
86.28749999999997),new Vec2D(133.3937500000004,86.28749999999997)],[new Vec2D(111.71250000000003,64.22500000000001),new Vec2D(141.56249999999997,64.22500000000001)],[new Vec2D(-58.86875,9.562500000000002),new Vec2D(55.69374999999997,9.562500000000002)]],ledge:[[0,1],[0,0],[1,0],[1,1],[2,1],[2,0]],target:[new Vec2D(-133.72499999999926,111.16250000000001),new Vec2D(-103.099999999999,-104),new Vec2D(-31.799999999999045,-36.60000000000001),new Vec2D(-.6125000000000114,125),new Vec2D(29.800000000000374,
-73.33750000000003),new Vec2D(93.30000000000038,-37.962500000000034),new Vec2D(-1.5749999999996191,53.287499999999966),new Vec2D(125.78750000000039,105.89999999999996),new Vec2D(161.97500000000042,-38.087500000000034),new Vec2D(160.16250000000042,-107.71250000000003)],scale:3,blastzone:new Box2D([-250,-250],[250,250]),offset:[600,375]}];stageSelected=4;stageSelectTimer=0;stagePointerPos=[600,635];var bfIcon=new Image;bfIcon.src="assets/stage-icons/bf.png";var ysIcon=new Image;ysIcon.src="assets/stage-icons/ys.png";
var dlIcon=new Image;dlIcon.src="assets/stage-icons/dl.png";var psIcon=new Image;psIcon.src="assets/stage-icons/ps.png";
function sssControls(a){stagePointerPos[0]+=15*player[a].inputs.lStickAxis[0].x;stagePointerPos[1]+=-15*player[a].inputs.lStickAxis[0].y;if(450<=stagePointerPos[1]&&540>=stagePointerPos[1])for(var b=0;4>b;b++){if(stagePointerPos[0]>=225+200*b&&stagePointerPos[0]<=375+200*b){stageSelected!=b&&playSfx("menuSelect");stageSelected=b;break}}else 525<=stagePointerPos[0]&&675>=stagePointerPos[0]&&590<=stagePointerPos[1]&&680>=stagePointerPos[1]&&(4!=stageSelected&&playSfx("menuSelect"),stageSelected=4);
if(player[a].inputs.b[0]&&!player[a].inputs.b[1])playSfx("menuBack"),gameMode=2;else if(player[a].inputs.s[0]&&!player[a].inputs.s[1]||player[a].inputs.a[0]&&!player[a].inputs.a[1]){playSfx("menuForward");4==stageSelected&&(stageSelected=Math.floor(3.99*Math.random()));switch(stageSelected){case 0:stageSelect="bf";break;case 1:stageSelect="ys";break;case 2:stageSelect="ps";break;case 3:stageSelect="dl"}startGame()}}
function drawSSS(){var a=c.createLinearGradient(0,0,1200,750);a.addColorStop(0,"rgb(17, 11, 65)");a.addColorStop(1,"rgb(61, 8, 37)");c.fillStyle=a;c.fillRect(0,0,canvas.width,canvas.height);c.lineWidth=3;shine+=.01;1.8<shine&&(shine=-.8);var b=0>shine?.05+.3125*(.8+shine):1<shine?.3-.3125*(shine-1):.3,a=c.createLinearGradient(0,0,1200,750);a.addColorStop(0,"rgba(255, 255, 255,0.05)");a.addColorStop(Math.min(Math.max(0,shine),1),"rgba(255,255,255,"+b+")");a.addColorStop(1,"rgba(255, 255, 255,0.05)");
c.strokeStyle=a;c.beginPath();for(a=0;60>a;a++)c.moveTo(0+30*a,0),c.lineTo(0+30*a,750),c.moveTo(0,0+30*a),c.lineTo(1200,0+30*a);c.stroke();c.lineWidth=4;c.strokeStyle="rgba(255, 255, 255, 0.57)";c.strokeRect(198,98,804,304);c.fillStyle="black";c.textAlign="center";c.font="500 16px Arial";c.lineWidth=3;stageSelectTimer++;for(a=0;4>a;a++)c.strokeStyle=stageSelected==a?4<stageSelectTimer%8?"rgb(251, 116, 155)":"rgb(255, 182, 204)":"rgb(166, 166, 166)",c.fillRect(225+200*a,450,150,90),c.strokeRect(225+
200*a,450,150,90);c.fillRect(525,590,150,90);c.fillStyle="rgb(245, 144, 61)";c.strokeStyle="rgb(245, 144, 61)";4==stageSelected&&4<stageSelectTimer%8&&(c.fillStyle="rgb(251, 195, 149)",c.strokeStyle="rgb(251, 195, 149)");c.font="700 25px Arial";c.lineWidth=4;c.strokeRect(525,590,150,90);c.fillText("RANDOM",600,665);c.font="700 32px Arial";c.fillText("?",600,630);c.beginPath();c.arc(600,618,18,0,twoPi);c.closePath();c.stroke();c.fillStyle="white";c.font="500 16px Arial";c.fillText("BATTLEFIELD",300,
530);c.fillText("Y-STORY",500,530);c.fillText("P-STADIUM",700,530);c.fillText("DREAMLAND",900,530);c.drawImage(bfIcon,227,452,146,55);c.drawImage(ysIcon,427,452,146,55);c.drawImage(psIcon,627,452,146,55);c.drawImage(dlIcon,827,452,146,55);c.textAlign="start";c.fillStyle="rgba(255,255,255,0.6)";c.font="900 48px Arial";switch(stageSelected){case 0:c.drawImage(bfIcon,200,100,800,300);c.fillText("Battlefield",220,380);break;case 1:c.drawImage(ysIcon,200,100,800,300);c.fillText("Yoshi's Story",220,380);
break;case 2:c.drawImage(psIcon,200,100,800,300);c.fillText("Pokemon Stadium",220,380);break;case 3:c.drawImage(dlIcon,200,100,800,300);c.fillText("Dreamland",220,380);break;case 4:c.textAlign="center",c.lineWidth=9,c.fillStyle="rgba(0,0,0,0.7)",c.fillRect(202,102,796,296),c.fillStyle="rgb(255, 161, 84)",c.strokeStyle="rgb(255, 161, 84)",c.font="900 100px Arial",c.fillText("?",600,230),c.fillText("RANDOM",600,355),c.beginPath(),c.arc(600,192,55,0,twoPi),c.closePath(),c.stroke()}c.textAlign="center";
c.lineWidth=8;c.strokeStyle="rgba(255,255,255,0.8)";c.beginPath();c.arc(stagePointerPos[0],stagePointerPos[1],40,0,twoPi);c.closePath();c.stroke()}player=[0,0,0,0];renderTime=[10,0,100,0];gamelogicTime=[5,0,100,0];framerate=[0,0,0];gameEnd=!1;attemptingControllerReset=[!1,!1,!1,!1];function customDeadzone(){this.ls=new Vec2D(0,0);this.cs=new Vec2D(0,0);this.r=this.l=0}keyboardMap=[[102,186],[101,76],[100,75],[104,79],[103,73],[105,80],[107,192,222],[109,219],71,78,66,86];keyboardOccupied=!1;
map={a:[1,0,4,0],b:[2,1,3,1],x:[0,2,2,2],y:[3,3,1,3],z:[7,4,7,7],r:[5,5,6,5],l:[4,6,5,4],s:[9,7,0,9],du:[12,8,8,12],dr:[13,11,10,13],dd:[14,9,9,14],dl:[15,10,11,15],lsX:[0,0,0,0],lsY:[1,1,1,1],csX:[5,3,3,2],csY:[2,4,4,3],lA:[3,2,5,6],rA:[4,5,6,7]};mType=[0,0,0,0];cd=[new customDeadzone,new customDeadzone,new customDeadzone,new customDeadzone];currentPlayers=[];playerAmount=0;playerType=[-1,-1,-1,-1];ports=0;activePorts=[];frameByFrame=playing=!1;showVfx=findingPlayers=!0;showDebug=!1;
versusMode=gameMode=0;charSelect=["marth","marth","marth","marth"];randomTags="NEO! SELF NOVA PNDA Panda LFFN Scorp AZ AXE Tempo TMPO [A]rmada WBALLZ Westballz PPMD Kreygasm M2K Mang0 USA SCAR TOPH (.Y.) HBOX HungryBox PLUP Shroomed SFAT Wizz Lucky S2J SilentWolf aMSa S2J Hax$".split(" ");vfxQueue=[];
palettes=[["rgb(250, 89, 89)","rgb(255, 170, 170)","rgba(255, 206, 111, ","rgba(244, 68, 68, 0.6)","rgba(255, 225, 167, "],["rgb(4, 255, 134)","rgb(154, 254, 170)","rgba(252, 95, 95, ","rgba(255, 182, 96, 0.6)","rgba(254, 141, 141, "],["rgb(5, 195, 255)","rgb(121, 223, 255)","rgba(218, 96, 254, ","rgba(231, 134, 255, 0.6)","rgba(230, 144, 255, "],["rgb(255, 187, 70)","rgb(248, 255, 122)","rgba(80, 182, 255, ","rgba(255, 142, 70, 0.6)","rgba(139, 203, 249, "],["rgb(177, 89, 255)","rgb(203, 144, 255)",
"rgba(144, 255, 110, ","rgba(247, 126, 250, 0.6)","rgba(190, 255, 170, "],["rgb(182, 131, 70)","rgb(252, 194, 126)","rgba(47, 186, 123, ","rgba(255, 112, 66, 0.6)","rgba(111, 214, 168, "],["rgb(166, 166, 166)","rgb(255, 255, 255)","rgba(255, 255, 255, ","rgba(191, 119, 119, 0.6)","rgba(175, 172, 172, "]];hurtboxColours=["rgba(255, 237, 70, 0.6)","rgba(42, 57, 255, 0.6)","rgba(54, 255, 37, 0.6)"];hasTag=[!1,!1,!1,!1];tagText=["","","",""];pPal=[0,1,2,3];costumeTimeout=[];
colours=["rgba(4, 255, 82, 0.62)","rgba(117, 20, 255, 0.63)","rgba(255, 20, 20, 0.63)","rgba(255, 232, 20, 0.63)"];pause=[[!0,!0],[!0,!0],[!0,!0],[!0,!0]];frameAdvance=[[!0,!0],[!0,!0],[!0,!0],[!0,!0]];startingPoint=[[-50,50],[50,50],[-25,5],[25,5]];startingFace=[1,-1,1,-1];ground=[[-68.4,0],[68.4,0]];platforms=[[[-57.6,27.2],[-20,27.2]],[[20,27.2],[57.6,27.2]],[[-18.8,54.4],[18.8,54.4]]];wallsL=[[[-68.4,0],[-68.4,-108.8]]];wallsR=[[[68.4,0],[68.4,-108.8]]];
edges=[[[-68.4,0],[-63.4,0]],[[68.4,0],[63.4,0]]];cliffcatchOffset=[[-3.5,-22.3],[-4.7,-22.19],[-3.81,-24],[-3.4,-24],[-2.7,-23.74],[-2.34,-23.76],[-2.9,-23.75]];edgeOffset=[[-2.9,-23.7],[2.9,-23.7]];edgeOrientation=[1,-1];respawnPoints=[[-50,50,1],[50,50,-1],[25,35,1],[-25,35,-1]];
stage={box:[new Box2D([-68.4,-108.8],[68.4,0])],platform:[[new Vec2D(-57.6,27.2),new Vec2D(-20,27.2)],[new Vec2D(20,27.2),new Vec2D(57.6,27.2)],[new Vec2D(-18.8,54.4),new Vec2D(18.8,54.4)]],ground:[[new Vec2D(-68.4,0),new Vec2D(68.4,0)]],ceiling:[[new Vec2D(-68.4,-108.8),new Vec2D(68.4,-108.8)]],wallL:[[new Vec2D(-68.4,0),new Vec2D(-68.4,-108.8)]],wallR:[[new Vec2D(68.4,0),new Vec2D(68.4,-108.8)]],startingPoint:[new Vec2D(-50,50),new Vec2D(50,50),new Vec2D(-25,5),new Vec2D(25,5)],startingFace:[1,
-1,1,-1],respawnPoints:[new Vec2D(-50,50),new Vec2D(50,50),new Vec2D(-25,35),new Vec2D(25,35)],respawnFace:[1,-1,1,-1],blastzone:new Box2D([-224,-108.8],[224,200]),ledge:[[0,0],[0,1]],scale:4.5,offset:[600,480]};stageSelect="bf";blastzone=new Box2D([-224,200],[224,-108.8]);starting=!0;startTimer=1.5;matchTimer=480;var keys=[];window.onkeyup=function(a){keys[a.keyCode]=!1};window.onkeydown=function(a){keys[a.keyCode]=!0};
function SVG(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}window.addEventListener("gamepadconnected",function(a){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",a.gamepad.index,a.gamepad.id,a.gamepad.buttons.length,a.gamepad.axes.length)});console.log(navigator.getGamepads());
function matchTimerTick(){matchTimer-=.016667;$("#matchMinutes").empty().append(Math.floor(matchTimer/60));var a=(matchTimer%60).toFixed(2);$("#matchSeconds").empty().append(5>a.length?"0"+a:a);0>=matchTimer&&finishGame()}
function screenShake(a){var b=[Math.random(),Math.random(),Math.random(),Math.random()];c.translate(.1*a*b[0],.1*a*b[1]);setTimeout(function(){c.translate(.05*-a*b[0],.05*-a*b[1])},20);setTimeout(function(){c.translate(.05*-a*b[0],.05*-a*b[1]);c.translate(.1*-a*b[2],.1*-a*b[3])},40);setTimeout(function(){c.translate(.05*a*b[2],.05*a*b[3])},60);setTimeout(function(){c.translate(.05*a*b[2],.05*a*b[3])},80)}
function percentShake(a,b){player[b].percentShake=new Vec2D(.1*a*Math.random(),.1*a*Math.random());setTimeout(function(){player[b].percentShake=new Vec2D(.05*a*Math.random(),.05*a*Math.random())},20);setTimeout(function(){player[b].percentShake=new Vec2D(.1*-a*Math.random(),.1*-a*Math.random())},40);setTimeout(function(){player[b].percentShake=new Vec2D(.05*-a*Math.random(),.05*-a*Math.random())},60);setTimeout(function(){player[b].percentShake=new Vec2D(0,0)},80)}
function findPlayers(){var a=navigator.getGamepads();keyboardOccupied||(2>gameMode?(keys[109]||keys[219])&&4>ports&&(gameMode=1,keyboardOccupied=!0,playSfx("menuForward"),0==ports&&sounds.menu2.play("menu2Start"),addPlayer(ports,4)):(keys[101]||keys[76])&&4>ports&&(keyboardOccupied=!0,addPlayer(ports,4)));for(var b=0;b<a.length;b++){var d=navigator.getGamepads()[b];if("undefined"!=typeof d){var e=0;"v"==d.id[0]||"1"==d.id[0]?e=1:"M"!=d.id[0]&&("G"==d.id[0]||"2"==d.id[0]?(e=2,console.log("You are using raphnet")):
"X"==d.id[0]&&(e=3,console.log("You are using xbox 360")));if(2>gameMode){if(d.buttons[map.s[e]].pressed){for(var d=!1,f=0;f<ports;f++)currentPlayers[f]==b&&(d=!0);!d&&4>ports&&(gameMode=1,playSfx("menuForward"),0==ports&&sounds.menu2.play("menu2Start"),addPlayer(b,e))}}else if(d.buttons[map.a[e]].pressed){d=!1;for(f=0;f<ports;f++)currentPlayers[f]==b&&(d=!0);d||4>ports&&addPlayer(b,e)}}}}function addPlayer(a,b){ports++;currentPlayers[ports-1]=a;playerType[ports-1]=0;mType[ports-1]=b}
function togglePort(a){playerType[a]++;2==playerType[a]&&(playerType[a]=-1);0==playerType[a]&&ports<=a&&(playerType[a]=1)}function positionPlayersInCSS(){for(var a=0;4>a;a++){var b=2*(-80+50*a)/3;player[a].phys.pos=new Vec2D(b,-30);player[a].phys.hurtbox=new Box2D([-4+b,-12],[4+b,-30])}}
function interpretInputs(a,b){if(4==mType[a]){var d=keys[68]?keys[65]?0:1:keys[65]?-1:0,e=keys[87]?keys[83]?0:1:keys[83]?-1:0;if(keys[32]||keys[16])d*=.7,e*=.7;var f=keys[39]?keys[37]?0:1:keys[37]?-1:0,h=keys[38]?keys[40]?0:1:keys[40]?-1:0,q=0,n=0}else{var m=navigator.getGamepads()[currentPlayers[a]],d=m.axes[map.lsX[mType[a]]]-cd[a].ls.x,e=-1*m.axes[map.lsY[mType[a]]]-cd[a].ls.y,d=d/.75,e=e/.75,d=1<d?1:-1>d?-1:Math.round(80*d)/80,e=1<e?1:-1>e?-1:Math.round(80*e)/80;.3>Math.abs(d)&&(d=0);.3>Math.abs(e)&&
(e=0);h=-1*m.axes[map.csY[mType[a]]]-cd[a].cs.y;f=m.axes[map.csX[mType[a]]]-cd[a].cs.x;f/=.75;h/=.75;f=1<f?1:-1>f?-1:Math.round(80*f)/80;h=1<h?1:-1>h?-1:Math.round(80*h)/80;.3>Math.abs(f)&&(f=0);.3>Math.abs(h)&&(h=0);3==mType[a]?(q=m.buttons[map.lA[mType[a]]]-cd[a].l,n=m.buttons[map.rA[mType[a]]]-cd[a].r):(q=m.axes[map.lA[mType[a]]]-cd[a].l,n=m.axes[map.rA[mType[a]]]-cd[a].r,2==mType[a]&&(q*=-1,n*=-1),q+=.9,n+=.9);1<q&&(q=1);1<n&&(n=1);.3>q&&(q=0);.3>n&&(n=0)}pause[a][1]=pause[a][0];frameAdvance[a][1]=
frameAdvance[a][0];4==mType[a]?(pause[a][0]=keys[109]||keys[219]?!0:!1,frameAdvance[a][0]=keys[107]||keys[192]||keys[222]?!0:!1):(pause[a][0]=m.buttons[map.s[mType[a]]].pressed?!0:!1,frameAdvance[a][0]=m.buttons[map.z[mType[a]]].pressed?!0:!1);if(b){for(var g=0;7>g;g++)player[a].inputs.lStickAxis[7-g].x=player[a].inputs.lStickAxis[6-g].x,player[a].inputs.lStickAxis[7-g].y=player[a].inputs.lStickAxis[6-g].y,player[a].inputs.cStickAxis[7-g].x=player[a].inputs.cStickAxis[6-g].x,player[a].inputs.cStickAxis[7-
g].y=player[a].inputs.cStickAxis[6-g].y,player[a].inputs.lAnalog[7-g]=player[a].inputs.lAnalog[6-g],player[a].inputs.rAnalog[7-g]=player[a].inputs.rAnalog[6-g],player[a].inputs.s[7-g]=player[a].inputs.s[6-g],player[a].inputs.z[7-g]=player[a].inputs.z[6-g],player[a].inputs.a[7-g]=player[a].inputs.a[6-g],player[a].inputs.b[7-g]=player[a].inputs.b[6-g],player[a].inputs.x[7-g]=player[a].inputs.x[6-g],player[a].inputs.y[7-g]=player[a].inputs.y[6-g],player[a].inputs.r[7-g]=player[a].inputs.r[6-g],player[a].inputs.l[7-
g]=player[a].inputs.l[6-g],player[a].inputs.dpadleft[7-g]=player[a].inputs.dpadleft[6-g],player[a].inputs.dpaddown[7-g]=player[a].inputs.dpaddown[6-g],player[a].inputs.dpadright[7-g]=player[a].inputs.dpadright[6-g],player[a].inputs.dpadup[7-g]=player[a].inputs.dpadup[6-g];player[a].inputs.lStickAxis[0].x=d;player[a].inputs.lStickAxis[0].y=e;player[a].inputs.cStickAxis[0].x=f;player[a].inputs.cStickAxis[0].y=h;player[a].inputs.lAnalog[0]=q;player[a].inputs.rAnalog[0]=n;4==mType[a]?(player[a].inputs.s[0]=
keys[109]||keys[219],player[a].inputs.x[0]=keys[102]||keys[186],player[a].inputs.a[0]=keys[101]||keys[76],player[a].inputs.b[0]=keys[100]||keys[75],player[a].inputs.y[0]=keys[104]||keys[79],player[a].inputs.r[0]=keys[105]||keys[80],player[a].inputs.l[0]=keys[103]||keys[73],player[a].inputs.dpadleft[0]=keys[86],player[a].inputs.dpaddown[0]=keys[66],player[a].inputs.dpadright[0]=keys[78],player[a].inputs.dpadup[0]=keys[71]):(player[a].inputs.s[0]=m.buttons[map.s[mType[a]]].pressed,player[a].inputs.x[0]=
m.buttons[map.x[mType[a]]].pressed,player[a].inputs.a[0]=m.buttons[map.a[mType[a]]].pressed,player[a].inputs.b[0]=m.buttons[map.b[mType[a]]].pressed,player[a].inputs.y[0]=m.buttons[map.y[mType[a]]].pressed,player[a].inputs.r[0]=m.buttons[map.r[mType[a]]].pressed,player[a].inputs.l[0]=m.buttons[map.l[mType[a]]].pressed,player[a].inputs.dpadleft[0]=m.buttons[map.dl[mType[a]]].pressed,player[a].inputs.dpaddown[0]=m.buttons[map.dd[mType[a]]].pressed,player[a].inputs.dpadright[0]=m.buttons[map.dr[mType[a]]].pressed,
player[a].inputs.dpadup[0]=m.buttons[map.du[mType[a]]].pressed);frameByFrame||(player[a].inputs.z[0]=4==mType[a]?keys[107]||keys[192]||keys[222]:m.buttons[map.z[mType[a]]].pressed,player[a].inputs.z[0]&&(player[a].inputs.lAnalog[0]=.35,player[a].inputs.a[0]=!0));player[a].inputs.l[0]&&(player[a].inputs.lAnalog[0]=1);player[a].inputs.r[0]&&(player[a].inputs.rAnalog[0]=1)}else 4==mType[a]?(keys[101]||keys[76])&&(keys[103]||keys[73])&&(keys[105]||keys[80])&&(keys[109]||keys[219])&&(keys[100]||keys[75]?
startGame():endGame()):m.buttons[map.a[mType[a]]].pressed&&m.buttons[map.l[mType[a]]].pressed&&m.buttons[map.r[mType[a]]].pressed&&m.buttons[map.s[mType[a]]].pressed&&(m.buttons[map.b[mType[a]]].pressed?startGame():endGame()),frameAdvance[a][0]&&!frameAdvance[a][1]&&(frameByFrame=!0);player[a].inputs.dpadleft[0]&&!player[a].inputs.dpadleft[1]&&(player[a].showLedgeGrabBox^=1);player[a].inputs.dpaddown[0]&&!player[a].inputs.dpaddown[1]&&(player[a].showECB^=1);player[a].inputs.dpadright[0]&&!player[a].inputs.dpadright[1]&&
(player[a].showHitbox^=1);4!=mType[a]&&m.buttons[map.du[mType[a]]].pressed&&m.buttons[map.x[mType[a]]].pressed&&m.buttons[map.y[mType[a]]].pressed&&!attemptingControllerReset[a]&&(attemptingControllerReset[a]=!0,setTimeout(function(){m.buttons[map.du[mType[a]]].pressed&&m.buttons[map.x[mType[a]]].pressed&&m.buttons[map.y[mType[a]]].pressed&&(cd[a].ls=new Vec2D(m.axes[0],-1*m.axes[1]),cd[a].cs=new Vec2D(m.axes[5],-1*m.axes[2]),cd[a].l=m.axes[3]+.8,cd[a].r=m.axes[4]+.8,$("#resetIndicator"+a).fadeIn(100),
$("#resetIndicator"+a).fadeOut(500));attemptingControllerReset[a]=!1},2E3));pause[a][0]&&!pause[a][1]&&3==gameMode&&((playing^=1)?sounds.battlefield.volume(0):(playSfx("pause"),sounds.battlefield.volume(0),renderForeground()));0<player[a].phys.lCancelTimer&&(player[a].phys.lCancelTimer--,0==player[a].phys.lCancelTimer&&(player[a].phys.lCancel=!1));0==player[a].phys.lCancelTimer&&(0<player[a].inputs.lAnalog[0]&&0==player[a].inputs.lAnalog[1]||0<player[a].inputs.rAnalog[0]&&0==player[a].inputs.lAnalog[1]||
player[a].inputs.z[0]&&!player[a].inputs.z[1])&&(player[a].phys.lCancelTimer=7,player[a].phys.lCancel=!0);$("#lsAxisX"+a).empty().append(d.toFixed(5));$("#lsAxisY"+a).empty().append(e.toFixed(5));$("#lAnalog"+a).empty().append(q.toFixed(5));$("#rAnalog"+a).empty().append(n.toFixed(5));if(4==mType[a])for(g=0;12>g;g++)(1<keyboardMap[g].length?keys[keyboardMap[g][0]]||keys[keyboardMap[g][1]]||keys[keyboardMap[g][2]]:keys[keyboardMap[g]])?$("#"+a+"button"+g).show():$("#"+a+"button"+g).hide();else for(g=
0;12>g;g++)d=g,0==mType[a]&&(5<d&&d++,7<d&&d++,8<d&&(d+=2)),m.buttons[d].pressed?$("#"+a+"button"+g).show():$("#"+a+"button"+g).hide()}
function land(a,b,d,e){player[a].phys.pos.y=b;player[a].phys.grounded=!0;player[a].phys.doubleJumped=!1;player[a].phys.airborneTimer=0;player[a].phys.fastfalled=!1;player[a].phys.wallJumpCount=0;player[a].phys.sideBJumpFlag=!0;player[a].phys.onSurface=[d,e];player[a].phys.onLedge=-1;switch(player[a].actionState){case 56:break;case 33:player[a].phys.autoCancel?aS[10].init(a):aS[43].init(a);break;case 34:player[a].phys.autoCancel?aS[10].init(a):aS[44].init(a);break;case 35:player[a].phys.autoCancel?
aS[10].init(a):aS[46].init(a);break;case 36:player[a].phys.autoCancel?aS[10].init(a):aS[45].init(a);break;case 37:player[a].phys.autoCancel?aS[10].init(a):aS[42].init(a);break;case 9:case 13:case 15:case 19:case 20:-1<=player[a].phys.cVel.y?aS[0].init(a):aS[10].init(a);break;case 41:aS[10].init(a);break;case 11:player[a].phys.intangibleTimer=0;player[a].phys.hurtBoxState=0;aS[12].init(a);break;case 39:case 40:0<player[a].phys.techTimer?.5<player[a].inputs.lStickAxis[0].x*player[a].phys.face?aS[68].init(a):
-.5>player[a].inputs.lStickAxis[0].x*player[a].phys.face?aS[67].init(a):aS[66].init(a):aS[60].init(a);break;case 69:aS[70].init(a);break;default:aS[12].init(a)}player[a].phys.cVel.y=0;player[a].phys.kVel.y=0;player[a].hit.hitstun=0;player[a].hitboxes.active=[!1,!1,!1,!1]}
function physics(a){player[a].phys.posPrev=new Vec2D(player[a].phys.pos.x,player[a].phys.pos.y);if(0<player[a].hit.hitlag){player[a].hit.hitlag--;if(0==player[a].hit.hitlag&&0<player[a].hit.knockback){if(-1==player[a].phys.grabbedBy||44<player[a].hit.knockback){var b=getLaunchAngle(player[a].hit.angle,player[a].hit.knockback,player[a].hit.reverse,player[a].inputs.lStickAxis[0].x,player[a].inputs.lStickAxis[0].y,a);player[a].phys.cVel.x=0;player[a].phys.cVel.y=0;player[a].phys.kVel.x=getHorizontalVelocity(player[a].hit.knockback,
b);player[a].phys.kVel.y=getVerticalVelocity(player[a].hit.knockback,b,player[a].phys.grounded,player[a].hit.angle);player[a].phys.kDec.x=getHorizontalDecay(b);player[a].phys.kDec.y=getVerticalDecay(b);player[a].phys.onLedge=-1;player[a].phys.charging=!1;player[a].phys.shielding=!1;player[a].phys.grounded&&(0==b||270<b?(player[a].phys.kVel.y=0,player[a].phys.kDec.x=player[a].charAttributes.traction):180<b&&(player[a].phys.kVel.y=0,player[a].phys.kDec.x=-player[a].charAttributes.traction));0<player[a].phys.kVel.y&&
(player[a].phys.grounded=!1)}player[a].hit.knockback=0}switch(player[a].actionState){case 41:case 39:case 21:case 22:if(0<player[a].hit.hitlag){if(.7<player[a].inputs.lStickAxis[0].x&&.7>player[a].inputs.lStickAxis[1].x||-.7>player[a].inputs.lStickAxis[0].x&&-.7<player[a].inputs.lStickAxis[1].x||.7<player[a].inputs.lStickAxis[0].y&&.7>player[a].inputs.lStickAxis[1].y||-.7>player[a].inputs.lStickAxis[0].y&&-.7<player[a].inputs.lStickAxis[1].y)player[a].phys.pos.x+=6*player[a].inputs.lStickAxis[0].x,
player[a].phys.pos.y+=player[a].phys.grounded?0:6*player[a].inputs.lStickAxis[0].y}else player[a].phys.pos.x+=3*player[a].inputs.lStickAxis[0].x,player[a].phys.pos.y+=player[a].phys.grounded?0:3*player[a].inputs.lStickAxis[0].y}}0==player[a].hit.hitlag&&(0<player[a].hit.shieldstun&&(player[a].hit.shieldstun--,0>player[a].hit.shieldstun&&(player[a].hit.shieldstun=0)),player[a].phys.canWallJump=aS[player[a].actionState].wallJumpAble,aS[player[a].actionState].main(a),0<Math.abs(player[a].phys.kVel.x)&&
(b=Math.sign(player[a].phys.kVel.x),player[a].phys.kVel.x-=player[a].phys.kDec.x,b!=Math.sign(player[a].phys.kVel.x)&&(player[a].phys.kVel.x=0)),0<Math.abs(player[a].phys.kVel.y)&&(b=Math.sign(player[a].phys.kVel.y),player[a].phys.kVel.y-=player[a].phys.kDec.y,b!=Math.sign(player[a].phys.kVel.y)&&(player[a].phys.kVel.y=0)),68==player[a].actionState||67==player[a].actionState?(player[a].phys.pos.x+=player[a].phys.cVel.x,player[a].phys.pos.y+=player[a].phys.cVel.y):(player[a].phys.pos.x+=player[a].phys.cVel.x+
player[a].phys.kVel.x,player[a].phys.pos.y+=player[a].phys.cVel.y+player[a].phys.kVel.y));player[a].phys.hurtBoxState=30==player[a].actionState||31==player[a].actionState?1:0;0<player[a].phys.invincibleTimer&&(player[a].phys.invincibleTimer--,player[a].phys.hurtBoxState=2);0<player[a].phys.intangibleTimer&&(player[a].phys.intangibleTimer--,player[a].phys.hurtBoxState=1);if(-20<player[a].phys.techTimer)player[a].phys.techTimer--;else if(player[a].inputs.l[0]&&!player[a].inputs.l[1]||player[a].inputs.r[0]&&
!player[a].inputs.r[1])player[a].phys.techTimer=20;var d=player[a].phys.pos.x,e=player[a].phys.pos.y;player[a].phys.grounded||player[a].phys.airborneTimer++;player[a].phys.ECBp=11==player[a].actionState?[new Vec2D(0+d,1+e),new Vec2D(3+d,9+e),new Vec2D(0+d,14+e),new Vec2D(-3+d,9+e)]:24==player[a].actionState?[new Vec2D(0+d,1+e),new Vec2D(2+d,9+e),new Vec2D(0+d,14+e),new Vec2D(-2+d,9+e)]:player[a].phys.grounded||10>player[a].phys.airborneTimer?[new Vec2D(0+d,0+e),new Vec2D(3+d,7+e),new Vec2D(0+d,14+
e),new Vec2D(-3+d,7+e)]:[new Vec2D(0+d,4+e),new Vec2D(3+d,9+e),new Vec2D(0+d,14+e),new Vec2D(-3+d,9+e)];for(b=0;b<stage.platform.length;b++)player[a].phys.abovePlatforms[b]&&player[a].phys.ECBp[0].y<stage.platform[b][0].y&&player[a].phys.ECBp[0].x>stage.platform[b][0].x&&player[a].phys.ECBp[0].x<stage.platform[b][1].x&&(-.56<player[a].inputs.lStickAxis[0].y&&aS[player[a].actionState].canPassThrough||!aS[player[a].actionState].canPassThrough)&&(0<player[a].hit.hitlag?player[a].phys.pos.y=stage.platform[b][0].y:
land(a,stage.platform[b][0].y,1,b));for(b=0;b<stage.platform.length;b++)player[a].phys.abovePlatforms[b]=player[a].phys.ECBp[0].y>stage.platform[b][0].y?!0:!1;if(player[a].phys.grounded){b=!0;if(0==player[a].phys.onSurface[0]){var f=player[a].phys.onSurface[1];player[a].phys.ECBp[0].x<stage.ground[f][0].x-.1?aS[player[a].actionState].canEdgeCancel?-.6>player[a].inputs.lStickAxis[0].x||1==player[a].phys.face?b=!1:0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=
stage.ground[f][0].x,aS[0].init(a)):0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x&&(74>player[a].actionState||84<player[a].actionState)?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.ground[f][0].x):player[a].phys.ECBp[0].x>stage.ground[f][1].x+.1&&(aS[player[a].actionState].canEdgeCancel?.6<player[a].inputs.lStickAxis[0].x||-1==player[a].phys.face?b=!1:0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.ground[f][1].x,aS[0].init(a)):
0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x&&(74>player[a].actionState||84<player[a].actionState)?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.ground[f][1].x))}else f=player[a].phys.onSurface[1],player[a].phys.ECBp[0].x<stage.platform[f][0].x-.1?aS[player[a].actionState].canEdgeCancel?-.6>player[a].inputs.lStickAxis[0].x||1==player[a].phys.face?b=!1:0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.platform[f][0].x,aS[0].init(a)):
0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x&&(74>player[a].actionState||84<player[a].actionState)?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.platform[f][0].x):player[a].phys.ECBp[0].x>stage.platform[f][1].x+.1&&(aS[player[a].actionState].canEdgeCancel?.6<player[a].inputs.lStickAxis[0].x||-1==player[a].phys.face?b=!1:0==player[a].phys.cVel.x&&0==player[a].phys.kVel.x?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.platform[f][1].x,aS[0].init(a)):0==player[a].phys.cVel.x&&
0==player[a].phys.kVel.x&&(74>player[a].actionState||84<player[a].actionState)?b=!1:(player[a].phys.cVel.x=0,player[a].phys.pos.x=stage.platform[f][1].x));b||(player[a].phys.grounded=!1,player[a].phys.shielding=!1,aS[13].init(a),Math.abs(player[a].phys.cVel.x)>player[a].charAttributes.aerialHmaxV&&(player[a].phys.cVel.x=Math.sign(player[a].phys.cVel.x)*player[a].charAttributes.aerialHmaxV))}f=[!0,!0];for(b=0;b<stage.wallL.length;b++)player[a].phys.ECBp[1].y<stage.wallL[b][0].y&&player[a].phys.ECBp[1].y>
stage.wallL[b][1].y&&player[a].phys.ECBp[1].x>=stage.wallL[b][1].x&&player[a].phys.ECBp[1].x<stage.wallL[b][1].x+5&&(f[0]=!1,player[a].phys.pos.x-=player[a].phys.ECBp[1].x-stage.wallL[b][1].x,39==player[a].actionState?0==player[a].hit.hitlag&&(player[a].phys.face=-1,0<player[a].phys.techTimer?player[a].inputs.x[0]||player[a].inputs.y[0]||.7<player[a].inputs.lStickAxis[0].y?aS[92].init(a):aS[90].init(a):(drawVfx("wallBounce",new Vec2D(stage.wallL[b][1].x,player[a].phys.ECBp[1].y),-1,0),aS[89].init(a))):
player[a].phys.canWallJump&&(254==player[a].phys.wallJumpTimer&&.5<=player[a].phys.posDelta.x&&(player[a].phys.wallJumpTimer=0),0<=player[a].phys.wallJumpTimer&&120>player[a].phys.wallJumpTimer&&(-.7>=player[a].inputs.lStickAxis[0].x&&0<=player[a].inputs.lStickAxis[3].x?(player[a].phys.wallJumpTimer=254,player[a].phys.face=-1,aS[91].init(a)):player[a].phys.wallJumpTimer++)));for(b=0;b<stage.wallR.length;b++)player[a].phys.ECBp[3].y<stage.wallR[b][0].y&&player[a].phys.ECBp[3].y>stage.wallR[b][1].y&&
player[a].phys.ECBp[3].x<=stage.wallR[b][1].x&&player[a].phys.ECBp[3].x>stage.wallR[b][1].x-5&&(f[1]=!1,player[a].phys.pos.x-=player[a].phys.ECBp[3].x-stage.wallR[b][1].x,39==player[a].actionState?0==player[a].hit.hitlag&&(player[a].phys.face=1,0<player[a].phys.techTimer?player[a].inputs.x[0]||player[a].inputs.y[0]||.7<player[a].inputs.lStickAxis[0].y?aS[92].init(a):aS[90].init(a):(drawVfx("wallBounce",new Vec2D(stage.wallR[b][1].x,player[a].phys.ECBp[3].y),1,1),aS[89].init(a))):player[a].phys.canWallJump&&
(254==player[a].phys.wallJumpTimer&&.5<=player[a].phys.posDelta.x&&(player[a].phys.wallJumpTimer=0),0<=player[a].phys.wallJumpTimer&&120>player[a].phys.wallJumpTimer&&(.7<=player[a].inputs.lStickAxis[0].x&&0>=player[a].inputs.lStickAxis[3].x?(player[a].phys.wallJumpTimer=254,player[a].phys.face=1,aS[91].init(a)):player[a].phys.wallJumpTimer++)));f[0]&&f[1]&&player[a].phys.canWallJump&&(player[a].phys.wallJumpTimer=254);if(player[a].phys.grounded)for(b=0;4>b;b++)-1<playerType[b]&&a!=b&&player[b].phys.grounded&&
player[b].phys.onSurface[0]==player[a].phys.onSurface[0]&&player[b].phys.onSurface[1]==player[a].phys.onSurface[1]&&player[a].phys.grabbing!=b&&player[a].phys.grabbedBy!=b&&(f=Math.abs(player[a].phys.pos.x-player[b].phys.pos.x),6.5>f&&0<f?player[b].phys.pos.x+=-.3*Math.sign(player[a].phys.pos.x-player[b].phys.pos.x):0==f&&Math.abs(player[a].phys.cVel.x)>Math.abs(player[b].phys.cVel.x)&&(player[b].phys.pos.x+=-.3*Math.sign(player[a].phys.cVel.x)));0==player[a].phys.shielding&&(player[a].phys.shieldHP+=
.07,60<player[a].phys.shieldHP&&(player[a].phys.shieldHP=60));d=player[a].phys.pos.x;e=player[a].phys.pos.y;player[a].phys.ECB1=11==player[a].actionState?[new Vec2D(0+d,1+e),new Vec2D(3+d,9+e),new Vec2D(0+d,14+e),new Vec2D(-3+d,9+e)]:24==player[a].actionState?[new Vec2D(0+d,1+e),new Vec2D(2+d,9+e),new Vec2D(0+d,14+e),new Vec2D(-2+d,9+e)]:player[a].phys.grounded||10>player[a].phys.airborneTimer?[new Vec2D(0+d,0+e),new Vec2D(3+d,7+e),new Vec2D(0+d,14+e),new Vec2D(-3+d,7+e)]:[new Vec2D(0+d,4+e),new Vec2D(3+
d,9+e),new Vec2D(0+d,14+e),new Vec2D(-3+d,9+e)];if(!player[a].phys.grounded){for(b=0;b<stage.ground.length;b++)if(player[a].phys.ECB1[0].y<stage.ground[b][0].y&&player[a].phys.ECB1[0].x>stage.ground[b][0].x&&player[a].phys.ECB1[0].x<stage.ground[b][1].x&&player[a].phys.ECB1[2].y>stage.ceiling[b][0].y)if(player[a].phys.posPrev.y+(player[a].phys.ECB1[0].y-player[a].phys.pos.y)<stage.ceiling[b][0].y)player[a].phys.pos.y=stage.ceiling[b][0].y-14,aS[player[a].actionState].headBonk&&(player[a].phys.cVel.y=
0,aS[13].init(a));else{0<player[a].hit.hitlag?player[a].phys.pos.y=stage.ground[b][0].y:land(a,stage.ground[b][0].y,0,b);break}for(b=0;b<stage.ceiling.length;b++)player[a].phys.ECB1[2].y>stage.ceiling[b][0].y&&player[a].phys.ECB1[0].x>stage.ceiling[b][0].x&&player[a].phys.ECB1[0].x<stage.ceiling[b][1].x&&(f=stage.ground[0][0].y,"undefined"!=typeof stage.ground[b]&&(f=stage.ground[b][0].y),player[a].phys.ECB1[2].y<f&&(player[a].phys.pos.y=stage.ceiling[b][0].y-14,aS[player[a].actionState].headBonk&&
(player[a].phys.cVel.y=0,aS[13].init(a))))}player[a].phys.hurtbox=new Box2D([-4+d,18+e],[4+d,e]);player[a].phys.ledgeSnapBoxF=new Box2D([player[a].phys.pos.x,player[a].phys.pos.y+22],[player[a].phys.pos.x+14,player[a].phys.pos.y+12]);player[a].phys.ledgeSnapBoxB=new Box2D([player[a].phys.pos.x-14,player[a].phys.pos.y+22],[player[a].phys.pos.x,player[a].phys.pos.y+12]);player[a].phys.ledgeRegrabCount&&(player[a].phys.ledgeRegrabTimeout--,0==player[a].phys.ledgeRegrabTimeout&&(player[a].phys.ledgeRegrabCount=
!1));var h=f=-1;if(-1==player[a].phys.onLedge&&!player[a].phys.ledgeRegrabCount)for(b=0;b<stage.ledge.length;b++){d=!0;for(e=0;4>e;e++)-1<playerType[e]&&e!=a&&player[e].phys.onLedge==b&&(d=!1);d&&(d=stage.ledge[b][1]?stage.box[stage.ledge[b][0]].max.x:stage.box[stage.ledge[b][0]].min.x,e=stage.box[stage.ledge[b][0]].max.y,d>player[a].phys.ledgeSnapBoxF.min.x&&d<player[a].phys.ledgeSnapBoxF.max.x&&e<player[a].phys.ledgeSnapBoxF.min.y&&e>player[a].phys.ledgeSnapBoxF.max.y&&0==stage.ledge[b][1]&&(player[a].phys.grounded||
aS[player[a].actionState].canGrabLedge[0]&&(f=b)),d>player[a].phys.ledgeSnapBoxB.min.x&&d<player[a].phys.ledgeSnapBoxB.max.x&&e<player[a].phys.ledgeSnapBoxB.min.y&&e>player[a].phys.ledgeSnapBoxF.max.y&&1==stage.ledge[b][1]&&(player[a].phys.grounded||aS[player[a].actionState].canGrabLedge[0]&&(h=b)));0>player[a].phys.cVel.y&&-.5<player[a].inputs.lStickAxis[0].y&&(-1<f?-2*stage.ledge[f][1]+1==player[a].phys.face&&(player[a].phys.onLedge=f,player[a].phys.ledgeRegrabTimeout=30,player[a].phys.face=-2*
stage.ledge[f][1]+1,player[a].phys.pos=new Vec2D(stage.box[stage.ledge[f][0]].min.x+edgeOffset[0][0],stage.box[stage.ledge[f][0]].min.y+edgeOffset[0][1]),aS[24].init(a)):-1<h&&-2*stage.ledge[h][1]+1==player[a].phys.face&&(player[a].phys.onLedge=h,player[a].phys.ledgeRegrabTimeout=30,player[a].phys.face=-2*stage.ledge[h][1]+1,player[a].phys.pos=new Vec2D(stage.box[stage.ledge[h][0]].max.x+edgeOffset[1][0],stage.box[stage.ledge[h][0]].min.y+edgeOffset[1][1]),aS[24].init(a)))}(26>player[a].actionState||
29<player[a].actionState)&&93!=player[a].actionState&&(b=0,player[a].phys.pos.x<stage.blastzone.min.x?b=26:player[a].phys.pos.x>stage.blastzone.max.x?b=27:player[a].phys.pos.y<stage.blastzone.min.y?b=29:player[a].phys.pos.y>stage.blastzone.max.y&&(b=28),0<b&&(player[a].stocks--,lostStockQueue.push([a,player[a].stocks,0]),0==player[a].stocks&&versusMode&&(player[a].stocks=1),aS[b].init(a)));-80<player[a].phys.posPrev.y&&-80>=player[a].phys.pos.y&&playSfx("lowdown");player[a].phys.posDelta=new Vec2D(Math.abs(player[a].phys.pos.x-
player[a].phys.posPrev.x),Math.abs(player[a].phys.pos.y-player[a].phys.posPrev.y));$("#velocityX"+a).empty().append(player[a].phys.cVel.x.toFixed(5));$("#velocityY"+a).empty().append(player[a].phys.cVel.y.toFixed(5));$("#kvelocityX"+a).empty().append(player[a].phys.kVel.x.toFixed(5));$("#kvelocityY"+a).empty().append(player[a].phys.kVel.y.toFixed(5));$("#pvelocityX"+a).empty().append(player[a].phys.pos.x.toFixed(5));$("#pvelocityY"+a).empty().append(player[a].phys.pos.y.toFixed(5))}canvas=c=0;
function renderVfx(){for(var a=[],b=0;b<vfxQueue.length;b++)if(vfxQueue[b][1]++,vfxQueue[b][0].frames>=vfxQueue[b][1]){if(showVfx)if("s"==vfxQueue[b][0].name[0]&&"w"==vfxQueue[b][0].name[1])dVfx.swing(b);else dVfx[vfxQueue[b][0].name](b)}else a.push(b);for(b=0;b<a.length;b++)vfxQueue.splice(a[b]-b,1)}
function drawVfx(a,b,d,e){"undefined"===typeof e&&(e=-1);var f={};$.extend(!0,f,vfx[a]);"circleDust"==f.name&&(f.circles[0]=-2*Math.random(),f.circles[1]=Math.random()*-stage.scale-2,f.circles[2]=2*Math.random(),f.circles[3]=Math.random()*stage.scale+2);a=new Vec2D(b.x,b.y);vfxQueue.push([f,0,a,d,e])}function update(a){starting||0==playerType[a]&&-1!=currentPlayers[a]&&interpretInputs(a,!0);physics(a)}lastFrameTimeMs=delta=0;lastUpdate=performance.now();
function gameTick(){var a=performance.now(),b=0;if(0==gameMode)findPlayers();else if(1==gameMode)for(var d=0;d<ports;d++)interpretInputs(d,!0),menuMove(d);else if(2==gameMode){for(d=0;4>d;d++)d<ports&&(interpretInputs(d,!0),cssControls(d)),aS[player[d].actionState].main(d);for(d=0;4>d;d++)-1<playerType[d]&&hitDetection(d);executeHits();hitQueue=[];findPlayers()}else if(6==gameMode)for(d=0;4>d;d++)d<ports&&(interpretInputs(d,!0),sssControls(d));else if(7==gameMode)interpretInputs(targetPlayer,!0),
tssControls(targetPlayer);else if(4==gameMode)interpretInputs(targetBuilder,!0),targetBuilderControls(targetBuilder);else if(5==gameMode)endTargetGame&&finishGame(),playing||frameByFrame?(lastUpdate=b=performance.now(),update(targetBuilder),targetHitDetection(targetBuilder),starting||versusMode?(startTimer-=.01666667,0>startTimer&&(starting=!1)):targetTimerTick(),player[targetBuilder].inputs.s[0]&&!player[targetBuilder].inputs.s[1]&&endGame(),frameByFrame=!1,b=performance.now()-a,gamelogicTime[0]+=
b,gamelogicTime[0]/=2,10<=b&&gamelogicTime[3]++,b<gamelogicTime[2]&&(gamelogicTime[2]=b),b>gamelogicTime[1]&&(gamelogicTime[1]=b),$("#gamelogicAvg").empty().append(Math.round(gamelogicTime[0])),$("#gamelogicHigh").empty().append(Math.round(gamelogicTime[1])),$("#gamelogicLow").empty().append(Math.round(gamelogicTime[2])),$("#gamelogicPeak").empty().append(gamelogicTime[3])):gameEnd||interpretInputs(targetBuilder,!1);else if(playing||frameByFrame){lastUpdate=b=performance.now();hitQueue=[];stage.movingPlatforms();
for(d=0;4>d;d++)-1<playerType[d]&&update(d);for(d=0;4>d;d++)-1<playerType[d]&&hitDetection(d);executeHits();starting||versusMode?(startTimer-=.01666667,0>startTimer&&(starting=!1)):matchTimerTick();frameByFrame=!1;b=performance.now()-a;gamelogicTime[0]+=b;gamelogicTime[0]/=2;10<=b&&gamelogicTime[3]++;b<gamelogicTime[2]&&(gamelogicTime[2]=b);b>gamelogicTime[1]&&(gamelogicTime[1]=b);$("#gamelogicAvg").empty().append(Math.round(gamelogicTime[0]));$("#gamelogicHigh").empty().append(Math.round(gamelogicTime[1]));
$("#gamelogicLow").empty().append(Math.round(gamelogicTime[2]));$("#gamelogicPeak").empty().append(gamelogicTime[3])}else if(findingPlayers)findPlayers();else if(!gameEnd)for(d=0;4>d;d++)0==playerType[d]&&-1!=currentPlayers[d]&&interpretInputs(d,!1);setTimeout(gameTick,16-b)}otherFrame=!0;fps30=!1;
function renderTick(){window.requestAnimationFrame(renderTick);otherFrame^=1;if(fps30&&otherFrame||!fps30){if(0==gameMode)drawStartScreen();else if(1==gameMode)drawMainMenu();else if(2==gameMode)drawCSS();else if(6==gameMode)drawSSS();else if(7==gameMode)drawTSS();else if(4==gameMode)renderTargetBuilder();else if(5==gameMode){if(playing||frameByFrame){var a=performance.now();c.fillStyle="rgba(0, 0, 0, 1)";c.fillRect(0,0,canvas.width,canvas.height);showVfx&&drawBackground();drawStage();renderPlayer(targetBuilder);
renderVfx();renderOverlay(!1);a=performance.now()-a;renderTime[0]+=a;renderTime[0]/=2;10<=a&&renderTime[3]++;a>renderTime[1]&&(renderTime[1]=a);a<renderTime[2]&&(renderTime[2]=a);$("#renderAvg").empty().append(Math.round(renderTime[0]));$("#renderHigh").empty().append(Math.round(renderTime[1]));$("#renderLow").empty().append(Math.round(renderTime[2]));$("#renderPeak").empty().append(renderTime[3])}}else if(playing||frameByFrame){a=performance.now();c.fillStyle="rgba(0, 0, 0, 1)";c.fillRect(0,0,canvas.width,
canvas.height);showVfx&&drawBackground();drawStage();for(var b=0;4>b;b++)-1<playerType[b]&&renderPlayer(b);renderVfx();renderOverlay(!0);a=performance.now()-a;renderTime[0]+=a;renderTime[0]/=2;10<=a&&renderTime[3]++;a>renderTime[1]&&(renderTime[1]=a);a<renderTime[2]&&(renderTime[2]=a);$("#renderAvg").empty().append(Math.round(renderTime[0]));$("#renderHigh").empty().append(Math.round(renderTime[1]));$("#renderLow").empty().append(Math.round(renderTime[2]));$("#renderPeak").empty().append(renderTime[3])}frameByFrame&&
renderForeground()}}function buildPlayerObject(a){player[a]=new playerObject(charSelect[a],startingPoint[a],startingFace[a])}for(var i=0;4>i;i++)buildPlayerObject(i),player[i].phys.face=1,player[i].actionState=0;function initializePlayers(a,b){buildPlayerObject(a);b?drawVfx("entrance",new Vec2D(stage.startingPoint.x,stage.startingPoint.y)):drawVfx("entrance",new Vec2D(startingPoint[a][0],startingPoint[a][1]))}
function drawStage(){c.strokeStyle="#db80cc";c.lineWidth=1;for(var a=0;a<stage.ground.length;a++)c.beginPath(),c.moveTo(stage.ground[a][0].x*stage.scale+stage.offset[0],stage.ground[a][0].y*-stage.scale+stage.offset[1]),c.lineTo(stage.ground[a][1].x*stage.scale+stage.offset[0],stage.ground[a][1].y*-stage.scale+stage.offset[1]),c.closePath(),c.stroke();c.strokeStyle="#ed6767";for(a=0;a<stage.ceiling.length;a++)c.beginPath(),c.moveTo(stage.ceiling[a][0].x*stage.scale+stage.offset[0],stage.ceiling[a][0].y*
-stage.scale+stage.offset[1]),c.lineTo(stage.ceiling[a][1].x*stage.scale+stage.offset[0],stage.ceiling[a][1].y*-stage.scale+stage.offset[1]),c.closePath(),c.stroke();for(a=0;a<stage.box.length;a++)c.fillRect(stage.box[a].min.x*stage.scale+stage.offset[0],stage.box[a].max.y*-stage.scale+stage.offset[1],(stage.box[a].max.x-stage.box[a].min.x)*stage.scale,(stage.box[a].max.y-stage.box[a].min.y)*stage.scale);c.strokeStyle="#4794c6";for(a=0;a<stage.platform.length;a++)c.beginPath(),c.moveTo(stage.platform[a][0].x*
stage.scale+stage.offset[0],stage.platform[a][0].y*-stage.scale+stage.offset[1]),c.lineTo(stage.platform[a][1].x*stage.scale+stage.offset[0],stage.platform[a][1].y*-stage.scale+stage.offset[1]),c.closePath(),c.stroke();c.strokeStyle="#47c648";for(var b=0;b<stage.wallL.length;b++)c.beginPath(),c.moveTo(stage.wallL[b][0].x*stage.scale+stage.offset[0],stage.wallL[b][0].y*-stage.scale+stage.offset[1]),c.lineTo(stage.wallL[b][1].x*stage.scale+stage.offset[0],stage.wallL[b][1].y*-stage.scale+stage.offset[1]),
c.closePath(),c.stroke();c.strokeStyle="#9867de";for(a=0;a<stage.wallR.length;a++)c.beginPath(),c.moveTo(stage.wallR[a][0].x*stage.scale+stage.offset[0],stage.wallR[a][0].y*-stage.scale+stage.offset[1]),c.lineTo(stage.wallR[a][1].x*stage.scale+stage.offset[0],stage.wallR[a][1].y*-stage.scale+stage.offset[1]),c.closePath(),c.stroke();c.strokeStyle="#e7a44c";for(a=0;a<stage.ledge.length;a++)b=stage.ledge[a],c.beginPath(),b[1]?(c.moveTo(stage.box[b[0]].max.x*stage.scale+stage.offset[0],(stage.box[b[0]].max.y-
Math.min(10,(stage.box[b[0]].max.y-stage.box[b[0]].min.y)/2))*-stage.scale+stage.offset[1]),c.lineTo(stage.box[b[0]].max.x*stage.scale+stage.offset[0],stage.box[b[0]].max.y*-stage.scale+stage.offset[1]),c.lineTo((stage.box[b[0]].max.x-Math.min(10,(stage.box[b[0]].max.x-stage.box[b[0]].min.x)/2))*stage.scale+stage.offset[0],stage.box[b[0]].max.y*-stage.scale+stage.offset[1])):(c.moveTo(stage.box[b[0]].min.x*stage.scale+stage.offset[0],(stage.box[b[0]].max.y-Math.min(10,(stage.box[b[0]].max.y-stage.box[b[0]].min.y)/
2))*-stage.scale+stage.offset[1]),c.lineTo(stage.box[b[0]].min.x*stage.scale+stage.offset[0],stage.box[b[0]].max.y*-stage.scale+stage.offset[1]),c.lineTo((stage.box[b[0]].min.x+Math.min(10,(stage.box[b[0]].max.x-stage.box[b[0]].min.x)/2))*stage.scale+stage.offset[0],stage.box[b[0]].max.y*-stage.scale+stage.offset[1])),c.closePath(),c.stroke(),c.fill(),c.fill();if("undefined"!=typeof stage.target)for(b=0;b<stage.target.length;b++)if(!targetDestroyed[b])for(var d=stage.target[b].x*stage.scale+stage.offset[0],
e=stage.target[b].y*-stage.scale+stage.offset[1],a=0;5>a;a++)c.fillStyle=a%2?"white":"red",c.beginPath(),c.arc(d,e,stage.scale/4.5*(25-5*a),0,twoPi),c.closePath(),c.fill()}var bgPos=[[-30,500,300,500,900,500,1230,450,358],[-30,400,300,400,900,400,1230,350,179]],direction=[[1,-1,1,-1,1,-1,1,-1,1],[-1,1,-1,1,-1,1,-1,1,-1]];
function bgStar(){var a=Math.random();this.velocity=new Vec2D(5*a*Math.sign(.5-Math.random()),5*(1-a)*Math.sign(.5-Math.random()));this.colour="hsl("+358*Math.random()+", 100%, 50%)";this.pos=new Vec2D(0,0);this.life=0}bgStars=[];for(p=0;20>p;p++)bgStars[p]=new bgStar,bgStars[p].pos=new Vec2D(600*Math.random()*Math.sign(bgStars[p].velocity.x),400*Math.random()*Math.sign(bgStars[p].velocity.y));bgSparkle=3;
function drawBackground(){bgSparkle--;var a=c.createLinearGradient(0,0,0,500);a.addColorStop(0,"rgb(24, 17, 66)");a.addColorStop(1,"black");c.fillStyle=a;c.fillRect(-100,-100,canvas.width+200,canvas.height+200);for(a=0;20>a;a++){if(600<Math.abs(bgStars[a].pos.x)||400<Math.abs(bgStars[a].pos.y))bgStars[a]=new bgStar;bgStars[a].pos.x+=bgStars[a].velocity.x;bgStars[a].pos.y+=bgStars[a].velocity.y;bgStars[a].life++;0==bgSparkle&&(c.fillStyle=bgStars[a].colour,c.globalAlpha=Math.min(bgStars[a].life/300,
1),c.beginPath(),c.arc(600+bgStars[a].pos.x,375+bgStars[a].pos.y,5,twoPi,0),c.fill())}0==bgSparkle&&(bgSparkle=2);for(a=c.globalAlpha=1;-1<a;a--){for(var b=0;9>b;b++)switch(bgPos[a][b]=8==b?bgPos[a][b]+.2*direction[a][b]*Math.random():bgPos[a][b]+1*direction[a][b]*Math.random(),b){case 0:if(1==direction[a][b]&&-10<bgPos[a][b]||-1==direction[a][b]&&-200>bgPos[a][b])direction[a][b]*=-1;break;case 1:if(1==direction[a][b]&&bgPos[a][b]>550-100*a||-1==direction[a][b]&&bgPos[a][b]<450-100*a)direction[a][b]*=
-1;break;case 2:if(1==direction[a][b]&&550<bgPos[a][b]||-1==direction[a][b]&&0>bgPos[a][b])direction[a][b]*=-1;break;case 3:if(1==direction[a][b]&&bgPos[a][b]>550-100*a||-1==direction[a][b]&&bgPos[a][b]<450-100*a)direction[a][b]*=-1;break;case 4:if(1==direction[a][b]&&1150<bgPos[a][b]||-1==direction[a][b]&&600>bgPos[a][b])direction[a][b]*=-1;break;case 5:if(1==direction[a][b]&&bgPos[a][b]>550-100*a||-1==direction[a][b]&&bgPos[a][b]<450-100*a)direction[a][b]*=-1;break;case 6:if(1==direction[a][b]&&
1400<bgPos[a][b]||-1==direction[a][b]&&1210>bgPos[a][b])direction[a][b]*=-1;break;case 7:if(1==direction[a][b]&&bgPos[a][b]>550-100*a||-1==direction[a][b]&&bgPos[a][b]<450-100*a)direction[a][b]*=-1;break;case 8:if(1==direction[a][b]&&357<bgPos[a][b]||-1==direction[a][b]&&1>bgPos[a][b])direction[a][b]*=-1}c.fillStyle="hsla("+bgPos[a][8]+", 100%, 50%, "+(.15-.07*a)+")";c.beginPath();c.moveTo(bgPos[a][0],bgPos[a][1]);c.bezierCurveTo(bgPos[a][2],bgPos[a][3],bgPos[a][4],bgPos[a][5],bgPos[a][6],bgPos[a][7]);
1==a?(c.lineTo(bgPos[0][6],bgPos[0][7]),c.bezierCurveTo(bgPos[0][4],bgPos[0][5],bgPos[0][2],bgPos[0][3],bgPos[0][0],bgPos[0][1])):(c.lineTo(1200,750),c.lineTo(0,750));c.closePath();c.fill()}}
function startGame(){gameMode=3;vfxQueue=[];for(var a=0;4>a;a++)-1<playerType[a]&&(initializePlayers(a,!1),renderPlayer(a),player[a].inCSS=!1),versusMode&&(player[a].stocks=1);matchTimer=480;startTimer=1.5;starting=!0;sounds.menu2.stop();sounds.battlefield.stop();sounds.battlefield.play("battlefieldStart");drawVfx("start",new Vec2D(0,0));findingPlayers=!1;playing=!0;stage=stages[stageSelect]}
function endGame(){gameEnd=!1;lostStockQueue=[];sounds.battlefield.stop();playing=!1;c.fillStyle="rgba(0, 0, 0, 1)";c.fillRect(-100,-100,canvas.width+200,canvas.height+200);drawStage();3==gameMode?gameMode=2:5==gameMode&&(gameMode=targetTesting?4:7);sounds.menu2.play("menu2Start");pause=[[!0,!0],[!0,!0],[!0,!0],[!0,!0]];frameAdvance=[[!0,!0],[!0,!0],[!0,!0],[!0,!0]];findingPlayers=!0;positionPlayersInCSS();for(var a=0;4>a;a++)-1<playerType[a]&&(72==player[a].actionState&&sounds.furaloop.stop(player[a].furaLoopID),
player[a].inputs.a[0]=!0,player[a].inputs.a[1]=!0,player[a].inCSS=!0,player[a].phys.face=1,player[a].actionState=0,player[a].timer=0)}
function finishGame(){endTargetGame=!1;gameEnd=!0;playing=!1;c.save();c.textAlign="center";var a="Game!",b=300,d=1,e=c.createLinearGradient(0,200,0,520);if(5==gameMode||8==gameMode)if(stage.target.length==targetsDestroyed){if(targetTesting)playSfx("complete");else{if(10>targetStagePlaying)for(a=0;3>a;a++)medalsEarned[targetStagePlaying][a]||matchTimer<=medalTimes[targetStagePlaying][a]&&(medalsEarned[targetStagePlaying][a]=!0);matchTimer<targetRecords[targetStagePlaying]||-1==targetRecords[targetStagePlaying]?
(targetRecords[targetStagePlaying]=matchTimer,10>targetStagePlaying&&matchTimer<worldRecords[targetStagePlaying]&&(worldRecords[targetStagePlaying]=matchTimer),playSfx("newRecord")):playSfx("complete")}a="Complete!";b=200;d=1.5;e=c.createLinearGradient(0,200/d,0,520/d);e.addColorStop(0,"black");e.addColorStop(.4,"black");e.addColorStop(.8,"rgb(150, 86, 46)");e.addColorStop(1,"rgb(205, 108, 45)")}else playSfx("failure"),a="Failure",b=250,e.addColorStop(0,"black"),e.addColorStop(.5,"black"),e.addColorStop(.7,
"rgb(51, 34, 251)"),e.addColorStop(1,"rgb(107, 71, 250)");else 0>=matchTimer?(a="Time!",playSfx("time"),e.addColorStop(0,"black"),e.addColorStop(.5,"black"),e.addColorStop(.7,"rgb(21, 51, 180)"),e.addColorStop(1,"rgb(71, 94, 250)")):(playSfx("game"),e.addColorStop(0,"black"),e.addColorStop(.4,"black"),e.addColorStop(.7,"rgb(167, 27, 40)"),e.addColorStop(1,"rgb(255, 31, 52)"));c.scale(1,d);c.fillStyle=e;c.lineWidth=40;c.strokeStyle="black";c.font="900 "+b+"px Arial";c.strokeText(a,600,470/d);c.lineWidth=
20;c.strokeStyle="white";c.font="900 "+b+"px Arial";c.strokeText(a,600,470/d);c.font="900 "+b+"px Arial";c.fillText(a,600,470/d);c.restore();sounds.battlefield.stop();setTimeout(function(){endGame()},2500)}
$(document).ready(function(){$("#keyboardButton").click(function(){$("#keyboardControlsImg").toggle()});$("#controllerButton").click(function(){$("#controllerSupportContainer").toggle()});canvas=document.getElementById("gameCanvas");c=canvas.getContext("2d");c.fillStyle="rgba(0, 0, 0, 1)";c.fillRect(-100,-100,canvas.width+200,canvas.height+200);drawStartScreen();gameTick();renderTick();var a=Math.max(($(window).width()-1200)/2,0),b=Math.max(($(window).height()-750)/2,0);$("#display").css("margin",
b+"px 0px 0px "+a+"px");$("#effectsButton").click(function(){showVfx?$("#effectsButtonEdit").empty().append("OFF"):$("#effectsButtonEdit").empty().append("ON");showVfx^=1});$("#fpsButton").click(function(){fps30?$("#fpsButtonEdit").empty().append("60"):$("#fpsButtonEdit").empty().append("30");fps30^=1});$("#debugButton").click(function(){if(showDebug){$("#debugButtonEdit").empty().append("OFF");$("#debug").hide();$("#players").hide();var b=Math.max(($(window).height()-750)/2,0);$("#display").css("margin",
b+"px 0px 0px "+a+"px")}else $("#debugButtonEdit").empty().append("ON"),$("#debug").show(),$("#players").show(),b=Math.max(($(window).height()-900)/2,0),$("#display").css("margin",b+" 0px 0px px "+a+"px");showDebug^=1})});
